
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Tutorial &#8212; Documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/customise-alabaster.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/toggleprompt.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Analysis" href="analysis.html" />
    <link rel="prev" title="Recipes using cf" href="recipes.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">



<h1 class="logo"><a href="index.html">cf 3.14.0</a></h1>



<p class="blurb">A CF-compliant earth science data analysis library</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=NCAS-CMS&repo=cf-python&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html"><strong>Introduction</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="cf_data_model.html"><strong>CF data model</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html"><strong>Installation</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html"><strong>Contributing</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes.html"><strong>Recipes using cf</strong></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><strong>Tutorial</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis.html"><strong>Analysis</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="api_reference.html"><strong>API reference</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="aggregation_rules.html"><strong>Aggregation rules</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html"><strong>Performance</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html"><strong>Releases</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog.html"><strong>Change log</strong></a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="recipes.html" title="previous chapter"><strong>Recipes using cf</strong></a></li>
      <li>Next: <a href="analysis.html" title="next chapter"><strong>Analysis</strong></a></li>
  </ul></li>
</ul>
</div>

<br>
cf development has been supported by
the <a href="https://erc.europa.eu/">ERC</a>
through <a href="https://cordis.europa.eu/project/id/247220">Seachange</a>
and
<a href="https://cordis.europa.eu/project/id/786427">Couplet</a>; by
the <a href="https://ec.europa.eu/programmes/horizon2020/">EC Horizon
2020 programme</a> through
<a href="https://cordis.europa.eu/project/id/824084">IS-ENES3</a>;
by <a href="https://nerc.ukri.org/">NERC</a> through
<a href="https://gtr.ukri.org/project/0D95A6DB-0B95-48F7-8A8B-7B9A47DEA117">UKFAFMIP</a>;
and by <a href="https://ncas.ac.uk/">NCAS</a>.
<br>
<br>
<img src="_templates/logo_EC.png" height="40">
<img src="_templates/logo_ERC.png" height="40">
<img src="_templates/logo_NERC.png" height="40">
<br>
<img src="_templates/logo_NCAS.png" height="40">
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tutorial">
<span id="id1"></span><h1><strong>Tutorial</strong><a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p>Version 3.14.0 for version 1.10 of the CF conventions.</p>
<p>All of the Python code in this tutorial is available in two executable
scripts (<a class="reference download internal" download="" href="_downloads/tutorial.py"><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>, 28kB,
<a class="reference download internal" download="" href="_downloads/field_analysis.py"><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>, 8kB).</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#sample-datasets" id="id377"><strong>Sample datasets</strong></a></p></li>
<li><p><a class="reference internal" href="#import" id="id378"><strong>Import</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#cf-version" id="id379">CF version</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#field-and-domain-constructs" id="id380"><strong>Field and domain constructs</strong></a></p></li>
<li><p><a class="reference internal" href="#reading-field-constructs-from-datasets" id="id381"><strong>Reading field constructs from datasets</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#cf-compliance" id="id382">CF-compliance</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#inspection" id="id383"><strong>Inspection</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#minimal-detail" id="id384">Minimal detail</a></p></li>
<li><p><a class="reference internal" href="#medium-detail" id="id385">Medium detail</a></p></li>
<li><p><a class="reference internal" href="#full-detail" id="id386">Full detail</a></p></li>
<li><p><a class="reference internal" href="#file-inspection-with-cfa" id="id387">File inspection with cfa</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#visualisation" id="id388"><strong>Visualisation</strong></a></p></li>
<li><p><a class="reference internal" href="#field-lists" id="id389"><strong>Field lists</strong></a></p></li>
<li><p><a class="reference internal" href="#properties" id="id390"><strong>Properties</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#field-identities" id="id391">Field identities</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#metadata-constructs" id="id392"><strong>Metadata constructs</strong></a></p></li>
<li><p><a class="reference internal" href="#data" id="id393"><strong>Data</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#data-axes" id="id394">Data axes</a></p></li>
<li><p><a class="reference internal" href="#date-time" id="id395">Date-time</a></p></li>
<li><p><a class="reference internal" href="#manipulating-dimensions" id="id396">Manipulating dimensions</a></p></li>
<li><p><a class="reference internal" href="#data-mask" id="id397">Data mask</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#subspacing-by-index" id="id398"><strong>Subspacing by index</strong></a></p></li>
<li><p><a class="reference internal" href="#assignment-by-index" id="id399"><strong>Assignment by index</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#masked-values" id="id400">Masked values</a></p></li>
<li><p><a class="reference internal" href="#assignment-from-other-field-constructs" id="id401">Assignment from other field constructs</a></p></li>
<li><p><a class="reference internal" href="#assignment-of-bounds" id="id402">Assignment of bounds</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#units" id="id403"><strong>Units</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#calendar" id="id404">Calendar</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#filtering-metadata-constructs" id="id405"><strong>Filtering metadata constructs</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#construct-identities" id="id406">Construct identities</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#metadata-construct-access" id="id407"><strong>Metadata construct access</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#metadata-construct-properties" id="id408">Metadata construct properties</a></p></li>
<li><p><a class="reference internal" href="#metadata-construct-data" id="id409">Metadata construct data</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#time" id="id410"><strong>Time</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#time-duration" id="id411">Time duration</a></p></li>
<li><p><a class="reference internal" href="#time-duration-constructors" id="id412">Time duration constructors</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#domain" id="id413"><strong>Domain</strong></a></p></li>
<li><p><a class="reference internal" href="#metadata-construct-types" id="id414"><strong>Metadata construct types</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#domain-axes" id="id415">Domain axes</a></p></li>
<li><p><a class="reference internal" href="#coordinates" id="id416">Coordinates</a></p>
<ul>
<li><p><a class="reference internal" href="#bounds" id="id417">Bounds</a></p></li>
<li><p><a class="reference internal" href="#geometry-cells" id="id418">Geometry cells</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#domain-ancillaries" id="id419">Domain ancillaries</a></p></li>
<li><p><a class="reference internal" href="#coordinate-systems" id="id420">Coordinate systems</a></p>
<ul>
<li><p><a class="reference internal" href="#computing-non-parametric-vertical-coordinates" id="id421">Computing non-parametric vertical coordinates</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#cell-methods" id="id422">Cell methods</a></p></li>
<li><p><a class="reference internal" href="#field-ancillaries" id="id423">Field ancillaries</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#cyclic-domain-axes" id="id424"><strong>Cyclic domain axes</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#rolling-a-cyclic-axis" id="id425">Rolling a cyclic axis</a></p></li>
<li><p><a class="reference internal" href="#anchoring-a-cyclic-axis" id="id426">Anchoring a cyclic axis</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#subspacing-by-metadata" id="id427"><strong>Subspacing by metadata</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#subspaces-in-time" id="id428">Subspaces in time</a></p></li>
<li><p><a class="reference internal" href="#subspace-mode" id="id429">Subspace mode</a></p></li>
<li><p><a class="reference internal" href="#multiple-dimensions" id="id430">Multiple dimensions</a></p></li>
<li><p><a class="reference internal" href="#assignment-by-metadata" id="id431">Assignment by metadata</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#sorting-and-selecting-from-field-lists" id="id432"><strong>Sorting and selecting from field lists</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#testing-criteria-on-a-field-construct" id="id433">Testing criteria on a field construct</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#encapsulating-conditions" id="id434"><strong>Encapsulating conditions</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#compound-conditions" id="id435">Compound conditions</a></p></li>
<li><p><a class="reference internal" href="#condition-constructors" id="id436">Condition constructors</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#assignment-by-condition" id="id437"><strong>Assignment by condition</strong></a></p></li>
<li><p><a class="reference internal" href="#field-creation" id="id438"><strong>Field creation</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#ab-initio-creation" id="id439">Ab initio creation</a></p></li>
<li><p><a class="reference internal" href="#command-modification" id="id440">Command modification</a></p></li>
<li><p><a class="reference internal" href="#creating-data-from-an-array-on-disk" id="id441">Creating data from an array on disk</a></p></li>
<li><p><a class="reference internal" href="#creation-by-conversion" id="id442">Creation by conversion</a></p></li>
<li><p><a class="reference internal" href="#creation-by-reading" id="id443">Creation by reading</a></p></li>
<li><p><a class="reference internal" href="#creation-with-cfa" id="id444">Creation with cfa</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#copying" id="id445"><strong>Copying</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#field-list-copying" id="id446">Field list copying</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#equality" id="id447"><strong>Equality</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#field-list-equality" id="id448">Field list equality</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#netcdf-interface" id="id449"><strong>NetCDF interface</strong></a></p></li>
<li><p><a class="reference internal" href="#writing-to-a-netcdf-dataset" id="id450"><strong>Writing to a netCDF dataset</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#global-attributes" id="id451">Global attributes</a></p></li>
<li><p><a class="reference internal" href="#conventions" id="id452">Conventions</a></p></li>
<li><p><a class="reference internal" href="#scalar-coordinate-variables" id="id453">Scalar coordinate variables</a></p></li>
<li><p><a class="reference internal" href="#strings" id="id454">Strings</a></p></li>
<li><p><a class="reference internal" href="#groups" id="id455">Groups</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#hierarchical-groups" id="id456"><strong>Hierarchical groups</strong></a></p></li>
<li><p><a class="reference internal" href="#external-variables" id="id457"><strong>External variables</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#external-files-with-cfa" id="id458">External files with cfa</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#aggregation" id="id459"><strong>Aggregation</strong></a></p></li>
<li><p><a class="reference internal" href="#compression" id="id460"><strong>Compression</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#discrete-sampling-geometries" id="id461">Discrete sampling geometries</a></p></li>
<li><p><a class="reference internal" href="#gathering" id="id462">Gathering</a></p></li>
<li><p><a class="reference internal" href="#coordinate-subsampling" id="id463">Coordinate subsampling</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#pp-and-um-fields-files" id="id464"><strong>PP and UM fields files</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#converting-pp-and-um-fields-files-to-netcdf-files" id="id465">Converting PP and UM fields files to netCDF files</a></p></li>
<li><p><a class="reference internal" href="#mapping-of-pp-header-items-to-field-constructs" id="id466">Mapping of PP header items to field constructs</a></p></li>
<li><p><a class="reference internal" href="#stash-code-to-standard-name-mappings" id="id467">STASH code to standard name mappings</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#statistical-collapses" id="id468"><strong>Statistical collapses</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#collapse-methods" id="id469">Collapse methods</a></p></li>
<li><p><a class="reference internal" href="#data-type-and-missing-data" id="id470">Data type and missing data</a></p></li>
<li><p><a class="reference internal" href="#collapse-weights" id="id471">Collapse weights</a></p></li>
<li><p><a class="reference internal" href="#multiple-collapses" id="id472">Multiple collapses</a></p></li>
<li><p><a class="reference internal" href="#grouped-collapses" id="id473">Grouped collapses</a></p></li>
<li><p><a class="reference internal" href="#climatological-statistics" id="id474">Climatological statistics</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#other-statistical-operations" id="id475"><strong>Other statistical operations</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#cumulative-sums" id="id476">Cumulative sums</a></p></li>
<li><p><a class="reference internal" href="#histograms" id="id477">Histograms</a></p></li>
<li><p><a class="reference internal" href="#binning-operations" id="id478">Binning operations</a></p></li>
<li><p><a class="reference internal" href="#percentiles" id="id479">Percentiles</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#regridding" id="id480"><strong>Regridding</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#regridding-methods" id="id481">Regridding methods</a></p></li>
<li><p><a class="reference internal" href="#spherical-regridding" id="id482">Spherical regridding</a></p></li>
<li><p><a class="reference internal" href="#cartesian-regridding" id="id483">Cartesian regridding</a></p></li>
<li><p><a class="reference internal" href="#regridding-masked-data" id="id484">Regridding masked data</a></p></li>
<li><p><a class="reference internal" href="#vertical-regridding" id="id485">Vertical regridding</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#mathematical-operations" id="id486"><strong>Mathematical operations</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#binary-arithmetical-operations" id="id487">Binary arithmetical operations</a></p></li>
<li><p><a class="reference internal" href="#unary-operations" id="id488">Unary operations</a></p></li>
<li><p><a class="reference internal" href="#relational-operations" id="id489">Relational operations</a></p></li>
<li><p><a class="reference internal" href="#arithmetical-and-relational-operations-with-insufficient-metadata" id="id490">Arithmetical and relational operations with insufficient metadata</a></p></li>
<li><p><a class="reference internal" href="#operating-on-the-field-constructs-data" id="id491">Operating on the field constructs’ data</a></p></li>
<li><p><a class="reference internal" href="#trigonometrical-and-hyperbolic-functions" id="id492">Trigonometrical and hyperbolic functions</a></p></li>
<li><p><a class="reference internal" href="#exponential-and-logarithmic-functions" id="id493">Exponential and logarithmic functions</a></p></li>
<li><p><a class="reference internal" href="#rounding-and-truncation" id="id494">Rounding and truncation</a></p></li>
<li><p><a class="reference internal" href="#moving-windows" id="id495">Moving windows</a></p></li>
<li><p><a class="reference internal" href="#convolution-filters" id="id496">Convolution filters</a></p></li>
<li><p><a class="reference internal" href="#general-first-order-derivative" id="id497">General first order derivative</a></p></li>
<li><p><a class="reference internal" href="#gradient-vector" id="id498">Gradient vector</a></p></li>
<li><p><a class="reference internal" href="#laplacian" id="id499">Laplacian</a></p></li>
<li><p><a class="reference internal" href="#divergence" id="id500">Divergence</a></p></li>
<li><p><a class="reference internal" href="#curl" id="id501">Curl</a></p></li>
<li><p><a class="reference internal" href="#relative-vorticity" id="id502">Relative vorticity</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#controlling-output-messages" id="id503"><strong>Controlling output messages</strong></a></p>
<ul>
<li><p><a class="reference internal" href="#logging" id="id504">Logging</a></p></li>
<li><p><a class="reference internal" href="#function-verbosity" id="id505">Function verbosity</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="sample-datasets">
<span id="id2"></span><h2><a class="toc-backref" href="#id377"><strong>Sample datasets</strong></a><a class="headerlink" href="#sample-datasets" title="Permalink to this headline">¶</a></h2>
<p>This tutorial uses a number of small sample datasets, all of which can
be found in the zip file <code class="docutils literal notranslate"><span class="pre">cf_tutorial_files.zip</span></code>
(<a class="reference download internal" download="" href="_downloads/cf_tutorial_files.zip"><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>,
164kB):</p>
<div class="literal-block-wrapper docutils container" id="id116">
<div class="code-block-caption"><span class="caption-text"><em>Unpack the sample datasets.</em></span><a class="headerlink" href="#id116" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>unzip<span class="w"> </span>-q<span class="w"> </span>cf_tutorial_files.zip
<span class="gp">$ </span>ls<span class="w"> </span>-1
<span class="go">air_temperature.nc</span>
<span class="go">cf_tutorial_files.zip</span>
<span class="go">contiguous.nc</span>
<span class="go">external.nc</span>
<span class="go">file2.nc</span>
<span class="go">file.nc</span>
<span class="go">gathered.nc</span>
<span class="go">parent.nc</span>
<span class="go">precipitation_flux.nc</span>
<span class="go">timeseries.nc</span>
<span class="go">umfile.pp</span>
<span class="go">vertical.nc</span>
<span class="go">wind_components.nc</span>
</pre></div>
</div>
</div>
<p>The tutorial examples assume that the Python session is being run from
the directory that contains the zip file and its unpacked contents,
and no other files.</p>
<p>The tutorial files may be also found in the <a class="reference external" href="https://github.com/NCAS-CMS/cf-python/tree/master/docs/_downloads">downloads directory</a>
of the on-line code repository.</p>
<hr class="docutils" />
</section>
<section id="import">
<span id="id3"></span><h2><a class="toc-backref" href="#id378"><strong>Import</strong></a><a class="headerlink" href="#import" title="Permalink to this headline">¶</a></h2>
<p>The cf package is imported as follows:</p>
<div class="literal-block-wrapper docutils container" id="id117">
<div class="code-block-caption"><span class="caption-text"><em>Import the cf package.</em></span><a class="headerlink" href="#id117" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cf</span>
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is possible to change the extent to which cf outputs
feedback messages and it may be instructive to increase the
verbosity whilst working through this tutorial to see and
learn more about what cf is doing under the hood and about
the nature of the dataset being operated on. See <a class="reference internal" href="#logging"><span class="std std-ref">the
section on ‘Logging’</span></a> for more information.</p>
</div>
<section id="cf-version">
<span id="id4"></span><h3><a class="toc-backref" href="#id379">CF version</a><a class="headerlink" href="#cf-version" title="Permalink to this headline">¶</a></h3>
<p>The version of the <a class="reference external" href="http://cfconventions.org">CF conventions</a> and
the <a class="reference internal" href="cf_data_model.html#cf-data-model"><span class="std std-ref">CF data model</span></a> being used may be found with
the <a class="reference internal" href="function/cf.CF.html#cf.CF" title="cf.CF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.CF</span></code></a> function:</p>
<div class="literal-block-wrapper docutils container" id="id118">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the version of the CF conventions.</em></span><a class="headerlink" href="#id118" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">CF</span><span class="p">()</span>
<span class="go">&#39;1.8&#39;</span>
</pre></div>
</div>
</div>
<p>This indicates which version of the CF conventions are represented by
this release of the cf package, and therefore the version can not be
changed.</p>
<p>Note, however, that datasets of different CF versions may be
<a class="reference internal" href="#reading-datasets"><span class="std std-ref">read</span></a> from, or <a class="reference internal" href="#writing-to-a-netcdf-dataset"><span class="std std-ref">written</span></a> to netCDF.</p>
<hr class="docutils" />
</section>
</section>
<section id="field-and-domain-constructs">
<span id="id5"></span><h2><a class="toc-backref" href="#id380"><strong>Field and domain constructs</strong></a><a class="headerlink" href="#field-and-domain-constructs" title="Permalink to this headline">¶</a></h2>
<p>The central constructs of CF are the <a class="reference internal" href="cf_data_model.html#term-field-construct"><span class="xref std std-term">field construct</span></a> and
<a class="reference internal" href="cf_data_model.html#term-domain-construct"><span class="xref std std-term">domain construct</span></a>.</p>
<p>The field construct, that corresponds to a CF-netCDF data variable,
includes all of the metadata to describe it:</p>
<blockquote>
<div><ul class="simple">
<li><p>descriptive properties that apply to field construct as a whole
(e.g. the standard name),</p></li>
<li><p>a data array, and</p></li>
<li><p>“metadata constructs” that describe the locations of each cell
(i.e. the “domain”) of the data array, and the physical nature
of each cell’s datum.</p></li>
</ul>
</div></blockquote>
<p>Likewise, the domain construct, that corresponds to a CF-netCDF domain
variable or to the domain of a field construct, includes all of the
metadata to describe it:</p>
<blockquote>
<div><ul class="simple">
<li><p>descriptive properties that apply to field construct as a whole
(e.g. the long name), and</p></li>
<li><p>metadata constructs that describe the locations of each cell of
the domain.</p></li>
</ul>
</div></blockquote>
<p>A field construct or domain construct is stored in a <a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Field</span></code></a>
instance or <code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Domain</span></code> instance respectively. Henceforth the phrase
“field construct” will be assumed to mean “<a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Field</span></code></a> instance”, and
“domain construct” will be assumed to mean “<code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Domain</span></code> instance”.</p>
<hr class="docutils" />
</section>
<section id="reading-field-constructs-from-datasets">
<span id="reading-datasets"></span><h2><a class="toc-backref" href="#id381"><strong>Reading field constructs from datasets</strong></a><a class="headerlink" href="#reading-field-constructs-from-datasets" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a> function reads files from disk, or from an <a class="reference external" href="https://www.opendap.org/">OPeNDAP</a> URLs <a class="footnote-reference brackets" href="#dap" id="id6">1</a>, and returns the contents in
a <a class="reference internal" href="class/cf.FieldList.html#cf.FieldList" title="cf.FieldList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.FieldList</span></code></a> instance that contains zero or more field constructs.</p>
<p>A <a class="reference internal" href="#field-lists"><span class="std std-ref">field list</span></a> is very much like a Python <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a>,
with the addition of extra methods that operate on its field construct
elements.</p>
<p>The following file types can be read:</p>
<ul class="simple">
<li><p>All formats of netCDF3 and netCDF4 files (including <a class="reference external" href="http://www.met.reading.ac.uk/~david/cfa/0.4/index.html">CFA-netCDF</a> files)
can be read, containing datasets for any version of CF up to and
including CF-1.10.</p></li>
</ul>
<ul class="simple">
<li><p>Files in <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/netcdf_working_with_netcdf_files.html">CDL format</a>,
with or without the data array values.</p></li>
</ul>
<ul class="simple">
<li><p><a class="reference internal" href="#pp-and-um-fields-files"><span class="std std-ref">PP and UM fields files</span></a>, whose
contents are mapped into field constructs.</p></li>
</ul>
<p>Note that when reading netCDF4 files that contain <a class="reference internal" href="#hierarchical-groups"><span class="std std-ref">hierachical
groups</span></a>, the group structure is saved via the
<a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a> so that it may be re-used,
or modified, if the field constructs are written to back to disk.</p>
<p>For example, to read the file <code class="docutils literal notranslate"><span class="pre">file.nc</span></code> (found in the <a class="reference internal" href="#sample-datasets"><span class="std std-ref">sample
datasets</span></a>), which contains
two field constructs:</p>
<div class="literal-block-wrapper docutils container" id="id119">
<div class="code-block-caption"><span class="caption-text"><em>Read file.nc and show that the result is a two-element
field list.</em></span><a class="headerlink" href="#id119" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">&lt;class &#39;cf.fieldlist.FieldList&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
<p>Descriptive properties are always read into memory, but <a class="reference external" href="https://en.wikipedia.org/wiki/Lazy_loading">lazy loading</a> is employed for all
data arrays, which means that no data is read into memory until the
data is required for inspection or to modify the array contents. This
maximises the number of field constructs that may be read within a
session, and makes the read operation fast.</p>
<p>Multiple files may be read in one command using <a class="reference external" href="https://en.wikipedia.org/wiki/Glob_(programming)#Syntax">UNIX wild card
characters</a>, or a
sequence of file names (each element of which may also contain wild
cards). Shell environment variables are also permitted.</p>
<div class="literal-block-wrapper docutils container" id="id120">
<div class="code-block-caption"><span class="caption-text"><em>Read the ten sample netCDF files, noting that they
contain more than ten field constructs.</em></span><a class="headerlink" href="#id120" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;*.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">14</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id121">
<div class="code-block-caption"><span class="caption-text"><em>Read two particular files, noting that they contain more
than two field constructs.</em></span><a class="headerlink" href="#id121" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">([</span><span class="s1">&#39;file.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;precipitation_flux.nc&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</div>
<p>All of the datasets in one more directories may also be read by
replacing any file name with a directory name. An attempt will be made
to read all files in the directory, which will result in an error if
any have a non-supported format. Non-supported files may be ignored
with the <em>ignore_read_error</em> keyword.</p>
<div class="literal-block-wrapper docutils container" id="id122">
<div class="code-block-caption"><span class="caption-text"><em>Read all of the files in the current working directory.</em></span><a class="headerlink" href="#id122" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;$PWD&#39;</span><span class="p">)</span>  <span class="c1"># Raises Exception</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">Exception</span>: <span class="n">Can&#39;t determine format of file cf_tutorial_files.zip</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;$PWD&#39;</span><span class="p">,</span> <span class="n">ignore_read_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">15</span>
</pre></div>
</div>
</div>
<p>In all cases, the default behaviour is to aggregate the contents of
all input datasets into as few field constructs as possible, and it is
these aggregated field constructs are returned by <a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a>. See the
section on <a class="reference internal" href="#aggregation"><span class="std std-ref">aggregation</span></a> for full details.</p>
<p>The <a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a> function has optional parameters to</p>
<ul class="simple">
<li><p>allow the user to provide files that contain <a class="reference internal" href="#external-variables"><span class="std std-ref">external
variables</span></a>;</p></li>
<li><p>request <a class="reference internal" href="#creation-by-reading"><span class="std std-ref">extra field constructs to be created from “metadata”
netCDF variables</span></a>, i.e. those that are
referenced from CF-netCDF data variables, but which are not regarded
by default as data variables in their own right;</p></li>
<li><p>return only domain constructs derived from CF-netCDF domain
variables;</p></li>
<li><p>request that masking is <em>not</em> applied by convention to data elements
(see <a class="reference internal" href="#data-mask"><span class="std std-ref">data masking</span></a>);</p></li>
<li><p>issue warnings when <code class="docutils literal notranslate"><span class="pre">valid_min</span></code>, <code class="docutils literal notranslate"><span class="pre">valid_max</span></code> and <code class="docutils literal notranslate"><span class="pre">valid_range</span></code>
attributes are present (see <a class="reference internal" href="#data-mask"><span class="std std-ref">data masking</span></a>);</p></li>
<li><p>display information and issue warnings about the mapping of the
netCDF file contents to CF data model constructs;</p></li>
<li><p>remove from, or include, size one dimensions on the field
constructs’ data;</p></li>
<li><p>configure the <a class="reference internal" href="#aggregation"><span class="std std-ref">field construct aggregation process</span></a>;</p></li>
<li><p>configure the reading of directories to allow sub-directories to be
read recursively, and to allow directories which resolve to symbolic
links; and</p></li>
<li><p>configure parameters for <a class="reference internal" href="#pp-and-um-fields-files"><span class="std std-ref">reading PP and UM fields files</span></a>.</p></li>
</ul>
<section id="cf-compliance">
<span id="id7"></span><h3><a class="toc-backref" href="#id382">CF-compliance</a><a class="headerlink" href="#cf-compliance" title="Permalink to this headline">¶</a></h3>
<p>If the dataset is partially CF-compliant to the extent that it is not
possible to unambiguously map an element of the netCDF dataset to an
element of the CF data model, then a field construct is still
returned, but may be incomplete. This is so that datasets which are
partially conformant may nonetheless be modified in memory and written
to new datasets. Such “structural” non-compliance would occur, for
example, if the <code class="docutils literal notranslate"><span class="pre">coordinates</span></code> attribute of a CF-netCDF data variable
refers to another variable that does not exist, or refers to a
variable that spans a netCDF dimension that does not apply to the data
variable. Other types of non-compliance are not checked, such whether
or not controlled vocabularies have been adhered to. The structural
compliance of the dataset may be checked with the
<a class="reference internal" href="method/cf.Field.dataset_compliance.html#cf.Field.dataset_compliance" title="cf.Field.dataset_compliance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dataset_compliance</span></code></a> method of the field construct, as well
as optionally displayed when the dataset is read.</p>
<hr class="docutils" />
</section>
</section>
<section id="inspection">
<span id="id8"></span><h2><a class="toc-backref" href="#id383"><strong>Inspection</strong></a><a class="headerlink" href="#inspection" title="Permalink to this headline">¶</a></h2>
<p>The contents of a field construct may be inspected at three different
levels of detail.</p>
<section id="minimal-detail">
<span id="id9"></span><h3><a class="toc-backref" href="#id384">Minimal detail</a><a class="headerlink" href="#minimal-detail" title="Permalink to this headline">¶</a></h3>
<p>The built-in <a class="reference external" href="https://docs.python.org/3/library/functions.html#repr" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">repr</span></code></a> function, invoked on a variable by calling that variable
alone at the interpreter prompt, returns a short, one-line description:</p>
<div class="literal-block-wrapper docutils container" id="id123">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the contents of the two field constructs from
the dataset and create a Python variable for each of
them.</em></span><a class="headerlink" href="#id123" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">[&lt;CF Field: specific_humidity(latitude(5), longitude(8)) 1&gt;,</span>
<span class="go"> &lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span>
<span class="go">&lt;CF Field: specific_humidity(latitude(5), longitude(8)) 1&gt;</span>
</pre></div>
</div>
</div>
<p>This gives the identity of the field construct
(e.g. “specific_humidity”), the identities and sizes of the dimensions
spanned by the data array (“latitude” and “longitude” with sizes 5 and
8 respectively) and the units of the data (“1”, i.e. dimensionless).</p>
</section>
<section id="medium-detail">
<span id="id10"></span><h3><a class="toc-backref" href="#id385">Medium detail</a><a class="headerlink" href="#medium-detail" title="Permalink to this headline">¶</a></h3>
<p>The built-in <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a> function, invoked by a <a class="reference external" href="https://docs.python.org/3/library/functions.html#print" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">print</span></code></a> call on a field construct,
returns similar information as the one-line output, along with short
descriptions of the metadata constructs, which include the first and last
values of their data arrays:</p>
<div class="literal-block-wrapper docutils container" id="id124">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the contents of the two field constructs with
medium detail.</em></span><a class="headerlink" href="#id124" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">Field: air_temperature (ncvar%ta)</span>
<span class="go">---------------------------------</span>
<span class="go">Data            : air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K</span>
<span class="go">Cell methods    : grid_latitude(10): grid_longitude(9): mean where land (interval: 0.1 degrees) time(1): maximum</span>
<span class="go">Field ancils    : air_temperature standard_error(grid_latitude(10), grid_longitude(9)) = [[0.76, ..., 0.32]] K</span>
<span class="go">Dimension coords: atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [2.2, ..., -1.76] degrees</span>
<span class="go">                : grid_longitude(9) = [-4.7, ..., -1.18] degrees</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[53.941, ..., 50.225]] degrees_N</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[2.004, ..., 8.156]] degrees_E</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., b&#39;kappa&#39;]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[2391.9657, ..., 2392.6009]] km2</span>
<span class="go">Coord references: grid_mapping_name:rotated_latitude_longitude</span>
<span class="go">                : standard_name:atmosphere_hybrid_height_coordinate</span>
<span class="go">Domain ancils   : ncvar%a(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : ncvar%b(atmosphere_hybrid_height_coordinate(1)) = [20.0]</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 270.0]] m</span>
</pre></div>
</div>
</div>
<p>Note that <a class="reference internal" href="#time"><span class="std std-ref">time values</span></a> are converted to date-times with
the <a class="reference external" href="https://unidata.github.io/cftime/">cftime package</a>.</p>
</section>
<section id="full-detail">
<span id="id11"></span><h3><a class="toc-backref" href="#id386">Full detail</a><a class="headerlink" href="#full-detail" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="method/cf.Field.dump.html#cf.Field.dump" title="cf.Field.dump"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dump</span></code></a> method of the field construct gives all
properties of all constructs, including metadata constructs and their
components, and shows the first and last values of all data arrays:</p>
<div class="literal-block-wrapper docutils container" id="id125">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the contents of the two field constructs with
full detail.</em></span><a class="headerlink" href="#id125" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">----------------------------------</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Conventions = &#39;CF-1.7&#39;</span>
<span class="go">project = &#39;research&#39;</span>
<span class="go">standard_name = &#39;specific_humidity&#39;</span>
<span class="go">units = &#39;1&#39;</span>

<span class="go">Data(latitude(5), longitude(8)) = [[0.003, ..., 0.032]] 1</span>

<span class="go">Cell Method: area: mean</span>

<span class="go">Domain Axis: latitude(5)</span>
<span class="go">Domain Axis: longitude(8)</span>
<span class="go">Domain Axis: time(1)</span>

<span class="go">Dimension coordinate: latitude</span>
<span class="go">    standard_name = &#39;latitude&#39;</span>
<span class="go">    units = &#39;degrees_north&#39;</span>
<span class="go">    Data(latitude(5)) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">    Bounds:Data(latitude(5), 2) = [[-90.0, ..., 90.0]]</span>

<span class="go">Dimension coordinate: longitude</span>
<span class="go">    standard_name = &#39;longitude&#39;</span>
<span class="go">    units = &#39;degrees_east&#39;</span>
<span class="go">    Data(longitude(8)) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">    Bounds:Data(longitude(8), 2) = [[0.0, ..., 360.0]]</span>

<span class="go">Dimension coordinate: time</span>
<span class="go">    standard_name = &#39;time&#39;</span>
<span class="go">    units = &#39;days since 2018-12-01&#39;</span>
<span class="go">    Data(time(1)) = [2019-01-01 00:00:00]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">---------------------------------</span>
<span class="go">Field: air_temperature (ncvar%ta)</span>
<span class="go">---------------------------------</span>
<span class="go">Conventions = &#39;CF-1.7&#39;</span>
<span class="go">project = &#39;research&#39;</span>
<span class="go">standard_name = &#39;air_temperature&#39;</span>
<span class="go">units = &#39;K&#39;</span>

<span class="go">Data(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) = [[[0.0, ..., 89.0]]] K</span>

<span class="go">Cell Method: grid_latitude(10): grid_longitude(9): mean where land (interval: 0.1 degrees)</span>
<span class="go">Cell Method: time(1): maximum</span>

<span class="go">Field Ancillary: air_temperature standard_error</span>
<span class="go">    standard_name = &#39;air_temperature standard_error&#39;</span>
<span class="go">    units = &#39;K&#39;</span>
<span class="go">    Data(grid_latitude(10), grid_longitude(9)) = [[0.76, ..., 0.32]] K</span>

<span class="go">Domain Axis: atmosphere_hybrid_height_coordinate(1)</span>
<span class="go">Domain Axis: grid_latitude(10)</span>
<span class="go">Domain Axis: grid_longitude(9)</span>
<span class="go">Domain Axis: time(1)</span>

<span class="go">Dimension coordinate: atmosphere_hybrid_height_coordinate</span>
<span class="go">    computed_standard_name = &#39;altitude&#39;</span>
<span class="go">    standard_name = &#39;atmosphere_hybrid_height_coordinate&#39;</span>
<span class="go">    Data(atmosphere_hybrid_height_coordinate(1)) = [1.5]</span>
<span class="go">    Bounds:Data(atmosphere_hybrid_height_coordinate(1), 2) = [[1.0, 2.0]]</span>

<span class="go">Dimension coordinate: grid_latitude</span>
<span class="go">    standard_name = &#39;grid_latitude&#39;</span>
<span class="go">    units = &#39;degrees&#39;</span>
<span class="go">    Data(grid_latitude(10)) = [2.2, ..., -1.76] degrees</span>
<span class="go">    Bounds:Data(grid_latitude(10), 2) = [[2.42, ..., -1.98]]</span>

<span class="go">Dimension coordinate: grid_longitude</span>
<span class="go">    standard_name = &#39;grid_longitude&#39;</span>
<span class="go">    units = &#39;degrees&#39;</span>
<span class="go">    Data(grid_longitude(9)) = [-4.7, ..., -1.18] degrees</span>
<span class="go">    Bounds:Data(grid_longitude(9), 2) = [[-4.92, ..., -0.96]]</span>

<span class="go">Dimension coordinate: time</span>
<span class="go">    standard_name = &#39;time&#39;</span>
<span class="go">    units = &#39;days since 2018-12-01&#39;</span>
<span class="go">    Data(time(1)) = [2019-01-01 00:00:00]</span>

<span class="go">Auxiliary coordinate: latitude</span>
<span class="go">    standard_name = &#39;latitude&#39;</span>
<span class="go">    units = &#39;degrees_N&#39;</span>
<span class="go">    Data(grid_latitude(10), grid_longitude(9)) = [[53.941, ..., 50.225]] degrees_N</span>

<span class="go">Auxiliary coordinate: longitude</span>
<span class="go">    standard_name = &#39;longitude&#39;</span>
<span class="go">    units = &#39;degrees_E&#39;</span>
<span class="go">    Data(grid_longitude(9), grid_latitude(10)) = [[2.004, ..., 8.156]] degrees_E</span>

<span class="go">Auxiliary coordinate: long_name=Grid latitude name</span>
<span class="go">    long_name = &#39;Grid latitude name&#39;</span>
<span class="go">    Data(grid_latitude(10)) = [--, ..., &#39;kappa&#39;]</span>

<span class="go">Domain ancillary: ncvar%a</span>
<span class="go">    units = &#39;m&#39;</span>
<span class="go">    Data(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">    Bounds:Data(atmosphere_hybrid_height_coordinate(1), 2) = [[5.0, 15.0]]</span>

<span class="go">Domain ancillary: ncvar%b</span>
<span class="go">    Data(atmosphere_hybrid_height_coordinate(1)) = [20.0]</span>
<span class="go">    Bounds:Data(atmosphere_hybrid_height_coordinate(1), 2) = [[14.0, 26.0]]</span>

<span class="go">Domain ancillary: surface_altitude</span>
<span class="go">    standard_name = &#39;surface_altitude&#39;</span>
<span class="go">    units = &#39;m&#39;</span>
<span class="go">    Data(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 270.0]] m</span>

<span class="go">Coordinate reference: atmosphere_hybrid_height_coordinate</span>
<span class="go">    Coordinate conversion:computed_standard_name = altitude</span>
<span class="go">    Coordinate conversion:standard_name = atmosphere_hybrid_height_coordinate</span>
<span class="go">    Coordinate conversion:a = Domain Ancillary: ncvar%a</span>
<span class="go">    Coordinate conversion:b = Domain Ancillary: ncvar%b</span>
<span class="go">    Coordinate conversion:orog = Domain Ancillary: surface_altitude</span>
<span class="go">    Datum:earth_radius = 6371007</span>
<span class="go">    Dimension Coordinate: atmosphere_hybrid_height_coordinate</span>

<span class="go">Coordinate reference: rotated_latitude_longitude</span>
<span class="go">    Coordinate conversion:grid_mapping_name = rotated_latitude_longitude</span>
<span class="go">    Coordinate conversion:grid_north_pole_latitude = 38.0</span>
<span class="go">    Coordinate conversion:grid_north_pole_longitude = 190.0</span>
<span class="go">    Datum:earth_radius = 6371007</span>
<span class="go">    Dimension Coordinate: grid_longitude</span>
<span class="go">    Dimension Coordinate: grid_latitude</span>
<span class="go">    Auxiliary Coordinate: longitude</span>
<span class="go">    Auxiliary Coordinate: latitude</span>

<span class="go">Cell measure: measure:area</span>
<span class="go">    units = &#39;km2&#39;</span>
<span class="go">    Data(grid_longitude(9), grid_latitude(10)) = [[2391.9657, ..., 2392.6009]] km2</span>
</pre></div>
</div>
</div>
</section>
<section id="file-inspection-with-cfa">
<span id="id12"></span><h3><a class="toc-backref" href="#id387">File inspection with cfa</a><a class="headerlink" href="#file-inspection-with-cfa" title="Permalink to this headline">¶</a></h3>
<p>The description for every field constructs found in datasets also be
generated from the command line, with minimal, medium or full detail,
by using the <code class="docutils literal notranslate"><span class="pre">cfa</span></code> tool, for example:</p>
<div class="literal-block-wrapper docutils container" id="id126">
<div class="code-block-caption"><span class="caption-text"><em>Use cfa on the command line to inspect the field
constructs contained in one or more datasets. The “-1”
option treats all input files collectively as a single CF
dataset, so that aggregation is attempted within and
between the input files.</em></span><a class="headerlink" href="#id126" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cfa<span class="w"> </span>file.nc
<span class="go">CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K</span>
<span class="go">CF Field: specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="gp">$ </span>cfa<span class="w"> </span>-1<span class="w"> </span>*.nc
<span class="go">CF Field: specific_humidity(cf_role=timeseries_id(4), ncdim%timeseries(9))</span>
<span class="go">CF Field: cell_area(ncdim%longitude(9), ncdim%latitude(10)) m2</span>
<span class="go">CF Field: eastward_wind(latitude(10), longitude(9)) m s-1</span>
<span class="go">CF Field: specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">CF Field: air_potential_temperature(time(120), latitude(5), longitude(8)) K</span>
<span class="go">CF Field: precipitation_flux(time(1), latitude(64), longitude(128)) kg m-2 day-1</span>
<span class="go">CF Field: precipitation_flux(time(2), latitude(4), longitude(5)) kg m2 s-1</span>
<span class="go">CF Field: air_temperature(time(2), latitude(73), longitude(96)) K</span>
<span class="go">CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">cfa</span></code> may also be used to <a class="reference internal" href="#creation-with-cfa"><span class="std std-ref">write aggregated field constructs to
new datasets</span></a>, and may be used with <a class="reference internal" href="#external-variables-with-cfa"><span class="std std-ref">external
files</span></a>.</p>
</section>
</section>
<hr class="docutils" />
<section id="visualisation">
<h2><a class="toc-backref" href="#id388"><strong>Visualisation</strong></a><a class="headerlink" href="#visualisation" title="Permalink to this headline">¶</a></h2>
<p>Powerful, flexible, and very simple to produce visualisations of field
constructs are available with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">cfplot</span></code> package (that needs to be
installed separately to cf, see <a class="reference external" href="http://ajheaps.github.io/cf-plot">http://ajheaps.github.io/cf-plot</a> for
details).</p>
<figure class="align-default" id="id127">
<img alt="_images/cfplot_example.png" src="_images/cfplot_example.png" />
<figcaption>
<p><span class="caption-text"><em>Example output of cfplot displaying a cf field construct.</em></span><a class="headerlink" href="#id127" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>See the <a class="reference external" href="http://ajheaps.github.io/cf-plot/gallery.html">cfplot gallery</a> for the wide range
of plotting possibilities, with example code. These include, but are
not limited to:</p>
<ul class="simple">
<li><p>Cylindrical, polar stereographic and other plane projections</p></li>
<li><p>Latitude or longitude vs. height or pressure</p></li>
<li><p>Hovmuller</p></li>
<li><p>Vectors</p></li>
<li><p>Stipples</p></li>
<li><p>Multiple plots on a page</p></li>
<li><p>Colour scales</p></li>
<li><p>User defined axes</p></li>
<li><p>Rotated pole</p></li>
<li><p>Irregular grids</p></li>
<li><p>Trajectories</p></li>
<li><p>Line plots</p></li>
</ul>
<hr class="docutils" />
</section>
<section id="field-lists">
<span id="id13"></span><h2><a class="toc-backref" href="#id389"><strong>Field lists</strong></a><a class="headerlink" href="#field-lists" title="Permalink to this headline">¶</a></h2>
<p>A field list, contained in a <a class="reference internal" href="class/cf.FieldList.html#cf.FieldList" title="cf.FieldList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.FieldList</span></code></a> instance, is an ordered
sequence of field constructs. It supports all of the Python <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a>
operations, such as indexing, iteration, and methods like
<a class="reference internal" href="method/cf.FieldList.append.html#cf.FieldList.append" title="cf.FieldList.append"><code class="xref py py-obj docutils literal notranslate"><span class="pre">append</span></code></a>.</p>
<div class="literal-block-wrapper docutils container" id="id128">
<div class="code-block-caption"><span class="caption-text"><em>List-like operations on field list instances.</em></span><a class="headerlink" href="#id128" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;precipitation_flux.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">[&lt;CF Field: specific_humidity(latitude(5), longitude(8)) 1&gt;,</span>
<span class="go"> &lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span>
<span class="go">[&lt;CF Field: precipitation_flux(time(1), latitude(64), longitude(128)) kg m-2 day-1&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span>
<span class="go">[&lt;CF Field: precipitation_flux(time(1), latitude(64), longitude(128)) kg m-2 day-1&gt;,</span>
<span class="go"> &lt;CF Field: specific_humidity(latitude(5), longitude(8)) 1&gt;,</span>
<span class="go"> &lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;,</span>
<span class="go"> &lt;CF Field: specific_humidity(latitude(5), longitude(8)) 1&gt;,</span>
<span class="go"> &lt;CF Field: precipitation_flux(time(1), latitude(64), longitude(128)) kg m-2 day-1&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">y</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">y</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;field:&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">field: &lt;CF Field: precipitation_flux(time(1), latitude(64), longitude(128)) kg m-2 day-1&gt;</span>
<span class="go">field: &lt;CF Field: specific_humidity(latitude(5), longitude(8)) 1&gt;</span>
<span class="go">field: &lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;</span>
</pre></div>
</div>
</div>
<p>The field list also has some additional methods for <a class="reference internal" href="#field-list-copying"><span class="std std-ref">copying</span></a>, <a class="reference internal" href="#field-list-equality"><span class="std std-ref">testing equality</span></a>,
<a class="reference internal" href="#sorting-and-selecting-from-field-lists"><span class="std std-ref">sorting and selection</span></a>.</p>
<hr class="docutils" />
</section>
<section id="properties">
<span id="id14"></span><h2><a class="toc-backref" href="#id390"><strong>Properties</strong></a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<p>Descriptive properties that apply to field construct as a whole may be
retrieved with the <a class="reference internal" href="method/cf.Field.properties.html#cf.Field.properties" title="cf.Field.properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">properties</span></code></a> method:</p>
<div class="literal-block-wrapper docutils container" id="id129">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve all of the descriptive properties</em></span><a class="headerlink" href="#id129" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.7&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>From a Python script or using the standard Python shell, the result of
methods such as the property methods given here will be returned in
condensed form, without linebreaks between items.</p>
<p>If a “pretty printed” output as displayed in these pages is preferred,
use the
<a class="reference external" href="https://ipython.readthedocs.io/en/stable/index.html">ipython shell</a> or
wrap calls with a suitable method from Python’s dedicated
<a class="reference external" href="https://docs.python.org/3/library/pprint.html">pprint module</a>.</p>
</div>
<p>Individual properties may be accessed and modified with the
<a class="reference internal" href="method/cf.Field.del_property.html#cf.Field.del_property" title="cf.Field.del_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">del_property</span></code></a>, <a class="reference internal" href="method/cf.Field.get_property.html#cf.Field.get_property" title="cf.Field.get_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_property</span></code></a>, <a class="reference internal" href="method/cf.Field.has_property.html#cf.Field.has_property" title="cf.Field.has_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_property</span></code></a>,
and <a class="reference internal" href="method/cf.Field.set_property.html#cf.Field.set_property" title="cf.Field.set_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_property</span></code></a> methods:</p>
<div class="literal-block-wrapper docutils container" id="id130">
<div class="code-block-caption"><span class="caption-text"><em>Check is a property exists, retrieve its value, delete
it and then set it to a new value.</em></span><a class="headerlink" href="#id130" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">has_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">)</span>
<span class="go">&#39;air_temperature&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">del_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">)</span>
<span class="go">&#39;air_temperature&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;not set&#39;</span><span class="p">)</span>
<span class="go">&#39;not set&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;air_temperature&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;not set&#39;</span><span class="p">)</span>
<span class="go">&#39;air_temperature&#39;</span>
</pre></div>
</div>
</div>
<p>A collection of properties may be set at the same time with the
<a class="reference internal" href="method/cf.Field.set_properties.html#cf.Field.set_properties" title="cf.Field.set_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_properties</span></code></a> method of the field construct, and all
properties may be completely removed with the
<a class="reference internal" href="method/cf.Field.clear_properties.html#cf.Field.clear_properties" title="cf.Field.clear_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_properties</span></code></a> method.</p>
<div class="literal-block-wrapper docutils container" id="id131">
<div class="code-block-caption"><span class="caption-text"><em>Update the properties with a collection, delete all of
the properties, and reinstate the original properties.</em></span><a class="headerlink" href="#id131" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">original</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">original</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.7&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">set_properties</span><span class="p">({</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.7&#39;,</span>
<span class="go"> &#39;foo&#39;: &#39;bar&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">clear_properties</span><span class="p">()</span>
<span class="go"> {&#39;Conventions&#39;: &#39;CF-1.7&#39;,</span>
<span class="go"> &#39;foo&#39;: &#39;bar&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;units&#39;: &#39;K&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="n">original</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.7&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;air_temperature&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
</pre></div>
</div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">units</span></code> property persisted after the call to the
<a class="reference internal" href="method/cf.Field.clear_properties.html#cf.Field.clear_properties" title="cf.Field.clear_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_properties</span></code></a> method because is it deeply associated with
the field construct’s data, which still exists.</p>
<p>All of the methods related to the properties are listed <a class="reference internal" href="class/cf.Field.html#field-properties"><span class="std std-ref">here</span></a>.</p>
<section id="field-identities">
<span id="id15"></span><h3><a class="toc-backref" href="#id391">Field identities</a><a class="headerlink" href="#field-identities" title="Permalink to this headline">¶</a></h3>
<p>A field construct identity is a string that describes the construct
and is based on the field construct’s properties. A canonical identity
is returned by the <a class="reference internal" href="method/cf.Field.identity.html#cf.Field.identity" title="cf.Field.identity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">identity</span></code></a> method of the field construct,
and all possible identities are returned by the <a class="reference internal" href="method/cf.Field.identities.html#cf.Field.identities" title="cf.Field.identities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">identities</span></code></a>
method.</p>
<p>A field construct’s identity may be any one of the following</p>
<ul class="simple">
<li><p>The value of the <a class="reference internal" href="attribute/cf.Field.standard_name.html#cf.Field.standard_name" title="cf.Field.standard_name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">standard_name</span></code></a> property,
e.g. <code class="docutils literal notranslate"><span class="pre">'air_temperature'</span></code>,</p></li>
<li><p>The value of the <a class="reference internal" href="attribute/cf.Field.id.html#cf.Field.id" title="cf.Field.id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">id</span></code></a> attribute, preceded by <code class="docutils literal notranslate"><span class="pre">'id%='</span></code>,</p></li>
<li><p>The value of any property, preceded by the property name and an
equals, e.g. <code class="docutils literal notranslate"><span class="pre">'long_name=Air</span> <span class="pre">Temperature'</span></code>, <code class="docutils literal notranslate"><span class="pre">'foo=bar'</span></code>, etc.,</p></li>
<li><p>The netCDF variable name, preceded by “ncvar%”, e.g. <code class="docutils literal notranslate"><span class="pre">'ncvar%tas'</span></code>
(see the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>),</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id132">
<div class="code-block-caption"><span class="caption-text"><em>Get the canonical identity, and all identities, of a
field construct.</em></span><a class="headerlink" href="#id132" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="go">&#39;air_temperature&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">identities</span><span class="p">()</span>
<span class="go">[&#39;air_temperature&#39;,</span>
<span class="go"> &#39;Conventions=CF-1.7&#39;,</span>
<span class="go"> &#39;project=research&#39;,</span>
<span class="go"> &#39;units=K&#39;,</span>
<span class="go"> &#39;standard_name=air_temperature&#39;,</span>
<span class="go"> &#39;ncvar%ta&#39;]</span>
</pre></div>
</div>
</div>
<p>The identity returned by the <a class="reference internal" href="method/cf.Field.identity.html#cf.Field.identity" title="cf.Field.identity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">identity</span></code></a> method is, by default,
the least ambiguous identity (defined in the method documentation),
but it may be restricted to the <a class="reference internal" href="attribute/cf.Field.standard_name.html#cf.Field.standard_name" title="cf.Field.standard_name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">standard_name</span></code></a> property and
<a class="reference internal" href="attribute/cf.Field.id.html#cf.Field.id" title="cf.Field.id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">id</span></code></a> attribute; or also the <a class="reference internal" href="attribute/cf.Field.long_name.html#cf.Field.long_name" title="cf.Field.long_name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">long_name</span></code></a> property and
netCDF variable name (see the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>). See the <em>strict</em> and <em>relaxed</em> keywords.</p>
<hr class="docutils" />
</section>
</section>
<section id="metadata-constructs">
<span id="id16"></span><h2><a class="toc-backref" href="#id392"><strong>Metadata constructs</strong></a><a class="headerlink" href="#metadata-constructs" title="Permalink to this headline">¶</a></h2>
<p>The metadata constructs describe the field construct that contains
them. Each <a class="reference internal" href="cf_data_model.html#cf-data-model"><span class="std std-ref">CF data model metadata construct</span></a> has
a corresponding cf class:</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>CF data model construct</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="class/cf.DomainAxis.html#cf.DomainAxis" title="cf.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.DomainAxis</span></code></a></p></td>
<td><p>Domain axis</p></td>
<td><p>Independent axes of the domain</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="class/cf.DimensionCoordinate.html#cf.DimensionCoordinate" title="cf.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.DimensionCoordinate</span></code></a></p></td>
<td><p>Dimension coordinate</p></td>
<td><p>Domain cell locations</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="class/cf.AuxiliaryCoordinate.html#cf.AuxiliaryCoordinate" title="cf.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.AuxiliaryCoordinate</span></code></a></p></td>
<td><p>Auxiliary coordinate</p></td>
<td><p>Domain cell locations</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="class/cf.CoordinateReference.html#cf.CoordinateReference" title="cf.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.CoordinateReference</span></code></a></p></td>
<td><p>Coordinate reference</p></td>
<td><p>Domain coordinate systems</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="class/cf.DomainAncillary.html#cf.DomainAncillary" title="cf.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.DomainAncillary</span></code></a></p></td>
<td><p>Domain ancillary</p></td>
<td><p>Cell locations in alternative coordinate systems</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="class/cf.CellMeasure.html#cf.CellMeasure" title="cf.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.CellMeasure</span></code></a></p></td>
<td><p>Cell measure</p></td>
<td><p>Domain cell size or shape</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="class/cf.FieldAncillary.html#cf.FieldAncillary" title="cf.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.FieldAncillary</span></code></a></p></td>
<td><p>Field ancillary</p></td>
<td><p>Ancillary metadata which vary within the domain</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="class/cf.CellMethod.html#cf.CellMethod" title="cf.CellMethod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.CellMethod</span></code></a></p></td>
<td><p>Cell method</p></td>
<td><p>Describes how data represent variation within cells</p></td>
</tr>
</tbody>
</table>
<p>Metadata constructs of a particular type can be retrieved with the
following attributes of the field construct:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 59%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Metadata constructs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.domain_axes.html#cf.Field.domain_axes" title="cf.Field.domain_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">domain_axes</span></code></a></p></td>
<td><p>Domain axes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.dimension_coordinates.html#cf.Field.dimension_coordinates" title="cf.Field.dimension_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dimension_coordinates</span></code></a></p></td>
<td><p>Dimension coordinates</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.auxiliary_coordinates.html#cf.Field.auxiliary_coordinates" title="cf.Field.auxiliary_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">auxiliary_coordinates</span></code></a></p></td>
<td><p>Auxiliary coordinates</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.coordinate_references.html#cf.Field.coordinate_references" title="cf.Field.coordinate_references"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coordinate_references</span></code></a></p></td>
<td><p>Coordinate references</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.domain_ancillaries.html#cf.Field.domain_ancillaries" title="cf.Field.domain_ancillaries"><code class="xref py py-obj docutils literal notranslate"><span class="pre">domain_ancillaries</span></code></a></p></td>
<td><p>Domain ancillaries</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.cell_measures.html#cf.Field.cell_measures" title="cf.Field.cell_measures"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cell_measures</span></code></a></p></td>
<td><p>Cell measures</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.field_ancillaries.html#cf.Field.field_ancillaries" title="cf.Field.field_ancillaries"><code class="xref py py-obj docutils literal notranslate"><span class="pre">field_ancillaries</span></code></a></p></td>
<td><p>Field ancillaries</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.cell_methods.html#cf.Field.cell_methods" title="cf.Field.cell_methods"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cell_methods</span></code></a></p></td>
<td><p>Cell methods</p></td>
</tr>
</tbody>
</table>
<p>Each of these attributes returns a <a class="reference internal" href="class/cf.Constructs.html#cf.Constructs" title="cf.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Constructs</span></code></a> class instance that
maps metadata constructs to unique identifiers called “construct
keys”. A <a class="reference internal" href="class/cf.Constructs.html#cf.Constructs" title="cf.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Constructs</span></code></a> instance has methods for selecting constructs
that meet particular criteria (see
<a class="reference internal" href="#filtering-metadata-constructs"><span class="std std-ref">Filtering metadata constructs</span></a>). It also behaves like a
“read-only” Python dictionary, in that it has <a class="reference internal" href="method/cf.Constructs.items.html#cf.Constructs.items" title="cf.Constructs.items"><code class="xref py py-obj docutils literal notranslate"><span class="pre">items</span></code></a>,
<a class="reference internal" href="method/cf.Constructs.keys.html#cf.Constructs.keys" title="cf.Constructs.keys"><code class="xref py py-obj docutils literal notranslate"><span class="pre">keys</span></code></a> and <a class="reference internal" href="method/cf.Constructs.values.html#cf.Constructs.values" title="cf.Constructs.values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">values</span></code></a> methods that work exactly
like their corresponding <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> methods. It also has a
<a class="reference internal" href="method/cf.Constructs.get.html#cf.Constructs.get" title="cf.Constructs.get"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get</span></code></a> method and indexing like a Python dictionary (see
<a class="reference internal" href="#metadata-construct-access"><span class="std std-ref">Metadata construct access</span></a> for details).</p>
<div class="literal-block-wrapper docutils container" id="id133">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the field construct’s coordinate reference
constructs, and access them using dictionary methods.</em></span><a class="headerlink" href="#id133" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">coordinate_references</span>
<span class="go">&lt;CF Constructs: coordinate_reference(2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">coordinate_references</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;coordinatereference0&#39;: &lt;CF CoordinateReference: standard_name:atmosphere_hybrid_height_coordinate&gt;,</span>
<span class="go"> &#39;coordinatereference1&#39;: &lt;CF CoordinateReference: grid_mapping_name:rotated_latitude_longitude&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">coordinate_references</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="go">[&#39;coordinatereference0&#39;, &#39;coordinatereference1&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">coordinate_references</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">coordinatereference0 &lt;CF CoordinateReference: standard_name:atmosphere_hybrid_height_coordinate&gt;</span>
<span class="go">coordinatereference1 &lt;CF CoordinateReference: grid_mapping_name:rotated_latitude_longitude&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id134">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the field construct’s dimension coordinate and
domain axis constructs.</em></span><a class="headerlink" href="#id134" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">dimension_coordinates</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;dimensioncoordinate0&#39;: &lt;CF DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;CF DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;CF DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;CF DimensionCoordinate: time(1) days since 2018-12-01 &gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">domain_axes</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainaxis0&#39;: &lt;CF DomainAxis: size(1)&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;CF DomainAxis: size(10)&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;CF DomainAxis: size(9)&gt;,</span>
<span class="go"> &#39;domainaxis3&#39;: &lt;CF DomainAxis: size(1)&gt;}</span>
</pre></div>
</div>
</div>
<p>The construct keys (e.g. <code class="docutils literal notranslate"><span class="pre">'domainaxis1'</span></code>) are usually generated
internally and are unique within the field construct. However,
construct keys may be different for equivalent metadata constructs
from different field constructs, and for different Python sessions.</p>
<p>Metadata constructs of all types may be returned by the
<a class="reference internal" href="attribute/cf.Field.constructs.html#cf.Field.constructs" title="cf.Field.constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">constructs</span></code></a> attribute of the field construct:</p>
<div class="literal-block-wrapper docutils container" id="id135">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve all of the field construct’s metadata
constructs.</em></span><a class="headerlink" href="#id135" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">constructs</span>
<span class="go">&lt;CF Constructs: cell_method(1), dimension_coordinate(3), domain_axis(3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">constructs</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmethod0&#39;: &lt;CF CellMethod: area: mean&gt;,</span>
<span class="go"> &#39;dimensioncoordinate0&#39;: &lt;CF DimensionCoordinate: latitude(5) degrees_north&gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;CF DimensionCoordinate: longitude(8) degrees_east&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;CF DimensionCoordinate: time(1) days since 2018-12-01 &gt;,</span>
<span class="go"> &#39;domainaxis0&#39;: &lt;CF DomainAxis: size(5)&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;CF DomainAxis: size(8)&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;CF DomainAxis: size(1)&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span>
<span class="go">&lt;CF Constructs: auxiliary_coordinate(3), cell_measure(1), cell_method(2), coordinate_reference(2), dimension_coordinate(4), domain_ancillary(3), domain_axis(4), field_ancillary(1)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;CF AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: &lt;CF AuxiliaryCoordinate: longitude(9, 10) degrees_E&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate2&#39;: &lt;CF AuxiliaryCoordinate: long_name=Grid latitude name(10) &gt;,</span>
<span class="go"> &#39;cellmeasure0&#39;: &lt;CF CellMeasure: measure:area(9, 10) km2&gt;,</span>
<span class="go"> &#39;cellmethod0&#39;: &lt;CF CellMethod: domainaxis1: domainaxis2: mean where land (interval: 0.1 degrees)&gt;,</span>
<span class="go"> &#39;cellmethod1&#39;: &lt;CF CellMethod: domainaxis3: maximum&gt;,</span>
<span class="go"> &#39;coordinatereference0&#39;: &lt;CF CoordinateReference: standard_name:atmosphere_hybrid_height_coordinate&gt;,</span>
<span class="go"> &#39;coordinatereference1&#39;: &lt;CF CoordinateReference: grid_mapping_name:rotated_latitude_longitude&gt;,</span>
<span class="go"> &#39;dimensioncoordinate0&#39;: &lt;CF DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;CF DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;CF DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;CF DimensionCoordinate: time(1) days since 2018-12-01 &gt;,</span>
<span class="go"> &#39;domainancillary0&#39;: &lt;CF DomainAncillary: ncvar%a(1) m&gt;,</span>
<span class="go"> &#39;domainancillary1&#39;: &lt;CF DomainAncillary: ncvar%b(1) &gt;,</span>
<span class="go"> &#39;domainancillary2&#39;: &lt;CF DomainAncillary: surface_altitude(10, 9) m&gt;,</span>
<span class="go"> &#39;domainaxis0&#39;: &lt;CF DomainAxis: size(1)&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;CF DomainAxis: size(10)&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;CF DomainAxis: size(9)&gt;,</span>
<span class="go"> &#39;domainaxis3&#39;: &lt;CF DomainAxis: size(1)&gt;,</span>
<span class="go"> &#39;fieldancillary0&#39;: &lt;CF FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="data">
<span id="id17"></span><h2><a class="toc-backref" href="#id393"><strong>Data</strong></a><a class="headerlink" href="#data" title="Permalink to this headline">¶</a></h2>
<p>The field construct’s data is stored in a <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> class instance that
is accessed with the <a class="reference internal" href="attribute/cf.Field.data.html#cf.Field.data" title="cf.Field.data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></a> attribute of the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id136">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the data and inspect it, showing the shape and
some illustrative values.</em></span><a class="headerlink" href="#id136" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;CF Data(1, 10, 9): [[[262.8, ..., 269.7]]] K&gt;</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instance provides access to the full array of values, as
well as attributes to describe the array and methods for describing
any <a class="reference internal" href="#compression"><span class="std std-ref">data compression</span></a>. The field construct also
has a <a class="reference internal" href="method/cf.Field.get_data.html#cf.Field.get_data" title="cf.Field.get_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_data</span></code></a> method as an alternative means of retrieving
the data instance, which allows for a default to be returned if no
data have been set; as well as a <a class="reference internal" href="method/cf.Field.del_data.html#cf.Field.del_data" title="cf.Field.del_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">del_data</span></code></a> method for removing
the data.</p>
<p>The field construct (and any other construct that contains data) also
provides attributes for direct access.</p>
<div class="literal-block-wrapper docutils container" id="id137">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve a numpy array of the data.</em></span><a class="headerlink" href="#id137" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">numpy.ma.core.MaskedArray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">[[[262.8 270.5 279.8 269.5 260.9 265.0 263.5 278.9 269.2]</span>
<span class="go">  [272.7 268.4 279.5 278.9 263.8 263.3 274.2 265.7 279.5]</span>
<span class="go">  [269.7 279.1 273.4 274.2 279.6 270.2 280.  272.5 263.7]</span>
<span class="go">  [261.7 260.6 270.8 260.3 265.6 279.4 276.9 267.6 260.6]</span>
<span class="go">  [264.2 275.9 262.5 264.9 264.7 270.2 270.4 268.6 275.3]</span>
<span class="go">  [263.9 263.8 272.1 263.7 272.2 264.2 260.  263.5 270.2]</span>
<span class="go">  [273.8 273.1 268.5 272.3 264.3 278.7 270.6 273.0 270.6]</span>
<span class="go">  [267.9 273.5 279.8 260.3 261.2 275.3 271.2 260.8 268.9]</span>
<span class="go">  [270.9 278.7 273.2 261.7 271.6 265.8 273.  278.5 266.4]</span>
<span class="go">  [276.4 264.2 276.3 266.1 276.1 268.1 277.  273.4 269.7]]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id138">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the data type, number of dimensions, dimension
sizes and number of elements of the data.</em></span><a class="headerlink" href="#id138" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;float64&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">ndim</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 10, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">size</span>
<span class="go">90</span>
</pre></div>
</div>
</div>
<p>The array is stored internally as a <a class="reference internal" href="performance.html#performance"><span class="std std-ref">Dask array</span></a>,
which can be retrieved with the <a class="reference internal" href="attribute/cf.Field.to_dask_array.html#cf.Field.to_dask_array" title="cf.Field.to_dask_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_dask_array()</span></code></a> method of the
field construct:</p>
<div class="literal-block-wrapper docutils container" id="id139">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the dask array of the data.</em></span><a class="headerlink" href="#id139" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">to_dask_array</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">dask.array&lt;array, shape=(1, 10, 9), dtype=float64, chunksize=(1, 10, 9), chunktype=numpy.ndarray&gt;</span>
</pre></div>
</div>
</div>
<p>Note that changes to the returned Dask array in-place will also be
seen in the field construct.</p>
<p>All of the methods and attributes related to the data are listed
<a class="reference internal" href="class/cf.Field.html#field-data"><span class="std std-ref">here</span></a>.</p>
<section id="data-axes">
<span id="id18"></span><h3><a class="toc-backref" href="#id394">Data axes</a><a class="headerlink" href="#data-axes" title="Permalink to this headline">¶</a></h3>
<p>The data array of the field construct spans all the domain axis
constructs with the possible exception of size one domain axis
constructs. The domain axis constructs spanned by the field
construct’s data are found with the <a class="reference internal" href="method/cf.Field.get_data_axes.html#cf.Field.get_data_axes" title="cf.Field.get_data_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_data_axes</span></code></a> method of
the field construct. For example, the data of the field construct
<code class="docutils literal notranslate"><span class="pre">t</span></code> does not span the size one domain axis construct with key
<code class="docutils literal notranslate"><span class="pre">'domainaxis3'</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id140">
<div class="code-block-caption"><span class="caption-text"><em>Show which data axis constructs are spanned by the field
construct’s data.</em></span><a class="headerlink" href="#id140" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">domain_axes</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainaxis0&#39;: &lt;CF DomainAxis: size(1)&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;CF DomainAxis: size(10)&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;CF DomainAxis: size(9)&gt;,</span>
<span class="go"> &#39;domainaxis3&#39;: &lt;CF DomainAxis: size(1)&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 10, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_data_axes</span><span class="p">()</span>
<span class="go">(&#39;domainaxis0&#39;, &#39;domainaxis1&#39;, &#39;domainaxis2&#39;)</span>
</pre></div>
</div>
</div>
<p>The data may be set with the <a class="reference internal" href="method/cf.Field.set_data.html#cf.Field.set_data" title="cf.Field.set_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_data</span></code></a> method of the field
construct. The domain axis constructs spanned by the data are inferred
from the existing domain axis constructs, provided that there are no
ambiguities (such as two dimensions of the same size), in which case
they can be explicitly provided via their construct keys. In any case,
the data axes may be set at any time with the <a class="reference internal" href="method/cf.Field.set_data_axes.html#cf.Field.set_data_axes" title="cf.Field.set_data_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_data_axes</span></code></a>
method of the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id141">
<div class="code-block-caption"><span class="caption-text"><em>Delete the data and then reinstate it, using the
existing data axes.</em></span><a class="headerlink" href="#id141" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">del_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">has_data</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;CF Data(1, 10, 9): [[[262.8, ..., 269.7]]] K&gt;</span>
</pre></div>
</div>
</div>
<p>See the section <a class="reference internal" href="#field-creation"><span class="std std-ref">field construct creation</span></a> for
more examples.</p>
</section>
<section id="date-time">
<span id="id19"></span><h3><a class="toc-backref" href="#id395">Date-time</a><a class="headerlink" href="#date-time" title="Permalink to this headline">¶</a></h3>
<p>Data representing date-times is defined as elapsed times since a
reference date-time in a particular calendar (Gregorian, by
default). The <a class="reference internal" href="attribute/cf.Data.array.html#cf.Data.array" title="cf.Data.array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> attribute of the <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instance
(and any construct that contains it) returns the elapsed times, and
the <a class="reference internal" href="attribute/cf.Data.datetime_array.html#cf.Data.datetime_array" title="cf.Data.datetime_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datetime_array</span></code></a> (and any construct that contains it)
returns the data as an array of date-time objects.</p>
<div class="literal-block-wrapper docutils container" id="id142">
<div class="code-block-caption"><span class="caption-text"><em>View date-times as elapsed time or as date-time
objects.</em></span><a class="headerlink" href="#id142" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;days since 2004-2-28&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">datetime_array</span><span class="p">)</span>
<span class="go">[cftime.DatetimeGregorian(2004-02-29 00:00:00)</span>
<span class="go"> cftime.DatetimeGregorian(2004-03-01 00:00:00)</span>
<span class="go"> cftime.DatetimeGregorian(2004-03-02 00:00:00)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;days since 2004-2-28&#39;</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;360_day&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">datetime_array</span><span class="p">)</span>
<span class="go">[cftime.Datetime360Day(2004-02-29 00:00:00)</span>
<span class="go"> cftime.Datetime360Day(2004-02-30 00:00:00)</span>
<span class="go"> cftime.Datetime360Day(2004-03-01 00:00:00)]</span>
</pre></div>
</div>
</div>
<p>Alternatively, date-time data may be created by providing date-time
objects or <a class="reference external" href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601-like date-time strings</a>. Date-time objects may be
<a class="reference external" href="https://unidata.github.io/cftime/api.html#cftime.datetime" title="(in cftime)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cftime.datetime</span></code></a> instances (as returned by the <a class="reference internal" href="function/cf.dt.html#cf.dt" title="cf.dt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.dt</span></code></a> and
<a class="reference internal" href="function/cf.dt_vector.html#cf.dt_vector" title="cf.dt_vector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.dt_vector</span></code></a> functions), Python <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a> instances, or
any other date-time object that has an equivalent API.</p>
<div class="literal-block-wrapper docutils container" id="id143">
<div class="code-block-caption"><span class="caption-text"><em>Creating a Data instance from a date-time objects.</em></span><a class="headerlink" href="#id143" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">date_time</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="mi">2004</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">29</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">date_time</span>
<span class="go">cftime.datetime(2004-02-29 00:00:00)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">date_time</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;gregorian&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">datetime_array</span>
<span class="go">array(cftime.DatetimeGregorian(2004-02-29 00:00:00), dtype=object)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id144">
<div class="code-block-caption"><span class="caption-text"><em>Creating Data instances from date-time an array of
date-time objects.</em></span><a class="headerlink" href="#id144" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">date_times</span>  <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">dt_vector</span><span class="p">([</span><span class="s1">&#39;2004-02-29&#39;</span><span class="p">,</span> <span class="s1">&#39;2004-02-30&#39;</span><span class="p">,</span> <span class="s1">&#39;2004-03-01&#39;</span><span class="p">],</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;360_day&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">date_times</span><span class="p">)</span>
<span class="go">[cftime.Datetime360Day(2004-02-29 00:00:00)</span>
<span class="go"> cftime.Datetime360Day(2004-02-30 00:00:00)</span>
<span class="go"> cftime.Datetime360Day(2004-03-01 00:00:00)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">date_times</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[0. 1. 2.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">datetime_array</span><span class="p">)</span>
<span class="go">[cftime.Datetime360Day(2004-02-29 00:00:00)</span>
<span class="go"> cftime.Datetime360Day(2004-02-30 00:00:00)</span>
<span class="go"> cftime.Datetime360Day(2004-03-01 00:00:00)]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id145">
<div class="code-block-caption"><span class="caption-text"><em>Creating Data instances from date-time strings. If no
units or calendar are provided then the “dt” keyword is
required.</em></span><a class="headerlink" href="#id145" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="s1">&#39;2004-02-29&#39;</span><span class="p">,</span> <span class="s1">&#39;2004-02-30&#39;</span><span class="p">,</span> <span class="s1">&#39;2004-03-01&#39;</span><span class="p">],</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;360_day&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">Units</span>
<span class="go">&lt;Units: days since 2004-02-29 360_day&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[0. 1. 2.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">datetime_array</span><span class="p">)</span>
<span class="go">[cftime.Datetime360Day(2004-02-29 00:00:00)</span>
<span class="go"> cftime.Datetime360Day(2004-02-30 00:00:00)</span>
<span class="go"> cftime.Datetime360Day(2004-03-01 00:00:00)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="s1">&#39;2004-02-29&#39;</span><span class="p">,</span> <span class="s1">&#39;2004-03-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2004-03-02&#39;</span><span class="p">],</span> <span class="n">dt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">Units</span>
<span class="go">&lt;Units: days since 2004-02-29&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">datetime_array</span><span class="p">)</span>
<span class="go">[cftime.DatetimeGregorian(2004-02-29 00:00:00)</span>
<span class="go"> cftime.DatetimeGregorian(2004-03-01 00:00:00)</span>
<span class="go"> cftime.DatetimeGregorian(2004-03-02 00:00:00)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="s1">&#39;2004-02-29&#39;</span><span class="p">,</span> <span class="s1">&#39;2004-03-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2004-03-02&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[&#39;2004-02-29&#39; &#39;2004-03-01&#39; &#39;2004-03-02&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">Units</span>
<span class="go">&lt;Units: &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">datetime_array</span><span class="p">)</span>  <span class="c1"># Raises Exception</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">Can&#39;t create date-time array from units &lt;Units: &gt;</span>
</pre></div>
</div>
</div>
</section>
<section id="manipulating-dimensions">
<span id="id20"></span><h3><a class="toc-backref" href="#id396">Manipulating dimensions</a><a class="headerlink" href="#manipulating-dimensions" title="Permalink to this headline">¶</a></h3>
<p>The dimensions of a field construct’s data may be reordered, have size
one dimensions removed and have new new size one dimensions included
by using the following field construct methods:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 37%" />
<col style="width: 63%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.flatten.html#cf.Field.flatten" title="cf.Field.flatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flatten</span></code></a></p></td>
<td><p>Flatten domain axes of the field construct</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.flip.html#cf.Field.flip" title="cf.Field.flip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flip</span></code></a></p></td>
<td><p>Reverse the direction of a data dimension</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.insert_dimension.html#cf.Field.insert_dimension" title="cf.Field.insert_dimension"><code class="xref py py-obj docutils literal notranslate"><span class="pre">insert_dimension</span></code></a></p></td>
<td><p>Insert a new size one data dimension. The
new dimension must correspond to an
existing size one domain axis construct.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.squeeze.html#cf.Field.squeeze" title="cf.Field.squeeze"><code class="xref py py-obj docutils literal notranslate"><span class="pre">squeeze</span></code></a></p></td>
<td><p>Remove size one data dimensions</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.transpose.html#cf.Field.transpose" title="cf.Field.transpose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transpose</span></code></a></p></td>
<td><p>Reorder data dimensions</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.unsqueeze.html#cf.Field.unsqueeze" title="cf.Field.unsqueeze"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unsqueeze</span></code></a></p></td>
<td><p>Insert all missing size one data dimensions</p></td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container" id="id146">
<div class="code-block-caption"><span class="caption-text"><em>Remove all size one dimensions from the data, noting
that metadata constructs which span the corresponding
domain axis construct are not affected.</em></span><a class="headerlink" href="#id146" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span>
<span class="go">&lt;CF Field: air_temperature(grid_latitude(10), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t2</span><span class="o">.</span><span class="n">dimension_coordinates</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;dimensioncoordinate0&#39;: &lt;CF DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;CF DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;CF DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;CF DimensionCoordinate: time(1) days since 2018-12-01 &gt;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id147">
<div class="code-block-caption"><span class="caption-text"><em>Insert a new size one dimension, corresponding to a size
one domain axis construct, and then reorder the
dimensions.</em></span><a class="headerlink" href="#id147" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span> <span class="o">=</span> <span class="n">t2</span><span class="o">.</span><span class="n">insert_dimension</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;domainaxis3&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span>
<span class="go">&lt;CF Field: air_temperature(grid_latitude(10), time(1), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">&lt;CF Field: air_temperature(grid_longitude(9), grid_latitude(10), time(1)) K&gt;</span>
</pre></div>
</div>
</div>
<p>When transposing the data dimensions, the dimensions of metadata
construct data are, by default, unchanged. It is also possible to
permute the data dimensions of the metadata constructs so that they
have the same relative order as the field construct:</p>
<div class="literal-block-wrapper docutils container" id="id148">
<div class="code-block-caption"><span class="caption-text"><em>Also permute the data dimension of metadata constructs
using the ‘constructs’ keyword.</em></span><a class="headerlink" href="#id148" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t4</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="n">constructs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="data-mask">
<span id="id21"></span><h3><a class="toc-backref" href="#id397">Data mask</a><a class="headerlink" href="#data-mask" title="Permalink to this headline">¶</a></h3>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#assignment-by-condition"><span class="std std-ref">Assignment by condition</span></a></p>
</div>
<p>There is always a data mask, which may be thought of as a separate
data array of Booleans with the same shape as the original data. The
data mask is <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> where the the data has values, and <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> where
the data is missing. The data mask may be inspected with the
<a class="reference internal" href="attribute/cf.Field.mask.html#cf.Field.mask" title="cf.Field.mask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mask</span></code></a> attribute of the field construct, which returns the data
mask in a field construct with the same metadata constructs as the
original field construct.</p>
<div class="literal-block-wrapper docutils container" id="id149">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the data mask of a field construct.</em></span><a class="headerlink" href="#id149" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
<span class="go">Field: long_name=mask</span>
<span class="go">---------------------</span>
<span class="go">Data            : long_name=mask(latitude(5), longitude(8))</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[False False False False False False False False]</span>
<span class="go"> [False False False False False False False False]</span>
<span class="go"> [False False False False False False False False]</span>
<span class="go"> [False False False False False False False False]</span>
<span class="go"> [False False False False False False False False]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id150">
<div class="code-block-caption"><span class="caption-text"><em>Mask the polar rows (see the “Assignment by index”
section) and inspect the new data mask.</em></span><a class="headerlink" href="#id150" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">masked</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[ True  True  True  True  True  True  True  True]</span>
<span class="go"> [False False False False False False False False]</span>
<span class="go"> [False False False False False False False False]</span>
<span class="go"> [False False False False False False False False]</span>
<span class="go"> [ True  True  True  True  True  True  True  True]]</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="attribute/cf.Field._FillValue.html#cf.Field._FillValue" title="cf.Field._FillValue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_FillValue</span></code></a> and <a class="reference internal" href="attribute/cf.Field.missing_value.html#cf.Field.missing_value" title="cf.Field.missing_value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">missing_value</span></code></a> attributes of the
field construct are <em>not</em> stored as values of the field construct’s
data. They are only used when <a class="reference internal" href="#writing-to-a-netcdf-dataset"><span class="std std-ref">writing the data to a netCDF
dataset</span></a>. Therefore testing for missing
data by testing for equality to one of these property values will
produce incorrect results; the <a class="reference internal" href="method/cf.Field.any.html#cf.Field.any" title="cf.Field.any"><code class="xref py py-obj docutils literal notranslate"><span class="pre">any</span></code></a> and <a class="reference internal" href="method/cf.Field.all.html#cf.Field.all" title="cf.Field.all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">all</span></code></a> methods
of the field construct should be used instead.</p>
<div class="literal-block-wrapper docutils container" id="id151">
<div class="code-block-caption"><span class="caption-text"><em>See if all, or any, data points are masked.</em></span><a class="headerlink" href="#id151" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<p>The mask of a netCDF dataset array is implied by array values that
meet the criteria implied by the <code class="docutils literal notranslate"><span class="pre">missing_value</span></code>, <code class="docutils literal notranslate"><span class="pre">_FillValue</span></code>,
<code class="docutils literal notranslate"><span class="pre">valid_min</span></code>, <code class="docutils literal notranslate"><span class="pre">valid_max</span></code>, and <code class="docutils literal notranslate"><span class="pre">valid_range</span></code> properties, and is
usually applied automatically by <a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a>. NetCDF data elements that
equal the values of the <code class="docutils literal notranslate"><span class="pre">missing_value</span></code> and <code class="docutils literal notranslate"><span class="pre">_FillValue</span></code>
properties are masked, as are data elements that exceed the value of
the <code class="docutils literal notranslate"><span class="pre">valid_max</span></code> property, succeed the value of the <code class="docutils literal notranslate"><span class="pre">valid_min</span></code>
property, or lie outside of the range defined by the <code class="docutils literal notranslate"><span class="pre">valid_range</span></code>
property.</p>
<p>However, this automatic masking may be bypassed by setting the <em>mask</em>
keyword of the <a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a> function to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>. The mask, as defined in
the dataset, may subsequently be applied manually with the
<a class="reference internal" href="method/cf.Field.apply_masking.html#cf.Field.apply_masking" title="cf.Field.apply_masking"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_masking</span></code></a> method of the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id152">
<div class="code-block-caption"><span class="caption-text"><em>Read a dataset from disk without automatic masking, and
then manually apply the mask</em></span><a class="headerlink" href="#id152" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s1">&#39;masked_q.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">no_mask_q</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;masked_q.nc&#39;</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">no_mask_q</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[9.96920997e+36, 9.96920997e+36, 9.96920997e+36, 9.96920997e+36,</span>
<span class="go"> 9.96920997e+36, 9.96920997e+36, 9.96920997e+36, 9.96920997e+36],</span>
<span class="go"> [0.023 0.036 0.045 0.062 0.046 0.073 0.006 0.066]</span>
<span class="go"> [0.11  0.131 0.124 0.146 0.087 0.103 0.057 0.011]</span>
<span class="go"> [0.029 0.059 0.039 0.07  0.058 0.072 0.009 0.017]</span>
<span class="go">[9.96920997e+36, 9.96920997e+36, 9.96920997e+36, 9.96920997e+36,</span>
<span class="go"> 9.96920997e+36, 9.96920997e+36, 9.96920997e+36, 9.96920997e+36]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masked_q</span> <span class="o">=</span> <span class="n">no_mask_q</span><span class="o">.</span><span class="n">apply_masking</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">masked_q</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[   --    --    --    --    --    --    --    --]</span>
<span class="go"> [0.023 0.036 0.045 0.062 0.046 0.073 0.006 0.066]</span>
<span class="go"> [0.11  0.131 0.124 0.146 0.087 0.103 0.057 0.011]</span>
<span class="go"> [0.029 0.059 0.039 0.07  0.058 0.072 0.009 0.017]</span>
<span class="go"> [   --    --    --    --    --    --    --    --]]</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="method/cf.Field.apply_masking.html#cf.Field.apply_masking" title="cf.Field.apply_masking"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_masking</span></code></a> method of the field construct utilises as
many of the <code class="docutils literal notranslate"><span class="pre">missing_value</span></code>, <code class="docutils literal notranslate"><span class="pre">_FillValue</span></code>, <code class="docutils literal notranslate"><span class="pre">valid_min</span></code>,
<code class="docutils literal notranslate"><span class="pre">valid_max</span></code>, and <code class="docutils literal notranslate"><span class="pre">valid_range</span></code> properties as are present and may
be used on any construct, not just those that have been read from
datasets.</p>
<hr class="docutils" />
</section>
</section>
<section id="subspacing-by-index">
<span id="id22"></span><h2><a class="toc-backref" href="#id398"><strong>Subspacing by index</strong></a><a class="headerlink" href="#subspacing-by-index" title="Permalink to this headline">¶</a></h2>
<p>Creation of a new field construct which spans a subspace of the domain
of an existing field construct is achieved either by indexing the
field construct directly (as described in this section) or by
identifying indices based on the metadata constructs (see
<a class="reference internal" href="#subspacing-by-metadata"><span class="std std-ref">Subspacing by metadata</span></a>). The subspacing operation, in either
case, also subspaces any metadata constructs of the field construct
(e.g. coordinate metadata constructs) which span any of the domain
axis constructs that are affected. The new field construct is created
with the same properties as the original field construct.</p>
<p>Subspacing by indexing uses rules that are very similar to the <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/arrays.indexing.html">numpy
indexing rules</a>,
the only differences being:</p>
<ul class="simple">
<li><p>An integer index <em>i</em> specified for a dimension reduces the size of
this dimension to unity, taking just the <em>i</em>-th element, but keeps
the dimension itself, so that the rank of the array is not reduced.</p></li>
</ul>
<ul class="simple">
<li><p>When two or more dimensions’ indices are sequences of integers then
these indices work independently along each dimension (similar to
the way vector subscripts work in FORTRAN). This is the same
indexing behaviour as on a <code class="docutils literal notranslate"><span class="pre">Variable</span></code> object of the <a class="reference external" href="http://unidata.github.io/netcdf4-python">netCDF4
package</a>.</p></li>
</ul>
<ul class="simple">
<li><p>For a dimension that is <a class="reference internal" href="#cyclic-domain-axes"><span class="std std-ref">cyclic</span></a>, a range
of indices specified by a <a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">slice</span></code></a> that spans the edges of the data
(such as <code class="docutils literal notranslate"><span class="pre">-2:3</span></code> or <code class="docutils literal notranslate"><span class="pre">3:-2:-1</span></code>) is assumed to “wrap” around,
rather then producing a null result.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id153">
<div class="code-block-caption"><span class="caption-text"><em>Create a new field construct whose domain spans the first
longitude of the original, and with a reversed latitude
axis.</em></span><a class="headerlink" href="#id153" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: time(1) = [2019-01-01 00:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">new</span> <span class="o">=</span> <span class="n">q</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(1)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: time(1) = [2019-01-01 00:00:00]</span>
<span class="go">                : latitude(5) = [75.0, ..., -75.0] degrees_north</span>
<span class="go">                : longitude(1) = [22.5] degrees_east</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id154">
<div class="code-block-caption"><span class="caption-text"><em>Create new field constructs with a variety of indexing
techniques.</em></span><a class="headerlink" href="#id154" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="go">&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(1)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(1), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<span class="go">&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(3), grid_longitude(3)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]</span>
<span class="go">&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(3), grid_longitude(2)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="go">&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(1)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]]</span>
<span class="go">&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(4)) K&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id155">
<div class="code-block-caption"><span class="caption-text"><em>Subspacing a cyclic dimension with a slice will wrap
around the data edges.</em></span><a class="headerlink" href="#id155" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span>
<span class="go">&lt;CF Field: specific_humidity(latitude(5), longitude(8)) 1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">cyclic</span><span class="p">()</span>
<span class="go">{&#39;domainaxis1&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">domain_axis_identity</span><span class="p">(</span><span class="s1">&#39;domainaxis1&#39;</span><span class="p">)</span>
<span class="go">&#39;longitude&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(5)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(5) = [-67.5, ..., 112.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(5)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(5) = [157.5, ..., -22.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
</pre></div>
</div>
</div>
<p>A <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instance can also directly be indexed in the same way:</p>
<div class="literal-block-wrapper docutils container" id="id156">
<div class="code-block-caption"><span class="caption-text"><em>Create a new ‘Data’ instance by indexing.</em></span><a class="headerlink" href="#id156" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]</span>
<span class="go">&lt;CF Data(1, 3, 2): [[[279.6, ..., 269.7]]] K&gt;</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="assignment-by-index">
<span id="id23"></span><h2><a class="toc-backref" href="#id399"><strong>Assignment by index</strong></a><a class="headerlink" href="#assignment-by-index" title="Permalink to this headline">¶</a></h2>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#assignment-by-condition"><span class="std std-ref">Assignment by condition</span></a>,
<a class="reference internal" href="#assignment-by-metadata"><span class="std std-ref">Assignment by metadata</span></a></p>
</div>
<p>Data elements can be changed by assigning to elements selected by
indices of the data (as described in this section); by conditions
based on the data values of the field construct or one of its metadata
constructs (see <a class="reference internal" href="#assignment-by-condition"><span class="std std-ref">Assignment by condition</span></a>); or by identifying
indices based on arbitrary metadata constructs (see
<a class="reference internal" href="#assignment-by-metadata"><span class="std std-ref">Assignment by metadata</span></a>).</p>
<p>Assignment by indices uses rules that are very similar to the <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/arrays.indexing.html">numpy
indexing rules</a>,
the only difference being:</p>
<ul class="simple">
<li><p>When two or more dimensions’ indices are sequences of integers then
these indices work independently along each dimension (similar to
the way vector subscripts work in FORTRAN). This is the same
indexing behaviour as on a <code class="docutils literal notranslate"><span class="pre">Variable</span></code> object of the <a class="reference external" href="http://unidata.github.io/netcdf4-python">netCDF4
package</a>.</p></li>
</ul>
<ul class="simple">
<li><p>For a dimension that is <a class="reference internal" href="#cyclic-domain-axes"><span class="std std-ref">cyclic</span></a>, a range
of indices specified by a <a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">slice</span></code></a> that spans the edges of the data
(such as <code class="docutils literal notranslate"><span class="pre">-2:3</span></code> or <code class="docutils literal notranslate"><span class="pre">3:-2:-1</span></code>) is assumed to “wrap” around,
rather then producing a null result.</p></li>
</ul>
<p>A single value may be assigned to any number of elements.</p>
<div class="literal-block-wrapper docutils container" id="id157">
<div class="code-block-caption"><span class="caption-text"><em>Set a single element to -1, a “column” of elements
to -2 and a “square” of elements to -3.</em></span><a class="headerlink" href="#id157" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[ -1.0  -2.0 279.8 269.5 260.9 265.0 263.5 278.9 269.2]</span>
<span class="go">  [272.7  -2.0 279.5 278.9 263.8 263.3 274.2 265.7 279.5]</span>
<span class="go">  [269.7  -2.0 273.4 274.2 279.6 270.2 280.0 272.5 263.7]</span>
<span class="go">  [261.7  -2.0 270.8 260.3 265.6 279.4 276.9 267.6 260.6]</span>
<span class="go">  [264.2  -2.0 262.5  -3.0  -3.0  -3.0 270.4 268.6 275.3]</span>
<span class="go">  [263.9  -2.0 272.1  -3.0  -3.0  -3.0 260.0 263.5 270.2]</span>
<span class="go">  [273.8  -2.0 268.5  -3.0  -3.0  -3.0 270.6 273.0 270.6]</span>
<span class="go">  [267.9  -2.0 279.8 260.3 261.2 275.3 271.2 260.8 268.9]</span>
<span class="go">  [270.9  -2.0 273.2 261.7 271.6 265.8 273.0 278.5 266.4]</span>
<span class="go">  [276.4  -2.0 276.3 266.1 276.1 268.1 277.0 273.4 269.7]]]</span>
</pre></div>
</div>
</div>
<p>An array of values can be assigned, as long as it is broadcastable to
the shape defined by the indices, using the <a class="reference external" href="https://docs.scipy.org/doc/numpy/user/basics.broadcasting.html">numpy broadcasting
rules</a>.</p>
<div class="literal-block-wrapper docutils container" id="id158">
<div class="code-block-caption"><span class="caption-text"><em>Assigning arrays of values.</em></span><a class="headerlink" href="#id158" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]</span> <span class="o">=</span>  <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">11</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[ -1.0  -2.0 279.8 269.5 260.9 265.0 263.5 278.9 269.2]</span>
<span class="go">  [272.7  -2.0 279.5 278.9 263.8 263.3 274.2 265.7 279.5]</span>
<span class="go">  [269.7  -2.0 273.4 274.2  -4.0 270.2 280.0 272.5  -5.0]</span>
<span class="go">  [261.7  -2.0 270.8 260.3 265.6 279.4 276.9 267.6 260.6]</span>
<span class="go">  [-10.0  -2.0 262.5   6.0   7.0   8.0 270.4 268.6 275.3]</span>
<span class="go">  [263.9  -2.0 272.1   3.0   4.0   5.0 260.0 263.5 270.2]</span>
<span class="go">  [273.8  -2.0 268.5   0.0   1.0   2.0 270.6 273.0 270.6]</span>
<span class="go">  [-11.0  -2.0 279.8 260.3 261.2 275.3 271.2 260.8 268.9]</span>
<span class="go">  [270.9  -2.0 273.2 261.7 271.6 265.8 273.0 278.5 266.4]</span>
<span class="go">  [276.4  -2.0 276.3 266.1  -4.0 268.1 277.0 273.4  -5.0]]]</span>
</pre></div>
</div>
</div>
<p>In-place modification is also possible:</p>
<div class="literal-block-wrapper docutils container" id="id159">
<div class="code-block-caption"><span class="caption-text"><em>Modifying the data in-place.</em></span><a class="headerlink" href="#id159" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[269.2]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="o">-</span><span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[-26.92]]]</span>
</pre></div>
</div>
</div>
<p>A <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instance can also assigned values in the same way:</p>
<div class="literal-block-wrapper docutils container" id="id160">
<div class="code-block-caption"><span class="caption-text"><em>Assign to the ‘Data’ instance directly.</em></span><a class="headerlink" href="#id160" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[-99.]]]</span>
</pre></div>
</div>
</div>
<section id="masked-values">
<span id="id26"></span><h3><a class="toc-backref" href="#id400">Masked values</a><a class="headerlink" href="#masked-values" title="Permalink to this headline">¶</a></h3>
<p>Data array elements may be set to masked values by assigning them to
the <a class="reference internal" href="constant.html#cf.cf.masked" title="cf.cf.masked"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.masked</span></code></a> constant, thereby updating the the <a class="reference internal" href="#data-mask"><span class="std std-ref">data mask</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id161">
<div class="code-block-caption"><span class="caption-text"><em>Set a column of elements to masked values.</em></span><a class="headerlink" href="#id161" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">masked</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[ -1.0  -2.0 279.8 269.5 260.9 265.0 263.5    -- -99.0]</span>
<span class="go">  [272.7  -2.0 279.5 278.9 263.8 263.3 274.2    -- 279.5]</span>
<span class="go">  [269.7  -2.0 273.4 274.2  -4.0 270.2 280.0    --  -5.0]</span>
<span class="go">  [261.7  -2.0 270.8 260.3 265.6 279.4 276.9    -- 260.6]</span>
<span class="go">  [264.2  -2.0 262.5   6.0   7.0   8.0 270.4    -- 275.3]</span>
<span class="go">  [263.9  -2.0 272.1   3.0   4.0   5.0 260.0    -- 270.2]</span>
<span class="go">  [273.8  -2.0 268.5   0.0   1.0   2.0 270.6    -- 270.6]</span>
<span class="go">  [-11.0  -2.0 279.8 260.3 261.2 275.3 271.2    -- 268.9]</span>
<span class="go">  [270.9  -2.0 273.2 261.7 271.6 265.8 273.0    -- 266.4]</span>
<span class="go">  [276.4  -2.0 276.3 266.1  -4.0 268.1 277.0    --  -5.0]]]</span>
</pre></div>
</div>
</div>
<p>By default the data mask is “hard”, meaning that masked values can not
be changed by assigning them to another value. This behaviour may be
changed by setting the <a class="reference internal" href="attribute/cf.Field.hardmask.html#cf.Field.hardmask" title="cf.Field.hardmask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hardmask</span></code></a> attribute of the field
construct to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, thereby making the data mask “soft”.</p>
<div class="literal-block-wrapper docutils container" id="id162">
<div class="code-block-caption"><span class="caption-text"><em>Changing masked elements back to data values is only
possible when the “hardmask” attribute is False.</em></span><a class="headerlink" href="#id162" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[--]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">hardmask</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[99.]]]</span>
</pre></div>
</div>
</div>
<p>Note that this is the opposite behaviour to <a class="reference external" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="(in NumPy v1.24)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy</span></code></a> arrays, which
assume that the mask is <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/maskedarray.generic.html#modifying-the-mask">soft by default</a>. The
reason for the difference is so that land-sea masks are, by default,
preserved through assignment operations.</p>
</section>
<section id="assignment-from-other-field-constructs">
<span id="id27"></span><h3><a class="toc-backref" href="#id401">Assignment from other field constructs</a><a class="headerlink" href="#assignment-from-other-field-constructs" title="Permalink to this headline">¶</a></h3>
<p>Another field construct can also be assigned to indices. The other
field construct’s data is actually assigned, but only after being
transformed so that it is broadcastable to the subspace defined by the
assignment indices. This is done by using the metadata constructs of
the two field constructs to create a mapping of physically compatible
dimensions between the fields, and then <a class="reference internal" href="#manipulating-dimensions"><span class="std std-ref">manipulating the
dimensions</span></a> of the other field construct’s
data to ensure that they are broadcastable.</p>
<div class="literal-block-wrapper docutils container" id="id163">
<div class="code-block-caption"><span class="caption-text"><em>Transform a field construct’s data and assign it back to
the original field, demonstrating that this is a null
operation.</em></span><a class="headerlink" href="#id163" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">t0</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id164">
<div class="code-block-caption"><span class="caption-text"><em>Broadcasting is carried out after transforms to ensure
field construct compatibility.</em></span><a class="headerlink" href="#id164" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[270.5 279.8]</span>
<span class="go">   [268.4 279.5]</span>
<span class="go">   [279.1 273.4]</span>
<span class="go">   [260.6 270.8]</span>
<span class="go">   [275.9 262.5]</span>
<span class="go">   [263.8 272.1]</span>
<span class="go">   [273.1 268.5]</span>
<span class="go">   [273.5 279.8]</span>
<span class="go">   [278.7 273.2]</span>
<span class="go">   [264.2 276.3]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[277.  273.  271.2 270.6 260.  270.4 276.9 280.  274.2 263.5]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[263.5 263.5]</span>
<span class="go">  [274.2 274.2]</span>
<span class="go">  [280.  280. ]</span>
<span class="go">  [276.9 276.9]</span>
<span class="go">  [270.4 270.4]</span>
<span class="go">  [260.  260. ]</span>
<span class="go">  [270.6 270.6]</span>
<span class="go">  [271.2 271.2]</span>
<span class="go">  [273.  273. ]</span>
<span class="go">  [277.  277. ]]]</span>
</pre></div>
</div>
</div>
<p>If either of the field constructs does not have sufficient metadata to
create the such a mapping, then any manipulation of the dimensions
must be done manually, and the other field construct’s <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instance
(rather than the field construct itself) may be assigned.</p>
</section>
<section id="assignment-of-bounds">
<span id="id28"></span><h3><a class="toc-backref" href="#id402">Assignment of bounds</a><a class="headerlink" href="#assignment-of-bounds" title="Permalink to this headline">¶</a></h3>
<p>When assigning an object that has bounds to an object that also has
bounds, then the bounds are also assigned. This is the only
circumstance that allows bounds to be updated during assignment by
index.</p>
<hr class="docutils" />
</section>
</section>
<section id="units">
<h2><a class="toc-backref" href="#id403"><strong>Units</strong></a><a class="headerlink" href="#units" title="Permalink to this headline">¶</a></h2>
<p>The field construct, and any metadata construct that contains data,
has units which are described by the <a class="reference internal" href="attribute/cf.Field.Units.html#cf.Field.Units" title="cf.Field.Units"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Units</span></code></a> attribute that
stores a <a class="reference internal" href="class/cf.Units.html#cf.Units" title="cf.Units"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Units</span></code></a> object (which is identical to a <a class="reference external" href="https://ncas-cms.github.io/cfunits/cfunits.Units.html#cfunits.Units" title="(in Python cfunits package v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfunits.Units</span></code></a>
object of the <a class="reference external" href="https://ncas-cms.github.io/cfunits">cfunits package</a>). The <a class="reference internal" href="attribute/cf.Field.units.html#cf.Field.units" title="cf.Field.units"><code class="xref py py-obj docutils literal notranslate"><span class="pre">units</span></code></a> property
provides the units contained in the <a class="reference internal" href="class/cf.Units.html#cf.Units" title="cf.Units"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Units</span></code></a> instance, and changes
in one are reflected in the other.</p>
<div class="literal-block-wrapper docutils container" id="id165">
<div class="code-block-caption"><span class="caption-text"><em>Inspection and changing of units.</em></span><a class="headerlink" href="#id165" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">units</span>
<span class="go">&#39;K&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">Units</span>
<span class="go">&lt;Units: K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degreesC&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">units</span>
<span class="go">&#39;degreesC&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">Units</span>
<span class="go">&lt;Units: degreesC&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">Units</span> <span class="o">+=</span> <span class="mf">273.15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">units</span>
<span class="go">&#39;K&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">Units</span>
<span class="go">&lt;Units: K&gt;</span>
</pre></div>
</div>
</div>
<p>When the units are changed, the data are automatically converted to
the new units when next accessed.</p>
<div class="literal-block-wrapper docutils container" id="id166">
<div class="code-block-caption"><span class="caption-text"><em>Changing the units automatically results in conversion of
the data values.</em></span><a class="headerlink" href="#id166" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;CF Data(1, 10, 9): [[[262.8, ..., 269.7]]] K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">Units</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Units</span><span class="p">(</span><span class="s1">&#39;degreesC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;CF Data(1, 10, 9): [[[-10.35, ..., -3.45]]] degreesC&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;Kelvin&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;CF Data(1, 10, 9): [[[262.8, ..., 269.7]]] Kelvin&gt;</span>
</pre></div>
</div>
</div>
<p>When assigning to the data with values that have units, the values are
automatically converted to have the same units as the data.</p>
<div class="literal-block-wrapper docutils container" id="id167">
<div class="code-block-caption"><span class="caption-text"><em>Automatic conversions occur when assigning from data
with different units.</em></span><a class="headerlink" href="#id167" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;CF Data(1, 10, 9): [[[262.8, ..., 269.7]]] Kelvin&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;CF Data(1, 10, 9): [[[1.0, ..., 269.7]]] Kelvin&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;degreesC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;CF Data(1, 10, 9): [[[274.15, ..., 269.7]]] Kelvin&gt;</span>
</pre></div>
</div>
</div>
<p>Automatic units conversions are also carried out between operands
during <a class="reference internal" href="#mathematical-operations"><span class="std std-ref">mathematical operations</span></a>.</p>
<section id="calendar">
<span id="id29"></span><h3><a class="toc-backref" href="#id404">Calendar</a><a class="headerlink" href="#calendar" title="Permalink to this headline">¶</a></h3>
<p>When the data represents date-times, the <a class="reference internal" href="class/cf.Units.html#cf.Units" title="cf.Units"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Units</span></code></a> instance describes
both the units and calendar of the data. If the latter is missing then
the Gregorian calendar is assumed, as per the CF conventions.  The
<a class="reference internal" href="attribute/cf.Field.calendar.html#cf.Field.calendar" title="cf.Field.calendar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calendar</span></code></a> property provides the calendar contained in the
<a class="reference internal" href="class/cf.Units.html#cf.Units" title="cf.Units"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Units</span></code></a> instance, and changes in one are reflected in the other.</p>
<div class="literal-block-wrapper docutils container" id="id168">
<div class="code-block-caption"><span class="caption-text"><em>The calendar of date-times is available as a property or
via the Units instance.</em></span><a class="headerlink" href="#id168" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">air_temp</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;air_temperature.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">air_temp</span><span class="o">.</span><span class="n">coordinate</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">units</span>
<span class="go">&#39;days since 1860-1-1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">calendar</span>
<span class="go">&#39;360_day&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">Units</span>
<span class="go">&lt;Units: days since 1860-1-1 360_day&gt;</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="filtering-metadata-constructs">
<span id="id30"></span><h2><a class="toc-backref" href="#id405"><strong>Filtering metadata constructs</strong></a><a class="headerlink" href="#filtering-metadata-constructs" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference internal" href="class/cf.Constructs.html#cf.Constructs" title="cf.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Constructs</span></code></a> instance has filtering methods for selecting
constructs that meet various criteria:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Filter criteria</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code></p></td>
<td><p>General purpose interface to all other filter methods</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Constructs.filter_by_identity.html#cf.Constructs.filter_by_identity" title="cf.Constructs.filter_by_identity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_identity</span></code></a></p></td>
<td><p>Metadata construct identity</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Constructs.filter_by_type.html#cf.Constructs.filter_by_type" title="cf.Constructs.filter_by_type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_type</span></code></a></p></td>
<td><p>Metadata construct type</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Constructs.filter_by_property.html#cf.Constructs.filter_by_property" title="cf.Constructs.filter_by_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_property</span></code></a></p></td>
<td><p>Property values</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Constructs.filter_by_axis.html#cf.Constructs.filter_by_axis" title="cf.Constructs.filter_by_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_axis</span></code></a></p></td>
<td><p>The domain axis constructs spanned by the data</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Constructs.filter_by_naxes.html#cf.Constructs.filter_by_naxes" title="cf.Constructs.filter_by_naxes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_naxes</span></code></a></p></td>
<td><p>The number of domain axis constructs spanned by the data</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Constructs.filter_by_size.html#cf.Constructs.filter_by_size" title="cf.Constructs.filter_by_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_size</span></code></a></p></td>
<td><p>The size domain axis constructs</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Constructs.filter_by_measure.html#cf.Constructs.filter_by_measure" title="cf.Constructs.filter_by_measure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_measure</span></code></a></p></td>
<td><p>Measure value (for cell measure constructs)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Constructs.filter_by_method.html#cf.Constructs.filter_by_method" title="cf.Constructs.filter_by_method"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_method</span></code></a></p></td>
<td><p>Method value (for cell method constructs)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Constructs.filter_by_data.html#cf.Constructs.filter_by_data" title="cf.Constructs.filter_by_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_data</span></code></a></p></td>
<td><p>Whether or not there could be be data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Constructs.filter_by_key.html#cf.Constructs.filter_by_key" title="cf.Constructs.filter_by_key"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_key</span></code></a></p></td>
<td><p>Construct key</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Constructs.filter_by_ncvar.html#cf.Constructs.filter_by_ncvar" title="cf.Constructs.filter_by_ncvar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_ncvar</span></code></a></p></td>
<td><p>NetCDF variable name (see the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Constructs.filter_by_ncdim.html#cf.Constructs.filter_by_ncdim" title="cf.Constructs.filter_by_ncdim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_ncdim</span></code></a></p></td>
<td><p>NetCDF dimension name (see the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>)</p></td>
</tr>
</tbody>
</table>
<p>The <code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code> method of a <a class="reference internal" href="class/cf.Constructs.html#cf.Constructs" title="cf.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constructs</span></code></a> instance allows
these filters to be chained together in a single call.</p>
<p>Each of these methods returns a new <a class="reference internal" href="class/cf.Constructs.html#cf.Constructs" title="cf.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Constructs</span></code></a> instance that
contains the selected metadata constructs.</p>
<div class="literal-block-wrapper docutils container" id="id169">
<div class="code-block-caption"><span class="caption-text"><em>Get constructs by their type</em>.</span><a class="headerlink" href="#id169" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;dimension_coordinate&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;dimensioncoordinate0&#39;: &lt;CF DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;CF DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;CF DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;CF DimensionCoordinate: time(1) days since 2018-12-01 &gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;cell_method&#39;</span><span class="p">,</span> <span class="s1">&#39;field_ancillary&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmethod0&#39;: &lt;CF CellMethod: domainaxis1: domainaxis2: mean where land (interval: 0.1 degrees)&gt;,</span>
<span class="go"> &#39;cellmethod1&#39;: &lt;CF CellMethod: domainaxis3: maximum&gt;,</span>
<span class="go"> &#39;fieldancillary0&#39;: &lt;CF FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id170">
<div class="code-block-caption"><span class="caption-text"><em>Get constructs by their properties</em>.</span><a class="headerlink" href="#id170" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_property</span><span class="p">(</span>
<span class="gp">... </span>            <span class="n">standard_name</span><span class="o">=</span><span class="s1">&#39;air_temperature standard_error&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;fieldancillary0&#39;: &lt;CF FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_property</span><span class="p">(</span>
<span class="gp">... </span>            <span class="n">standard_name</span><span class="o">=</span><span class="s1">&#39;air_temperature standard_error&#39;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">units</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;fieldancillary0&#39;: &lt;CF FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_property</span><span class="p">(</span>
<span class="gp">... </span>            <span class="s1">&#39;or&#39;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">standard_name</span><span class="o">=</span><span class="s1">&#39;air_temperature standard_error&#39;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainancillary0&#39;: &lt;CF DomainAncillary: ncvar%a(1) m&gt;,</span>
<span class="go"> &#39;domainancillary2&#39;: &lt;CF DomainAncillary: surface_altitude(10, 9) m&gt;,</span>
<span class="go"> &#39;fieldancillary0&#39;: &lt;CF FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id171">
<div class="code-block-caption"><span class="caption-text"><em>Get constructs whose data span at least one of the ‘Y’
and ‘X’ domain axis constructs.</em></span><a class="headerlink" href="#id171" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_axis</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">axis_mode</span><span class="o">=</span><span class="s1">&#39;or&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;CF AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: &lt;CF AuxiliaryCoordinate: longitude(9, 10) degrees_E&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate2&#39;: &lt;CF AuxiliaryCoordinate: long_name=Grid latitude name(10) &gt;,</span>
<span class="go"> &#39;cellmeasure0&#39;: &lt;CF CellMeasure: measure:area(9, 10) km2&gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;CF DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;domainancillary2&#39;: &lt;CF DomainAncillary: surface_altitude(10, 9) m&gt;,</span>
<span class="go"> &#39;fieldancillary0&#39;: &lt;CF FieldAncillary: air_temperature standard_error(10, 9) K&gt;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id172">
<div class="code-block-caption"><span class="caption-text"><em>Get cell measure constructs by their “measure”.</em></span><a class="headerlink" href="#id172" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_measure</span><span class="p">(</span><span class="s1">&#39;area&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmeasure0&#39;: &lt;CF CellMeasure: measure:area(9, 10) km2&gt;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id173">
<div class="code-block-caption"><span class="caption-text"><em>Get cell method constructs by their “method”.</em></span><a class="headerlink" href="#id173" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_method</span><span class="p">(</span><span class="s1">&#39;maximum&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmethod1&#39;: &lt;CF CellMethod: domainaxis3: maximum&gt;}</span>
</pre></div>
</div>
</div>
<p>As each of these methods returns a <a class="reference internal" href="class/cf.Constructs.html#cf.Constructs" title="cf.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Constructs</span></code></a> instance, it is
easy to perform further filters on their results:</p>
<div class="literal-block-wrapper docutils container" id="id174">
<div class="code-block-caption"><span class="caption-text"><em>Make selections from previous selections.</em></span><a class="headerlink" href="#id174" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;auxiliary_coordinate&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter_by_axis</span><span class="p">(</span><span class="s1">&#39;domainaxis2&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;CF AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: &lt;CF AuxiliaryCoordinate: longitude(9, 10) degrees_E&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;dimension_coordinate&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">filter_by_property</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="s1">&#39;degrees&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;dimensioncoordinate1&#39;: &lt;CF DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;CF DimensionCoordinate: grid_longitude(9) degrees&gt;}</span>
</pre></div>
</div>
</div>
<section id="construct-identities">
<span id="id31"></span><h3><a class="toc-backref" href="#id406">Construct identities</a><a class="headerlink" href="#construct-identities" title="Permalink to this headline">¶</a></h3>
<p>Another method of selection is by metadata construct “identity”.
Construct identities are used to describe constructs when they are
inspected, and so it is often convenient to copy these identities when
selecting metadata constructs. For example, the <a class="reference internal" href="#medium-detail"><span class="std std-ref">three auxiliary
coordinate constructs</span></a> in the field construct <code class="docutils literal notranslate"><span class="pre">t</span></code>
have identities <code class="docutils literal notranslate"><span class="pre">'latitude'</span></code>, <code class="docutils literal notranslate"><span class="pre">'longitude'</span></code> and <code class="docutils literal notranslate"><span class="pre">'long_name=Grid</span>
<span class="pre">latitude</span> <span class="pre">name'</span></code>.</p>
<p>A construct’s identity may be any one of the following</p>
<ul class="simple">
<li><p>The value of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">standard_name</span></code> property, e.g. <code class="docutils literal notranslate"><span class="pre">'air_temperature'</span></code>,</p></li>
<li><p>The value of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">id</span></code> attribute, preceded by <code class="docutils literal notranslate"><span class="pre">'id%='</span></code>,</p></li>
<li><p>The physical nature of the construct denoted by <code class="docutils literal notranslate"><span class="pre">'X'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Y'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'Z'</span></code> or <code class="docutils literal notranslate"><span class="pre">'T'</span></code>, denoting longitude (or x-projection), latitude
(or y-projection), vertical and temporal constructs respectively,</p></li>
<li><p>The value of any property, preceded by the property name and an
equals, e.g. <code class="docutils literal notranslate"><span class="pre">'long_name=Air</span> <span class="pre">Temperature'</span></code>, <code class="docutils literal notranslate"><span class="pre">'axis=X'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'foo=bar'</span></code>, etc.,</p></li>
<li><p>The cell measure, preceded by “measure:”, e.g. <code class="docutils literal notranslate"><span class="pre">'measure:volume'</span></code></p></li>
<li><p>The cell method, preceded by “method:”, e.g. <code class="docutils literal notranslate"><span class="pre">'method:maximum'</span></code></p></li>
<li><p>The netCDF variable name, preceded by “ncvar%”,
e.g. <code class="docutils literal notranslate"><span class="pre">'ncvar%tas'</span></code> (see the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>),</p></li>
<li><p>The netCDF dimension name, preceded by “ncdim%” e.g. <code class="docutils literal notranslate"><span class="pre">'ncdim%z'</span></code>
(see the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>), and</p></li>
<li><p>The construct key, optionally preceded by “key%”,
e.g. <code class="docutils literal notranslate"><span class="pre">'auxiliarycoordinate2'</span></code> or <code class="docutils literal notranslate"><span class="pre">'key%auxiliarycoordinate2'</span></code>.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id175">
<div class="code-block-caption"><span class="caption-text"><em>Get constructs by their identity.</em></span><a class="headerlink" href="#id175" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">Field: air_temperature (ncvar%ta)</span>
<span class="go">---------------------------------</span>
<span class="go">Data            : air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K</span>
<span class="go">Cell methods    : grid_latitude(10): grid_longitude(9): mean where land (interval: 0.1 degrees) time(1): maximum</span>
<span class="go">Field ancils    : air_temperature standard_error(grid_latitude(10), grid_longitude(9)) = [[0.81, ..., 0.78]] K</span>
<span class="go">Dimension coords: time(1) = [2019-01-01 00:00:00]</span>
<span class="go">                : atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [2.2, ..., -1.76] degrees</span>
<span class="go">                : grid_longitude(9) = [-4.7, ..., -1.18] degrees</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[53.941, ..., 50.225]] degrees_N</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[2.004, ..., 8.156]] degrees_E</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., &#39;kappa&#39;]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[2391.9657, ..., 2392.6009]] km2</span>
<span class="go">Coord references: grid_mappng_name:rotated_latitude_longitude</span>
<span class="go">                : standard_name:atmosphere_hybrid_height_coordinate</span>
<span class="go">Domain ancils   : ncvar%a(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : ncvar%b(atmosphere_hybrid_height_coordinate(1)) = [20.0]</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 270.0]] m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_identity</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate1&#39;: &lt;CF AuxiliaryCoordinate: longitude(9, 10) degrees_E&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;CF DimensionCoordinate: grid_longitude(9) degrees&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_identity</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;CF AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_identity</span><span class="p">(</span><span class="s1">&#39;long_name=Grid latitude name&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate2&#39;: &lt;CF AuxiliaryCoordinate: long_name=Grid latitude name(10) &gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_identity</span><span class="p">(</span><span class="s1">&#39;measure:area&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmeasure0&#39;: &lt;CF CellMeasure: measure:area(9, 10) km2&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_identity</span><span class="p">(</span><span class="s1">&#39;ncvar%b&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainancillary1&#39;: &lt;CF DomainAncillary: ncvar%b(1) &gt;}</span>
</pre></div>
</div>
</div>
<p>The identity returned by the <code class="xref py py-obj docutils literal notranslate"><span class="pre">identity</span></code> method is, by default, the
least ambiguous identity (defined in the method documentation), but it
may be restricted in various ways. See the <em>strict</em> and <em>relaxed</em>
keywords.</p>
<p>As a further convenience, selection by construct identity is also
possible by providing identities to a call of a <a class="reference internal" href="class/cf.Constructs.html#cf.Constructs" title="cf.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Constructs</span></code></a>
instance itself, and this technique for selecting constructs by
identity will be used in the rest of this tutorial:</p>
<div class="literal-block-wrapper docutils container" id="id176">
<div class="code-block-caption"><span class="caption-text"><em>Construct selection by identity is possible with via the
“filter_by_identity” method, or directly from the
“Constructs” instance.</em></span><a class="headerlink" href="#id176" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_identity</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;CF AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;CF AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;}</span>
</pre></div>
</div>
</div>
<p>Selection by construct key is useful for systematic metadata construct
access, or for when a metadata construct is not identifiable by other
means:</p>
<div class="literal-block-wrapper docutils container" id="id177">
<div class="code-block-caption"><span class="caption-text"><em>Get constructs by construct key.</em></span><a class="headerlink" href="#id177" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_key</span><span class="p">(</span><span class="s1">&#39;domainancillary2&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainancillary2&#39;: &lt;CF DomainAncillary: surface_altitude(10, 9) m&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_key</span><span class="p">(</span><span class="s1">&#39;cellmethod1&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmethod1&#39;: &lt;CF CellMethod: domainaxis3: maximum&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_key</span><span class="p">(</span><span class="s1">&#39;auxiliarycoordinate2&#39;</span><span class="p">,</span> <span class="s1">&#39;cellmeasure0&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate2&#39;: &lt;CF AuxiliaryCoordinate: long_name=Grid latitude name(10) &gt;,</span>
<span class="go"> &#39;cellmeasure0&#39;: &lt;CF CellMeasure: measure:area(9, 10) km2&gt;}</span>
</pre></div>
</div>
</div>
<p>If no constructs match the given criteria, then an “empty”
<a class="reference internal" href="class/cf.Constructs.html#cf.Constructs" title="cf.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Constructs</span></code></a> instance is returned:</p>
<div class="literal-block-wrapper docutils container" id="id178">
<div class="code-block-caption"><span class="caption-text"><em>If no constructs meet the criteria then an empty
“Constructs” object is returned.</em></span><a class="headerlink" href="#id178" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;radiation_wavelength&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span>
<span class="go">&lt;CF Constructs: &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</div>
<p>The constructs that were <em>not</em> selected by a filter may be returned by
the <a class="reference internal" href="method/cf.Constructs.inverse_filter.html#cf.Constructs.inverse_filter" title="cf.Constructs.inverse_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inverse_filter</span></code></a> method applied to the results of
filters:</p>
<div class="literal-block-wrapper docutils container" id="id179">
<div class="code-block-caption"><span class="caption-text"><em>Get the constructs that were not selected by a filter.</em></span><a class="headerlink" href="#id179" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;auxiliary_coordinate&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span>
<span class="go">&lt;CF Constructs: auxiliary_coordinate(3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">inverse_filter</span><span class="p">()</span>
<span class="go">&lt;CF Constructs: cell_measure(1), cell_method(2), coordinate_reference(2), dimension_coordinate(4), domain_ancillary(3), domain_axis(4), field_ancillary(1)&gt;</span>
</pre></div>
</div>
</div>
<p>Note that selection by construct type is equivalent to using the
particular method of the field construct for retrieving that type of
metadata construct:</p>
<div class="literal-block-wrapper docutils container" id="id180">
<div class="code-block-caption"><span class="caption-text"><em>The bespoke methods for retrieving constructs by type
are equivalent to a selection on all of the metadata
constructs.</em></span><a class="headerlink" href="#id180" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_type</span><span class="p">(</span><span class="s1">&#39;cell_measure&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmeasure0&#39;: &lt;CF CellMeasure: measure:area(9, 10) km2&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">cell_measures</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmeasure0&#39;: &lt;CF CellMeasure: measure:area(9, 10) km2&gt;}</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="metadata-construct-access">
<span id="id32"></span><h2><a class="toc-backref" href="#id407"><strong>Metadata construct access</strong></a><a class="headerlink" href="#metadata-construct-access" title="Permalink to this headline">¶</a></h2>
<p>An individual metadata construct, or its construct key, may be
returned by any of the following techniques:</p>
<ul class="simple">
<li><p>with the <a class="reference internal" href="method/cf.Field.construct.html#cf.Field.construct" title="cf.Field.construct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">construct</span></code></a> method of a field construct,</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id181">
<div class="code-block-caption"><span class="caption-text"><em>Get the “latitude” metadata construct via its construct
identity, and also its key.</em></span><a class="headerlink" href="#id181" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="go">&lt;CF AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;auxiliarycoordinate0&#39;</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li><p>with the <a class="reference internal" href="method/cf.Field.construct_key.html#cf.Field.construct_key" title="cf.Field.construct_key"><code class="xref py py-obj docutils literal notranslate"><span class="pre">construct_key</span></code></a> method of a field construct:</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id182">
<div class="code-block-caption"><span class="caption-text"><em>Get the “latitude” metadata construct key with its construct
identity and use the key to get the construct itself</em></span><a class="headerlink" href="#id182" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">construct_key</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="go">&lt;CF AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li><p>with the <a class="reference internal" href="method/cf.Field.construct_item.html#cf.Field.construct_item" title="cf.Field.construct_item"><code class="xref py py-obj docutils literal notranslate"><span class="pre">construct_item</span></code></a> method of a field construct:</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id183">
<div class="code-block-caption"><span class="caption-text"><em>Get the “latitude” metadata construct and its identifier
via its construct identity.</em></span><a class="headerlink" href="#id183" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">construct_item</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="go">(&#39;auxiliarycoordinate0&#39;, &lt;AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;)</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li><p>by indexing a <a class="reference internal" href="class/cf.Constructs.html#cf.Constructs" title="cf.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Constructs</span></code></a> instance with  a construct key.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id184">
<div class="code-block-caption"><span class="caption-text"><em>Get the “latitude” metadata construct via its construct
key and indexing</em></span><a class="headerlink" href="#id184" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="go">&lt;CF AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li><p>with the <a class="reference internal" href="method/cf.Constructs.get.html#cf.Constructs.get" title="cf.Constructs.get"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get</span></code></a> method of a <a class="reference internal" href="class/cf.Constructs.html#cf.Constructs" title="cf.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Constructs</span></code></a> instance, or</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id185">
<div class="code-block-caption"><span class="caption-text"><em>Get the “latitude” metadata construct via its construct
key and the ‘get’ method.</em></span><a class="headerlink" href="#id185" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="go">&lt;CF AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;</span>
</pre></div>
</div>
</div>
<p>In addition, an individual metadata construct of a particular type can
be retrieved with the following methods of the field construct:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 59%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Metadata construct</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.domain_axis.html#cf.Field.domain_axis" title="cf.Field.domain_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">domain_axis</span></code></a></p></td>
<td><p>Domain axis</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.dimension_coordinate.html#cf.Field.dimension_coordinate" title="cf.Field.dimension_coordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dimension_coordinate</span></code></a></p></td>
<td><p>Dimension coordinate</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.auxiliary_coordinate.html#cf.Field.auxiliary_coordinate" title="cf.Field.auxiliary_coordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">auxiliary_coordinate</span></code></a></p></td>
<td><p>Auxiliary coordinate</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.coordinate_reference.html#cf.Field.coordinate_reference" title="cf.Field.coordinate_reference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coordinate_reference</span></code></a></p></td>
<td><p>Coordinate reference</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.domain_ancillary.html#cf.Field.domain_ancillary" title="cf.Field.domain_ancillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">domain_ancillary</span></code></a></p></td>
<td><p>Domain ancillary</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.cell_measure.html#cf.Field.cell_measure" title="cf.Field.cell_measure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cell_measure</span></code></a></p></td>
<td><p>Cell measure</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.field_ancillary.html#cf.Field.field_ancillary" title="cf.Field.field_ancillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">field_ancillary</span></code></a></p></td>
<td><p>Field ancillary</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.cell_method.html#cf.Field.cell_method" title="cf.Field.cell_method"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cell_method</span></code></a></p></td>
<td><p>Cell method</p></td>
</tr>
</tbody>
</table>
<p>These methods will only look for the given identity amongst constructs
of the chosen type.</p>
<div class="literal-block-wrapper docutils container" id="id186">
<div class="code-block-caption"><span class="caption-text"><em>Get the “latitude” auxiliary coordinate construct via
its construct identity, and also its key.</em></span><a class="headerlink" href="#id186" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">auxiliary_coordinate</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="go">&lt;CF AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">auxiliary_coordinate</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;auxiliarycoordinate0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">auxiliary_coordinate</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">item</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(&#39;auxiliarycoordinate0&#39;, &lt;CF AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;)</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="method/cf.Field.construct.html#cf.Field.construct" title="cf.Field.construct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">construct</span></code></a> method of the field construct, the above
methods for finding a construct of a particular type, and the
<a class="reference internal" href="method/cf.Constructs.value.html#cf.Constructs.value" title="cf.Constructs.value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">value</span></code></a> method of the <a class="reference internal" href="class/cf.Constructs.html#cf.Constructs" title="cf.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Constructs</span></code></a> instance will all
raise an exception of there is not a unique metadata construct to
return, but this may be replaced with returning a default value or
raising a customised exception:</p>
<div class="literal-block-wrapper docutils container" id="id187">
<div class="code-block-caption"><span class="caption-text"><em>By default an exception is raised if there is not a
unique construct that meets the criteria. Alternatively,
the value of the “default” parameter is returned.</em></span><a class="headerlink" href="#id187" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;measure:volume&#39;</span><span class="p">)</span>                <span class="c1"># Raises Exception</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">   </span><span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Can&#39;t return zero constructs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;measure:volume&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;measure:volume&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;my error&quot;</span><span class="p">))</span>  <span class="c1"># Raises Exception</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">   </span><span class="c">...</span>
<span class="gr">Exception</span>: <span class="n">my error</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_measure</span><span class="p">(</span><span class="s2">&quot;volume&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s2">&quot;units=degrees&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s2">&quot;units=degrees&quot;</span><span class="p">)</span>  <span class="c1"># Raises Exception</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">   </span><span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Field.construct() can&#39;t return 2 constructs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s2">&quot;units=degrees&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
<span class="go">None</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="method/cf.Constructs.get.html#cf.Constructs.get" title="cf.Constructs.get"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get</span></code></a> method of a <a class="reference internal" href="class/cf.Constructs.html#cf.Constructs" title="cf.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Constructs</span></code></a> instance accepts an
optional second argument to be returned if the construct key does not
exist, exactly like the Python <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict.get" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict.get</span></code></a> method.</p>
<section id="metadata-construct-properties">
<span id="id33"></span><h3><a class="toc-backref" href="#id408">Metadata construct properties</a><a class="headerlink" href="#metadata-construct-properties" title="Permalink to this headline">¶</a></h3>
<p>Metadata constructs share the <a class="reference internal" href="#properties"><span class="std std-ref">same API as the field construct</span></a> for accessing their properties:</p>
<div class="literal-block-wrapper docutils container" id="id188">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the “longitude” metadata construct, set a new
property, and then inspect all of the properties.</em></span><a class="headerlink" href="#id188" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span>
<span class="go">&lt;CF DimensionCoordinate: longitude(8) degrees_east&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;units&#39;: &#39;degrees_east&#39;,</span>
<span class="go"> &#39;long_name&#39;: &#39;Longitude&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;longitude&#39;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id189">
<div class="code-block-caption"><span class="caption-text"><em>Get the metadata construct with units of “km2”, find its
canonical identity, and all of its valid identities, that
may be used for selection by the “filter_by_identity”
method</em></span><a class="headerlink" href="#id189" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">area</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_property</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="s1">&#39;km2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span>
<span class="go">&lt;CF CellMeasure: measure:area(9, 10) km2&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="go">&#39;measure:area&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">identities</span><span class="p">()</span>
<span class="go">[&#39;measure:area&#39;, &#39;units=km2&#39;, &#39;ncvar%cell_measure&#39;]</span>
</pre></div>
</div>
</div>
</section>
<section id="metadata-construct-data">
<span id="id34"></span><h3><a class="toc-backref" href="#id409">Metadata construct data</a><a class="headerlink" href="#metadata-construct-data" title="Permalink to this headline">¶</a></h3>
<p>Metadata constructs share the <a class="reference internal" href="#data"><span class="std std-ref">a similar API as the field
construct</span></a> as the field construct for accessing their data:</p>
<div class="literal-block-wrapper docutils container" id="id190">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the “longitude” metadata construct, inspect its
data, change the third element of the array, and get the
data as a numpy array.</em></span><a class="headerlink" href="#id190" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span>
<span class="go">&lt;CF DimensionCoordinate: longitude(8) degrees_east&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;CF Data(8): [22.5, ..., 337.5] degrees_east&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">&lt;CF Data(1): [112.5] degrees_east&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">133.33</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lon</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[ 22.5   67.5  133.33 157.5  202.5  247.5  292.5  337.5 ]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">112.5</span>
</pre></div>
</div>
</div>
<p>The domain axis constructs spanned by a particular metadata
construct’s data are found with the <a class="reference internal" href="method/cf.Constructs.get_data_axes.html#cf.Constructs.get_data_axes" title="cf.Constructs.get_data_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_data_axes</span></code></a> method
of the field construct:</p>
<div class="literal-block-wrapper docutils container" id="id191">
<div class="code-block-caption"><span class="caption-text"><em>Find the construct keys of the domain axis constructs
spanned by the data of each metadata construct.</em></span><a class="headerlink" href="#id191" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">construct_key</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span>
<span class="go">&#39;auxiliarycoordinate0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_data_axes</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="go">(&#39;domainaxis1&#39;, &#39;domainaxis2&#39;)</span>
</pre></div>
</div>
</div>
<p>The domain axis constructs spanned by all the data of all metadata
construct may be found with the <a class="reference internal" href="method/cf.Constructs.data_axes.html#cf.Constructs.data_axes" title="cf.Constructs.data_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data_axes</span></code></a> method of the
field construct’s <a class="reference internal" href="class/cf.Constructs.html#cf.Constructs" title="cf.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Constructs</span></code></a> instance:</p>
<div class="literal-block-wrapper docutils container" id="id192">
<div class="code-block-caption"><span class="caption-text"><em>Find the construct keys of the domain axis constructs
spanned by the data of each metadata construct.</em></span><a class="headerlink" href="#id192" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">data_axes</span><span class="p">()</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: (&#39;domainaxis1&#39;, &#39;domainaxis2&#39;),</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: (&#39;domainaxis2&#39;, &#39;domainaxis1&#39;),</span>
<span class="go"> &#39;auxiliarycoordinate2&#39;: (&#39;domainaxis1&#39;,),</span>
<span class="go"> &#39;cellmeasure0&#39;: (&#39;domainaxis2&#39;, &#39;domainaxis1&#39;),</span>
<span class="go"> &#39;dimensioncoordinate0&#39;: (&#39;domainaxis0&#39;,),</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: (&#39;domainaxis1&#39;,),</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: (&#39;domainaxis2&#39;,),</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: (&#39;domainaxis3&#39;,),</span>
<span class="go"> &#39;domainancillary0&#39;: (&#39;domainaxis0&#39;,),</span>
<span class="go"> &#39;domainancillary1&#39;: (&#39;domainaxis0&#39;,),</span>
<span class="go"> &#39;domainancillary2&#39;: (&#39;domainaxis1&#39;, &#39;domainaxis2&#39;),</span>
<span class="go"> &#39;fieldancillary0&#39;: (&#39;domainaxis1&#39;, &#39;domainaxis2&#39;)}</span>
</pre></div>
</div>
</div>
<p>A size one domain axis construct that is <em>not</em> spanned by the field
construct’s data may still be spanned by the data of metadata
constructs. For example, the data of the field construct <code class="docutils literal notranslate"><span class="pre">t</span></code>
<a class="reference internal" href="#data-axes"><span class="std std-ref">does not span the size one domain axis construct</span></a>
with key <code class="docutils literal notranslate"><span class="pre">'domainaxis3'</span></code>, but this domain axis construct is spanned
by a “time” dimension coordinate construct (with key
<code class="docutils literal notranslate"><span class="pre">'dimensioncoordinate3'</span></code>). Such a dimension coordinate (i.e. one
that applies to a domain axis construct that is not spanned by the
field construct’s data) corresponds to a CF-netCDF scalar coordinate
variable.</p>
<hr class="docutils" />
</section>
</section>
<section id="time">
<span id="id35"></span><h2><a class="toc-backref" href="#id410"><strong>Time</strong></a><a class="headerlink" href="#time" title="Permalink to this headline">¶</a></h2>
<p>Constructs (including the field constructs) that represent elapsed
time have data array values that provide elapsed time since a
reference date. These constructs are identified by the presence of
“reference time” units. The data values may be converted into the
date-time objects of the <a class="reference external" href="https://unidata.github.io/cftime/">cftime package</a> with the <a class="reference internal" href="attribute/cf.Field.datetime_array.html#cf.Field.datetime_array" title="cf.Field.datetime_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datetime_array</span></code></a>
attribute of the construct, or its <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instance.</p>
<div class="literal-block-wrapper docutils container" id="id193">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the the values of a “time” construct as elapsed
times and as date-times.</em></span><a class="headerlink" href="#id193" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span>
<span class="go">&lt;CF DimensionCoordinate: time(1) days since 2018-12-01 &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">)</span>
<span class="go">&#39;days since 2018-12-01&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;calendar&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">)</span>
<span class="go">&#39;standard&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[31.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">datetime_array</span><span class="p">)</span>
<span class="go">[cftime.DatetimeGregorian(2019-01-01 00:00:00)]</span>
</pre></div>
</div>
</div>
<section id="time-duration">
<span id="id37"></span><h3><a class="toc-backref" href="#id411">Time duration</a><a class="headerlink" href="#time-duration" title="Permalink to this headline">¶</a></h3>
<p>A period of time may stored in a <a class="reference internal" href="class/cf.TimeDuration.html#cf.TimeDuration" title="cf.TimeDuration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.TimeDuration</span></code></a> object. For many
applications, a <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instance with appropriate units (such as
<code class="docutils literal notranslate"><span class="pre">seconds</span></code>) is equivalent, but a <a class="reference internal" href="class/cf.TimeDuration.html#cf.TimeDuration" title="cf.TimeDuration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.TimeDuration</span></code></a> instance also
allows units of <em>calendar</em> years or months; and may be relative to a
date-time offset.</p>
<div class="literal-block-wrapper docutils container" id="id194">
<div class="code-block-caption"><span class="caption-text"><em>Define a duration of one calendar month which, if
applicable, starts at 12:00 on the 16th of the month.</em></span><a class="headerlink" href="#id194" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">TimeDuration</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;calendar_month&#39;</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">hour</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span>
<span class="go">&lt;CF TimeDuration: P1M (Y-M-16 12:00:00)&gt;</span>
</pre></div>
</div>
</div>
<p><a class="reference internal" href="class/cf.TimeDuration.html#cf.TimeDuration" title="cf.TimeDuration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.TimeDuration</span></code></a> objects support comparison and arithmetic operations
with numeric scalars, <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instances and date-time objects:</p>
<div class="literal-block-wrapper docutils container" id="id195">
<div class="code-block-caption"><span class="caption-text"><em>Add a calendar month to a date-time object, and a
date-time data.</em></span><a class="headerlink" href="#id195" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">cm</span>
<span class="go">cftime.datetime(2000-03-01 00:00:00)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;days since 2000-02-01&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">cm</span>
<span class="go">&lt;CF Data(3): [2000-03-02 00:00:00, 2000-03-03 00:00:00, 2000-03-04 00:00:00] gregorian&gt;</span>
</pre></div>
</div>
</div>
<p>Date-time ranges that span the time duration can also be created:</p>
<div class="literal-block-wrapper docutils container" id="id196">
<div class="code-block-caption"><span class="caption-text"><em>Create an interval starting from date-time; and an
interval that contains a date-time, taking into account
the offset.</em></span><a class="headerlink" href="#id196" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">(cftime.DatetimeGregorian(2000-02-01 00:00:000),</span>
<span class="go"> cftime.DatetimeGregorian(2000-03-01 00:00:000))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">bounds</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">(cftime.DatetimeGregorian(2000-01-16 12:00:00),</span>
<span class="go"> cftime.DatetimeGregorian(2000-02-16 12:00:00))</span>
</pre></div>
</div>
</div>
</section>
<section id="time-duration-constructors">
<span id="id38"></span><h3><a class="toc-backref" href="#id412">Time duration constructors</a><a class="headerlink" href="#time-duration-constructors" title="Permalink to this headline">¶</a></h3>
<p>For convenience, <a class="reference internal" href="class/cf.TimeDuration.html#cf.TimeDuration" title="cf.TimeDuration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.TimeDuration</span></code></a> instances can be created with the
following constructors:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Constructor</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="function/cf.Y.html#cf.Y" title="cf.Y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Y</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.TimeDuration.html#cf.TimeDuration" title="cf.TimeDuration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.TimeDuration</span></code></a> object for a number of calendar years</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.M.html#cf.M" title="cf.M"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.M</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.TimeDuration.html#cf.TimeDuration" title="cf.TimeDuration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.TimeDuration</span></code></a> object for a number of calendar months</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="function/cf.D.html#cf.D" title="cf.D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.D</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.TimeDuration.html#cf.TimeDuration" title="cf.TimeDuration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.TimeDuration</span></code></a> object for a number of days</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.h.html#cf.h" title="cf.h"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.h</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.TimeDuration.html#cf.TimeDuration" title="cf.TimeDuration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.TimeDuration</span></code></a> object for a number of hours</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="function/cf.m.html#cf.m" title="cf.m"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.m</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.TimeDuration.html#cf.TimeDuration" title="cf.TimeDuration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.TimeDuration</span></code></a> object for a number of minutes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.s.html#cf.s" title="cf.s"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.s</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.TimeDuration.html#cf.TimeDuration" title="cf.TimeDuration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.TimeDuration</span></code></a> object for a number of seconds</p></td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container" id="id197">
<div class="code-block-caption"><span class="caption-text"><em>Some examples of ‘cf.TimeDuration’ objects returned by
constructors.</em></span><a class="headerlink" href="#id197" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">D</span><span class="p">()</span>
<span class="go">&lt;CF TimeDuration: P1D (Y-M-D 00:00:00)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="go">&lt;CF TimeDuration: P10Y (Y-12-01 00:00:00)&gt;</span>

<span class="go">----</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="domain">
<span id="id39"></span><h2><a class="toc-backref" href="#id413"><strong>Domain</strong></a><a class="headerlink" href="#domain" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="cf_data_model.html#cf-data-model"><span class="std std-ref">domain of the CF data model</span></a> is defined
collectively by various other metadata constructs. It is represented
by the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Domain</span></code> class. A domain construct may exist independently, or
is accessed from a field construct with its <a class="reference internal" href="attribute/cf.Field.domain.html#cf.Field.domain" title="cf.Field.domain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">domain</span></code></a> attribute,
or <a class="reference internal" href="method/cf.Field.get_domain.html#cf.Field.get_domain" title="cf.Field.get_domain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_domain</span></code></a> method.</p>
<div class="literal-block-wrapper docutils container" id="id198">
<div class="code-block-caption"><span class="caption-text"><em>Get the domain, and inspect it.</em></span><a class="headerlink" href="#id198" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">domain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span>
<span class="go">&lt;CF Domain: {1, 1, 9, 10}&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
<span class="go">Dimension coords: atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [2.2, ..., -1.76] degrees</span>
<span class="go">                : grid_longitude(9) = [-4.7, ..., -1.18] degrees</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[53.941, ..., 50.225]] degrees_N</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[2.004, ..., 8.156]] degrees_E</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., &#39;kappa&#39;]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[2391.9657, ..., 2392.6009]] km2</span>
<span class="go">Coord references: grid_mapping_name:rotated_latitude_longitude</span>
<span class="go">                : standard_name:atmosphere_hybrid_height_coordinate</span>
<span class="go">Domain ancils   : ncvar%a(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : ncvar%b(atmosphere_hybrid_height_coordinate(1)) = [20.0]</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 270.0]] m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">description</span> <span class="o">=</span> <span class="n">domain</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Changes to domain instance are seen by the field construct, and vice
versa. This is because the domain instance is merely a “view” of the
relevant metadata constructs contained in the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id199">
<div class="code-block-caption"><span class="caption-text"><em>Change a property of a metadata construct of the domain
and show that this change appears in the same metadata
data construct of the parent field, and vice versa.</em></span><a class="headerlink" href="#id199" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">domain_latitude</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field_latitude</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain_latitude</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;set by domain&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">field_latitude</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">))</span>
<span class="go">set by domain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field_latitude</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;set by field&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">domain_latitude</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">))</span>
<span class="go">set by field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain_latitude</span><span class="o">.</span><span class="n">del_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="go">&#39;set by field&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field_latitude</span><span class="o">.</span><span class="n">has_property</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<p>All of the methods and attributes related to the domain are listed
<a class="reference internal" href="class/cf.Field.html#field-domain"><span class="std std-ref">here</span></a>.</p>
<hr class="docutils" />
</section>
<section id="metadata-construct-types">
<span id="id40"></span><h2><a class="toc-backref" href="#id414"><strong>Metadata construct types</strong></a><a class="headerlink" href="#metadata-construct-types" title="Permalink to this headline">¶</a></h2>
<section id="domain-axes">
<span id="id41"></span><h3><a class="toc-backref" href="#id415">Domain axes</a><a class="headerlink" href="#domain-axes" title="Permalink to this headline">¶</a></h3>
<p>A domain axis metadata construct specifies the number of points along
an independent axis of the field construct’s domain and is stored in a
<a class="reference internal" href="class/cf.DomainAxis.html#cf.DomainAxis" title="cf.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.DomainAxis</span></code></a> instance. The size of the axis is retrieved with
the <a class="reference internal" href="method/cf.DomainAxis.get_size.html#cf.DomainAxis.get_size" title="cf.DomainAxis.get_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_size</span></code></a> method of the domain axis construct.</p>
<div class="literal-block-wrapper docutils container" id="id200">
<div class="code-block-caption"><span class="caption-text"><em>Get the size of a domain axis construct.</em></span><a class="headerlink" href="#id200" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">domain_axes</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainaxis0&#39;: &lt;CF DomainAxis: size(5)&gt;,</span>
<span class="go"> &#39;domainaxis1&#39;: &lt;CF DomainAxis: size(8)&gt;,</span>
<span class="go"> &#39;domainaxis2&#39;: &lt;CF DomainAxis: size(1)&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">domain_axes</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;domainaxis1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">&lt;CF DomainAxis: size(8)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
</div>
</section>
<section id="coordinates">
<span id="id42"></span><h3><a class="toc-backref" href="#id416">Coordinates</a><a class="headerlink" href="#coordinates" title="Permalink to this headline">¶</a></h3>
<p>There are two types of coordinate construct, dimension and auxiliary
coordinate constructs, which can be retrieved together with the
<a class="reference internal" href="method/cf.Field.coordinates.html#cf.Field.coordinates" title="cf.Field.coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coordinates</span></code></a> method of the field construct, as well as
individually with the <a class="reference internal" href="method/cf.Field.auxiliary_coordinates.html#cf.Field.auxiliary_coordinates" title="cf.Field.auxiliary_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">auxiliary_coordinates</span></code></a> and
<a class="reference internal" href="method/cf.Field.dimension_coordinates.html#cf.Field.dimension_coordinates" title="cf.Field.dimension_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dimension_coordinates</span></code></a> methods.</p>
<div class="literal-block-wrapper docutils container" id="id201">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve both types of coordinate constructs.</em></span><a class="headerlink" href="#id201" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;auxiliarycoordinate0&#39;: &lt;CF AuxiliaryCoordinate: latitude(10, 9) degrees_N&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate1&#39;: &lt;CF AuxiliaryCoordinate: longitude(9, 10) degrees_E&gt;,</span>
<span class="go"> &#39;auxiliarycoordinate2&#39;: &lt;CF AuxiliaryCoordinate: long_name=Grid latitude name(10) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate0&#39;: &lt;CF DimensionCoordinate: atmosphere_hybrid_height_coordinate(1) &gt;,</span>
<span class="go"> &#39;dimensioncoordinate1&#39;: &lt;CF DimensionCoordinate: grid_latitude(10) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate2&#39;: &lt;CF DimensionCoordinate: grid_longitude(9) degrees&gt;,</span>
<span class="go"> &#39;dimensioncoordinate3&#39;: &lt;CF DimensionCoordinate: time(1) days since 2018-12-01 &gt;}</span>
</pre></div>
</div>
</div>
<section id="bounds">
<span id="id43"></span><h4><a class="toc-backref" href="#id417">Bounds</a><a class="headerlink" href="#bounds" title="Permalink to this headline">¶</a></h4>
<p>A coordinate construct may contain an array of cell bounds that
provides the extent of each cell by defining the locations of the cell
vertices. This is in addition to the main data array that contains a
grid point location for each cell. The cell bounds are stored in a
<a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Bounds</span></code></a> class instance that is accessed with the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">bounds</span></code> attribute, or <code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bounds</span></code> method, of
the coordinate construct.</p>
<p>A <a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Bounds</span></code></a> instance shares the <a class="reference internal" href="#data"><span class="std std-ref">the same API as the field
construct</span></a> for accessing its data.</p>
<div class="literal-block-wrapper docutils container" id="id202">
<div class="code-block-caption"><span class="caption-text"><em>Get the Bounds instance of a coordinate construct and
inspect its data.</em></span><a class="headerlink" href="#id202" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;grid_longitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="n">lon</span><span class="o">.</span><span class="n">bounds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span>
<span class="go">&lt;CF Bounds: grid_longitude(9, 2) degrees&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;CF Data(9, 2): [[-4.92, ..., -0.96]] degrees&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bounds</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[-4.92 -4.48]</span>
<span class="go"> [-4.48 -4.04]</span>
<span class="go"> [-4.04 -3.6 ]</span>
<span class="go"> [-3.6  -3.16]</span>
<span class="go"> [-3.16 -2.72]</span>
<span class="go"> [-2.72 -2.28]</span>
<span class="go"> [-2.28 -1.84]</span>
<span class="go"> [-1.84 -1.4 ]</span>
<span class="go"> [-1.4  -0.96]]</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Bounds</span></code></a> instance inherits the descriptive properties from its
parent coordinate construct, but it may also have its own properties
(although setting these is not recommended).</p>
<div class="literal-block-wrapper docutils container" id="id203">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the inherited and bespoke properties of a Bounds
instance.</em></span><a class="headerlink" href="#id203" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">inherited_properties</span><span class="p">()</span>
<span class="go">{&#39;standard_name&#39;: &#39;grid_longitude&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;degrees&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;units&#39;: &#39;degrees&#39;}</span>
</pre></div>
</div>
</div>
</section>
<section id="geometry-cells">
<span id="id44"></span><h4><a class="toc-backref" href="#id418">Geometry cells</a><a class="headerlink" href="#geometry-cells" title="Permalink to this headline">¶</a></h4>
<p>For many geospatial applications, cell bounds can not be represented
by a simple line or polygon, and different cells may have different
numbers of nodes describing their bounds. For example, if each cell
describes the areal extent of a watershed, then it is likely that some
watersheds will require more nodes than others. Such cells are called
<a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#geometries">geometries</a>.</p>
<p>If a coordinate construct represents geometries then it will have a
“geometry” attribute (not a <a class="reference internal" href="#metadata-construct-properties"><span class="std std-ref">CF property</span></a>) with one of the values <code class="docutils literal notranslate"><span class="pre">'point'</span></code>,
‘<code class="docutils literal notranslate"><span class="pre">line'</span></code> or <code class="docutils literal notranslate"><span class="pre">'polygon'</span></code>.</p>
<p>This is illustrated with the file <code class="docutils literal notranslate"><span class="pre">geometry.nc</span></code> (found in the
<a class="reference internal" href="#sample-datasets"><span class="std std-ref">sample datasets</span></a>):</p>
<div class="literal-block-wrapper docutils container" id="id204">
<div class="code-block-caption"><span class="caption-text"><em>Read and inspect a dataset containing geometry cell
bounds.</em></span><a class="headerlink" href="#id204" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;geometry.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">Field: preciptitation_amount (ncvar%pr)</span>
<span class="go">---------------------------------------</span>
<span class="go">Data            : preciptitation_amount(cf_role=timeseries_id(2), time(4))</span>
<span class="go">Dimension coords: time(4) = [2000-01-02 00:00:00, ..., 2000-01-05 00:00:00]</span>
<span class="go">Auxiliary coords: latitude(cf_role=timeseries_id(2)) = [25.0, 7.0] degrees_north</span>
<span class="go">                : longitude(cf_role=timeseries_id(2)) = [10.0, 40.0] degrees_east</span>
<span class="go">                : altitude(cf_role=timeseries_id(2)) = [5000.0, 20.0] m</span>
<span class="go">                : cf_role=timeseries_id(cf_role=timeseries_id(2)) = [b&#39;x1&#39;, b&#39;y2&#39;]</span>
<span class="go">Coord references: grid_mapping_name:latitude_longitude</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">auxiliary_coordinate</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">Auxiliary coordinate: longitude</span>
<span class="go">   standard_name = &#39;longitude&#39;</span>
<span class="go">   units = &#39;degrees_east&#39;</span>
<span class="go">   Data(2) = [10.0, 40.0] degrees_east</span>
<span class="go">   Geometry: polygon</span>
<span class="go">   Bounds:axis = &#39;X&#39;</span>
<span class="go">   Bounds:standard_name = &#39;longitude&#39;</span>
<span class="go">   Bounds:units = &#39;degrees_east&#39;</span>
<span class="go">   Bounds:Data(2, 3, 4) = [[[20.0, ..., --]]] degrees_east</span>
<span class="go">   Interior Ring:Data(2, 3) = [[0, ..., --]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">()</span>
<span class="go">&#39;polygon&#39;</span>
</pre></div>
</div>
</div>
<p>Bounds for geometry cells are also stored in a <a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a> instance, but
one that always has <em>two</em> extra trailing dimensions (rather than
one). The fist trailing dimension indexes the distinct parts of a
geometry, and the second indexes the nodes of each part. When a part
has fewer nodes than another, its nodes dimension is padded with
missing data.</p>
<div class="literal-block-wrapper docutils container" id="id205">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the geometry nodes.</em></span><a class="headerlink" href="#id205" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lon</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[20.0 10.0  0.0   --]</span>
<span class="go"> [ 5.0 10.0 15.0 10.0]</span>
<span class="go"> [20.0 10.0  0.0   --]]</span>

<span class="go">[[50.0 40.0 30.0   --]</span>
<span class="go"> [  --   --   --   --]</span>
<span class="go"> [  --   --   --   --]]]</span>
</pre></div>
</div>
</div>
<p>If a cell is composed of multiple polygon parts, an individual polygon
may define an “interior ring”, i.e. a region that is to be omitted
from, as opposed to included in, the cell extent. Such cells also have
an interior ring array that spans the same domain axes as the
coordinate cells, with the addition of one extra dimension that
indexes the parts for each cell. This array records whether each
polygon is to be included or excluded from the cell, with values of
<code class="docutils literal notranslate"><span class="pre">1</span></code> or <code class="docutils literal notranslate"><span class="pre">0</span></code> respectively.</p>
<div class="literal-block-wrapper docutils container" id="id206">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the interior ring information.</em></span><a class="headerlink" href="#id206" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lon</span><span class="o">.</span><span class="n">get_interior_ring</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0  1  0]</span>
<span class="go"> [0 -- --]]</span>
</pre></div>
</div>
</div>
<p>Note it is preferable to access the data type, number of dimensions,
dimension sizes and number of elements of the coordinate construct via
the construct’s attributes, rather than the attributes of the
<a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instance that provides representative values for each
cell. This is because the representative cell values for geometries
are optional, and if they are missing then the construct attributes
are able to infer these attributes from the bounds.</p>
<p>When a field construct containing geometries is written to disk, a
CF-netCDF geometry container variable is automatically created, and
the cells encoded with the <a class="reference internal" href="#compression"><span class="std std-ref">compression</span></a> techniques
defined in the CF conventions.</p>
</section>
</section>
<section id="domain-ancillaries">
<span id="id45"></span><h3><a class="toc-backref" href="#id419">Domain ancillaries</a><a class="headerlink" href="#domain-ancillaries" title="Permalink to this headline">¶</a></h3>
<p>A domain ancillary construct provides information which is needed for
computing the location of cells in an alternative <a class="reference internal" href="#coordinate-systems"><span class="std std-ref">coordinate
system</span></a>. If a domain ancillary construct provides
extra coordinates then it may contain cell bounds in addition to its
main data array.</p>
<div class="literal-block-wrapper docutils container" id="id207">
<div class="code-block-caption"><span class="caption-text"><em>Get the data and bounds data of a domain ancillary
construct.</em></span><a class="headerlink" href="#id207" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;domainancillary0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[10.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">bounds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span>
<span class="go">&lt;Bounds: ncvar%a_bounds(1, 2) m&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bounds</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[  5.  15.]]</span>
</pre></div>
</div>
</div>
</section>
<section id="coordinate-systems">
<span id="id46"></span><h3><a class="toc-backref" href="#id420">Coordinate systems</a><a class="headerlink" href="#coordinate-systems" title="Permalink to this headline">¶</a></h3>
<p>A field construct may contain various coordinate systems. Each
coordinate system is either defined by a coordinate reference
construct that relates dimension coordinate, auxiliary coordinate and
domain ancillary constructs (as is the case for the field construct
<code class="docutils literal notranslate"><span class="pre">t</span></code>), or is inferred from dimension and auxiliary coordinate
constructs alone (as is the case for the field construct <code class="docutils literal notranslate"><span class="pre">q</span></code>).</p>
<p>A coordinate reference construct contains</p>
<ul class="simple">
<li><p>references (by construct keys) to the dimension and auxiliary
coordinate constructs to which it applies, accessed with the
<a class="reference internal" href="method/cf.CoordinateReference.coordinates.html#cf.CoordinateReference.coordinates" title="cf.CoordinateReference.coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coordinates</span></code></a> method of the coordinate
reference construct;</p></li>
</ul>
<ul class="simple">
<li><p>the zeroes of the dimension and auxiliary coordinate constructs
which define the coordinate system, stored in a <a class="reference internal" href="class/cf.Datum.html#cf.Datum" title="cf.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Datum</span></code></a> instance,
which is accessed with the <a class="reference internal" href="attribute/cf.CoordinateReference.datum.html#cf.CoordinateReference.datum" title="cf.CoordinateReference.datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datum</span></code></a> attribute,
or <a class="reference internal" href="method/cf.CoordinateReference.get_datum.html#cf.CoordinateReference.get_datum" title="cf.CoordinateReference.get_datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_datum</span></code></a> method, of the coordinate
reference construct; and</p></li>
</ul>
<ul class="simple">
<li><p>a formula for converting coordinate values taken from the dimension
or auxiliary coordinate constructs to a different coordinate system,
stored in a <a class="reference internal" href="class/cf.CoordinateConversion.html#cf.CoordinateConversion" title="cf.CoordinateConversion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.CoordinateConversion</span></code></a> class instance, which is
accessed with the <a class="reference internal" href="attribute/cf.CoordinateReference.coordinate_conversion.html#cf.CoordinateReference.coordinate_conversion" title="cf.CoordinateReference.coordinate_conversion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coordinate_conversion</span></code></a>
attribute, or <a class="reference internal" href="method/cf.CoordinateReference.get_coordinate_conversion.html#cf.CoordinateReference.get_coordinate_conversion" title="cf.CoordinateReference.get_coordinate_conversion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_coordinate_conversion</span></code></a>
method, of the coordinate reference construct.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id208">
<div class="code-block-caption"><span class="caption-text"><em>Select the vertical coordinate system construct and
inspect its coordinate constructs.</em></span><a class="headerlink" href="#id208" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;standard_name:atmosphere_hybrid_height_coordinate&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span>
<span class="go">&lt;CF CoordinateReference: standard_name:atmosphere_hybrid_height_coordinate&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">Coordinate Reference: atmosphere_hybrid_height_coordinate</span>
<span class="go">    Coordinate conversion:computed_standard_name = altitude</span>
<span class="go">    Coordinate conversion:standard_name = atmosphere_hybrid_height_coordinate</span>
<span class="go">    Coordinate conversion:a = domainancillary0</span>
<span class="go">    Coordinate conversion:b = domainancillary1</span>
<span class="go">    Coordinate conversion:orog = domainancillary2</span>
<span class="go">    Datum:earth_radius = 6371007</span>
<span class="go">    Coordinate: dimensioncoordinate0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()</span>
<span class="go">{&#39;dimensioncoordinate0&#39;}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id209">
<div class="code-block-caption"><span class="caption-text"><em>Get the datum and inspect its parameters.</em></span><a class="headerlink" href="#id209" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">datum</span>
<span class="go">&lt;CF Datum: Parameters: earth_radius&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">parameters</span><span class="p">()</span>
<span class="go">{&#39;earth_radius&#39;: 6371007}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id210">
<div class="code-block-caption"><span class="caption-text"><em>Get the coordinate conversion and inspect its parameters
and referenced domain ancillary constructs.</em></span><a class="headerlink" href="#id210" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">coordinate_conversion</span>
<span class="go">&lt;CF CoordinateConversion: Parameters: computed_standard_name, standard_name; Ancillaries: a, b, orog&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">coordinate_conversion</span><span class="o">.</span><span class="n">parameters</span><span class="p">()</span>
<span class="go">{&#39;computed_standard_name&#39;: &#39;altitude&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;atmosphere_hybrid_height_coordinate&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span><span class="o">.</span><span class="n">coordinate_conversion</span><span class="o">.</span><span class="n">domain_ancillaries</span><span class="p">()</span>
<span class="go">{&#39;a&#39;: &#39;domainancillary0&#39;,</span>
<span class="go"> &#39;b&#39;: &#39;domainancillary1&#39;,</span>
<span class="go"> &#39;orog&#39;: &#39;domainancillary2&#39;}</span>
</pre></div>
</div>
</div>
<section id="computing-non-parametric-vertical-coordinates">
<span id="id47"></span><h4><a class="toc-backref" href="#id421">Computing non-parametric vertical coordinates</a><a class="headerlink" href="#computing-non-parametric-vertical-coordinates" title="Permalink to this headline">¶</a></h4>
<p>When vertical coordinates are a function of horizontal location as
well as parameters which depend on vertical location, they cannot be
stored in a vertical dimension coordinate construct. In such cases a
parametric vertical dimension coordinate construct is stored and a
coordinate reference construct contains the formula for computing the
required non-parametric vertical coordinates. For example,
multi-dimensional non-parametric ocean altitude coordinates
can be computed from one-dimensional parametric ocean sigma
coordinates <a class="footnote-reference brackets" href="#sigma" id="id48">3</a>.</p>
<p>The <a class="reference internal" href="method/cf.Field.compute_vertical_coordinates.html#cf.Field.compute_vertical_coordinates" title="cf.Field.compute_vertical_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_vertical_coordinates</span></code></a> method of the field
construct will identify coordinate reference systems based on
parametric vertical coordinates and, if possible, compute the
corresponding non-parametric vertical coordinates, storing the result
in a new auxiliary coordinate construct.</p>
<div class="literal-block-wrapper docutils container" id="id211">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct with computed height
coordinates, from one with parametric
atmosphere_hybrid_height_coordinate coordinates.</em></span><a class="headerlink" href="#id211" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">example_field</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">Field: air_temperature (ncvar%ta</span>
<span class="go">---------------------------------</span>
<span class="go">Data            : air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K</span>
<span class="go">Cell methods    : grid_latitude(10): grid_longitude(9): mean where land (interval: 0.1 degrees) time(1): maximum</span>
<span class="go">Field ancils    : air_temperature standard_error(grid_latitude(10), grid_longitude(9)) = [[0.76, ..., 0.32]] K</span>
<span class="go">Dimension coords: atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [2.2, ..., -1.76] degrees</span>
<span class="go">                : grid_longitude(9) = [-4.7, ..., -1.18] degrees</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[53.941, ..., 50.225]] degrees_N</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[2.004, ..., 8.156]] degrees_E</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., b&#39;kappa&#39;]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[2391.9657, ..., 2392.6009]] km2</span>
<span class="go">Coord references: grid_mapping_name:rotated_latitude_longitude</span>
<span class="go">                : standard_name:atmosphere_hybrid_height_coordinate</span>
<span class="go">Domain ancils   : ncvar%a(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : ncvar%b(atmosphere_hybrid_height_coordinate(1)) = [20.0]</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 270.0]] m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">auxiliary_coordinate</span><span class="p">(</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">compute_vertical_coordinates</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">auxiliary_coordinate</span><span class="p">(</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">Auxiliary coordinate: altitude</span>
<span class="go">    long_name = &#39;Computed from parametric atmosphere_hybrid_height_coordinate</span>
<span class="go">                 vertical coordinates&#39;</span>
<span class="go">    standard_name = &#39;altitude&#39;</span>
<span class="go">    units = &#39;m&#39;</span>
<span class="go">    Data(1, 10, 9) = [[[10.0, ..., 5410.0]]] m</span>
<span class="go">    Bounds:units = &#39;m&#39;</span>
<span class="go">    Bounds:Data(1, 10, 9, 2) = [[[[5.0, ..., 5415.0]]]] m</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="cell-methods">
<span id="id49"></span><h3><a class="toc-backref" href="#id422">Cell methods</a><a class="headerlink" href="#cell-methods" title="Permalink to this headline">¶</a></h3>
<p>A cell method construct describes how the data represent the variation
of the physical quantity within the cells of the domain and is stored
in a <a class="reference internal" href="class/cf.CellMethod.html#cf.CellMethod" title="cf.CellMethod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.CellMethod</span></code></a> instance. A field constructs allows multiple
cell method constructs to be recorded.</p>
<div class="literal-block-wrapper docutils container" id="id212">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the cell methods. The description follows the CF
conventions for cell_method attribute strings, apart from
the use of construct keys instead of netCDF variable
names for cell method axes identification.</em></span><a class="headerlink" href="#id212" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">cell_methods</span><span class="p">())</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;cellmethod0&#39;: &lt;CF CellMethod: domainaxis1: domainaxis2: mean where land (interval: 0.1 degrees)&gt;,</span>
<span class="go"> &#39;cellmethod1&#39;: &lt;CF CellMethod: domainaxis3: maximum&gt;}</span>
</pre></div>
</div>
</div>
<p>The application of cell methods is not commutative (e.g. a mean of
variances is generally not the same as a variance of means), and the
cell methods are assumed to have been applied in the order in which
they were added to the field construct during <a class="reference internal" href="#field-creation"><span class="std std-ref">field construct
creation</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id213">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve the cell method constructs in the same order
that they were applied.</em></span><a class="headerlink" href="#id213" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">cell_methods</span><span class="p">()</span>
<span class="go">{&#39;cellmethod0&#39;, &lt;CF CellMethod: domainaxis1: domainaxis2: mean where land (interval: 0.1 degrees)&gt;),</span>
<span class="go"> &#39;cellmethod1&#39;, &lt;CF CellMethod: domainaxis3: maximum&gt;)}</span>
</pre></div>
</div>
</div>
<p>The axes to which the method applies, the method itself, and any
qualifying properties are accessed with the <a class="reference internal" href="method/cf.CellMethod.get_axes.html#cf.CellMethod.get_axes" title="cf.CellMethod.get_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_axes</span></code></a>,
<a class="reference internal" href="method/cf.CellMethod.get_method.html#cf.CellMethod.get_method" title="cf.CellMethod.get_method"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_method</span></code></a>, , <a class="reference internal" href="method/cf.CellMethod.get_qualifier.html#cf.CellMethod.get_qualifier" title="cf.CellMethod.get_qualifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_qualifier</span></code></a> and
<a class="reference internal" href="method/cf.CellMethod.qualifiers.html#cf.CellMethod.qualifiers" title="cf.CellMethod.qualifiers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">qualifiers</span></code></a> methods of the cell method construct.</p>
<div class="literal-block-wrapper docutils container" id="id214">
<div class="code-block-caption"><span class="caption-text"><em>Get the domain axes constructs to which the cell method
construct applies, and the method and other properties.</em></span><a class="headerlink" href="#id214" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;method:mean&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span>
<span class="go">&lt;CF CellMethod: domainaxis1: domainaxis2: mean where land (interval: 0.1 degrees)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">get_axes</span><span class="p">()</span>
<span class="go">(&#39;domainaxis1&#39;, &#39;domainaxis2&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">get_method</span><span class="p">()</span>
<span class="go">&#39;mean&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">qualifiers</span><span class="p">()</span>
<span class="go">{&#39;where&#39;: &#39;land&#39;, &#39;interval&#39;: [&lt;CF Data(): 0.1 degrees&gt;]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">get_qualifier</span><span class="p">(</span><span class="s1">&#39;where&#39;</span><span class="p">)</span>
<span class="go">&#39;land&#39;</span>
</pre></div>
</div>
</div>
</section>
<section id="field-ancillaries">
<span id="id50"></span><h3><a class="toc-backref" href="#id423">Field ancillaries</a><a class="headerlink" href="#field-ancillaries" title="Permalink to this headline">¶</a></h3>
<p>A field ancillary construct provides metadata which are distributed
over the same domain as the field construct itself. For example, if a
field construct holds a data retrieved from a satellite instrument, a
field ancillary construct might provide the uncertainty estimates for
those retrievals (varying over the same spatiotemporal domain).</p>
<div class="literal-block-wrapper docutils container" id="id215">
<div class="code-block-caption"><span class="caption-text"><em>Get the properties and data of a field ancillary
construct.</em></span><a class="headerlink" href="#id215" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">get_construct</span><span class="p">(</span><span class="s1">&#39;fieldancillary0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">&lt;CF FieldAncillary: air_temperature standard_error(10, 9) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;standard_name&#39;: &#39;air_temperature standard_error&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;K&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;CF Data(10, 9): [[0.76, ..., 0.32]] K&gt;</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="cyclic-domain-axes">
<span id="id51"></span><h2><a class="toc-backref" href="#id424"><strong>Cyclic domain axes</strong></a><a class="headerlink" href="#cyclic-domain-axes" title="Permalink to this headline">¶</a></h2>
<p>A domain axis is cyclic if cells at both of its ends are actually
geographically adjacent. For example, a longitude cell spanning 359 to
360 degrees east is adjacent to the cell spanning 0 to 1 degrees east.</p>
<p>When a dimension coordinate construct is set on a field construct, the
cyclicity of its dimension is automatically determined, using the
<a class="reference internal" href="method/cf.Field.autocyclic.html#cf.Field.autocyclic" title="cf.Field.autocyclic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">autocyclic</span></code></a> method of the field construct, provided the field
construct has sufficient coordinate metadata for it to be inferred.</p>
<p>To find out whether a dimension is cyclic use the <a class="reference internal" href="method/cf.Field.iscyclic.html#cf.Field.iscyclic" title="cf.Field.iscyclic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iscyclic</span></code></a>
method of the field construct, or to manually set its cyclicity use
the <a class="reference internal" href="method/cf.Field.cyclic.html#cf.Field.cyclic" title="cf.Field.cyclic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cyclic</span></code></a> method.</p>
<p>Cyclicity is used by subspacing and mathematical operations to “wrap”
cyclic dimensions to give appropriate results.</p>
<section id="rolling-a-cyclic-axis">
<h3><a class="toc-backref" href="#id425">Rolling a cyclic axis</a><a class="headerlink" href="#rolling-a-cyclic-axis" title="Permalink to this headline">¶</a></h3>
<p>The field construct may be “rolled” along a cyclic axis with the
<a class="reference internal" href="method/cf.Field.roll.html#cf.Field.roll" title="cf.Field.roll"><code class="xref py py-obj docutils literal notranslate"><span class="pre">roll</span></code></a> method of the field construct. This means that the
data along that axis are shifted so that a given number of elements from
one edge of the dimension are removed and re-introduced at the other edge.
All metadata constructs whose data spans the cyclic axis are also rolled.</p>
<div class="literal-block-wrapper docutils container" id="id216">
<div class="code-block-caption"><span class="caption-text"><em>Roll the data along the ‘X’ axis one element to the
right, and also three elements to the left.</em></span><a class="headerlink" href="#id216" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[0.007 0.034 0.003 0.014 0.018 0.037 0.024 0.029]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[0.029 0.007 0.034 0.003 0.014 0.018 0.037 0.024]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qr</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">shift</span><span class="o">=-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">qr</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[0.014 0.018 0.037 0.024 0.029 0.007 0.034 0.003]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id217">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the ‘X’ dimension coordinates of the original
and rolled field constructs, showing that monotonicity
has been preserved.</em></span><a class="headerlink" href="#id217" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">dimension_coordinate</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[ 22.5  67.5 112.5 157.5 202.5 247.5 292.5 337.5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">qr</span><span class="o">.</span><span class="n">dimension_coordinate</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[-202.5 -157.5 -112.5  -67.5  -22.5   22.5   67.5  112.5]</span>
</pre></div>
</div>
</div>
</section>
<section id="anchoring-a-cyclic-axis">
<h3><a class="toc-backref" href="#id426">Anchoring a cyclic axis</a><a class="headerlink" href="#anchoring-a-cyclic-axis" title="Permalink to this headline">¶</a></h3>
<p>The field construct may be rolled by specifying a dimension coordinate
value that should be contained in the first element of the data for
the corresponding axis, by specifying the coordinate value via the
<a class="reference internal" href="method/cf.Field.anchor.html#cf.Field.anchor" title="cf.Field.anchor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">anchor</span></code></a> method if the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id218">
<div class="code-block-caption"><span class="caption-text"><em>Roll the data along the ‘X’ axis so that the first
element of the axis contains -150 degrees east, and
also -750 degrees east.</em></span><a class="headerlink" href="#id218" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">anchor</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">150</span><span class="p">))</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [-112.5, ..., 202.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">anchor</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">750</span><span class="p">))</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [-742.5, ..., -427.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="subspacing-by-metadata">
<span id="id52"></span><h2><a class="toc-backref" href="#id427"><strong>Subspacing by metadata</strong></a><a class="headerlink" href="#subspacing-by-metadata" title="Permalink to this headline">¶</a></h2>
<p>Creation of a new field construct which spans a subspace of the domain
of an existing field construct is achieved either by indexing the
field construct directly (see <a class="reference internal" href="#subspacing-by-index"><span class="std std-ref">Subspacing by index</span></a>) or by
identifying indices based on the metadata constructs (as described in
this section). The subspacing operation, in either case, also
subspaces any metadata constructs of the field construct
(e.g. coordinate metadata constructs) which span any of the domain
axis constructs that are affected. The new field construct is created
with the same properties as the original field construct.</p>
<p>Subspacing by metadata uses the <a class="reference internal" href="method/cf.Field.subspace.html#cf.Field.subspace" title="cf.Field.subspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">subspace</span></code></a> method of the field
construct to select metadata constructs and specify conditions on
their data. Indices for subspacing are then automatically inferred
from where the conditions are met.</p>
<p>Metadata constructs and the conditions on their data are defined by
keyword parameters to the <a class="reference internal" href="method/cf.Field.subspace.html#cf.Field.subspace" title="cf.Field.subspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">subspace</span></code></a> method. A keyword name is
<a class="reference internal" href="#metadata-construct-properties"><span class="std std-ref">an identity</span></a> of a metadata
construct, and the keyword value provides a condition for inferring
indices that apply to the dimension (or dimensions) spanned by the
metadata construct’s data. Indices are created that select every
location for which the metadata construct’s data satisfies the
condition.</p>
<div class="literal-block-wrapper docutils container" id="id219">
<div class="code-block-caption"><span class="caption-text"><em>Create a new field construct whose ‘X’ coordinate spans
only 112.5 degrees east, with the other domain axes
remaining unchanged.</em></span><a class="headerlink" href="#id219" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01T00:00:00Z]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[ 22.5  67.5 112.5 157.5 202.5 247.5 292.5 337.5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="mf">112.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q2</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(1)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(1) = [112.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01T00:00:00Z]</span>
</pre></div>
</div>
</div>
<p>Any domain axes that have not been identified remain
unchanged.</p>
<p>Multiple domain axes may be subspaced simultaneously, and it doesn’t
matter which order they are specified in the <a class="reference internal" href="method/cf.Field.subspace.html#cf.Field.subspace" title="cf.Field.subspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">subspace</span></code></a> call.</p>
<div class="literal-block-wrapper docutils container" id="id220">
<div class="code-block-caption"><span class="caption-text"><em>Create a new field construct whose domain spans only
112.5 degrees east and has latitude greater than -60
degrees north, with the other domain axes remaining
unchanged.</em></span><a class="headerlink" href="#id220" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[-75. -45.   0.  45.  75.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="mf">112.5</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">)))</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(4), longitude(1)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(4) = [-45.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(1) = [112.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01T00:00:00Z]</span>
</pre></div>
</div>
</div>
<p>In the above example, <code class="docutils literal notranslate"><span class="pre">cf.gt(-60)</span></code> returns a <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> instance
which defines a condition (“greater than -60”) that can be applied to
the selected construct’s data. See <a class="reference internal" href="#encapsulating-conditions"><span class="std std-ref">Encapsulating conditions</span></a> for
details.</p>
<div class="literal-block-wrapper docutils container" id="id221">
<div class="code-block-caption"><span class="caption-text"><em>Create a new field construct whose domain spans only 45
degrees south and latitudes greater than 20 degrees
north.</em></span><a class="headerlink" href="#id221" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="o">-</span><span class="mi">45</span><span class="p">)</span> <span class="o">|</span> <span class="n">cf</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span>
<span class="go">&lt;CF Query: [(eq -45) | (ge 20)]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="n">c</span><span class="p">))</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(3), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(3) = [-45.0, 45.0, 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01T00:00:00Z]</span>
</pre></div>
</div>
</div>
<p>In the above example, two <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> instances are combined into a new
<a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> instance via the Python bitwise “or” operator (<code class="xref py py-obj docutils literal notranslate"><span class="pre">|</span></code>). See
<a class="reference internal" href="#encapsulating-conditions"><span class="std std-ref">Encapsulating conditions</span></a> for details.</p>
<p>Subspace criteria may be provided for size 1 domain axes that are not
spanned by the field construct’s data.</p>
<p>Explicit indices may also be assigned to a domain axis identified by a
metadata construct, with either a Python <a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">slice</span></code></a> object, or a sequence
of integers or Booleans.</p>
<div class="literal-block-wrapper docutils container" id="id222">
<div class="code-block-caption"><span class="caption-text"><em>Create a new field construct whose domain spans the 2nd,
3rd and 5th elements of the ‘X’ axis, and reverses the
‘Y’ axis.</em></span><a class="headerlink" href="#id222" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">Y</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(3)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [75.0, ..., -75.0] degrees_north</span>
<span class="go">                : longitude(3) = [67.5, 112.5, 202.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01T00:00:00Z]</span>
</pre></div>
</div>
</div>
<p>For a dimension that is <a class="reference internal" href="#cyclic-domain-axes"><span class="std std-ref">cyclic</span></a>, a subspace
defined by a slice or by a <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> instance is assumed to “wrap”
around the edges of the data.</p>
<div class="literal-block-wrapper docutils container" id="id223">
<div class="code-block-caption"><span class="caption-text"><em>Create subspaces that wrap around a cyclic dimension.</em></span><a class="headerlink" href="#id223" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">wi</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">)))</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(6)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(6) = [-67.5, ..., 157.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(6)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(6) = [-67.5, ..., 157.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
</pre></div>
</div>
</div>
<section id="subspaces-in-time">
<h3><a class="toc-backref" href="#id428">Subspaces in time</a><a class="headerlink" href="#subspaces-in-time" title="Permalink to this headline">¶</a></h3>
<p>Subspaces based on time dimensions may be defined with as
<a class="reference internal" href="#time"><span class="std std-ref">elapsed times since the reference date</span></a>, or with
date-time objects.</p>
<div class="literal-block-wrapper docutils container" id="id224">
<div class="code-block-caption"><span class="caption-text"><em>Create subspaces in different ways based on the time dimension by selecting a particular date and using date-time and date-time queries.</em></span><a class="headerlink" href="#id224" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;timeseries.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(120), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: time(120) = [1959-12-16 12:00:00, ..., 1969-11-16 00:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">coordinate</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">9</span><span class="p">])</span>
<span class="go">[349.5 380.5 410.5 440.5 471.  501.5 532.  562.5 593.5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">coordinate</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">datetime_array</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">9</span><span class="p">])</span>
<span class="go">[cftime.DatetimeGregorian(1959-12-16 12:00:00)</span>
<span class="go"> cftime.DatetimeGregorian(1960-01-16 12:00:00)</span>
<span class="go"> cftime.DatetimeGregorian(1960-02-15 12:00:00)</span>
<span class="go"> cftime.DatetimeGregorian(1960-03-16 12:00:00)</span>
<span class="go"> cftime.DatetimeGregorian(1960-04-16 00:00:00)</span>
<span class="go"> cftime.DatetimeGregorian(1960-05-16 12:00:00)</span>
<span class="go"> cftime.DatetimeGregorian(1960-06-16 00:00:00)</span>
<span class="go"> cftime.DatetimeGregorian(1960-07-16 12:00:00)</span>
<span class="go"> cftime.DatetimeGregorian(1960-08-16 12:00:00)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mf">410.5</span><span class="p">))</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(1), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: time(1) = [1960-02-15 12:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="s1">&#39;1960-04-16&#39;</span><span class="p">)))</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(1), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: time(1) = [1960-04-16 00:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">wi</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="s1">&#39;1962-11-01&#39;</span><span class="p">),</span> <span class="n">cf</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="s1">&#39;1967-03-17 07:30&#39;</span><span class="p">))))</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(53), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: time(53) = [1962-11-16 00:00:00, ..., 1967-03-16 12:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
</pre></div>
</div>
</div>
</section>
<section id="subspace-mode">
<span id="id53"></span><h3><a class="toc-backref" href="#id429">Subspace mode</a><a class="headerlink" href="#subspace-mode" title="Permalink to this headline">¶</a></h3>
<p>There are three modes of operation, each of which provides a different
type of subspace:</p>
<ul>
<li><p><strong>compress mode</strong>. This is the default mode. Unselected locations
are removed to create the returned subspace:</p>
<div class="literal-block-wrapper docutils container" id="id225">
<div class="code-block-caption"><span class="caption-text"><em>Create a subspace by compressing the domain spanning the 2nd, 3rd, 5th and 7th elements of the ‘X’ axis, with the other domain axes remaining unchanged.</em></span><a class="headerlink" href="#id225" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.007 0.034 0.003 0.014 0.018 0.037 0.024 0.029]</span>
<span class="go"> [0.023 0.036 0.045 0.062 0.046 0.073 0.006 0.066]</span>
<span class="go"> [0.11  0.131 0.124 0.146 0.087 0.103 0.057 0.011]</span>
<span class="go"> [0.029 0.059 0.039 0.07  0.058 0.072 0.009 0.017]</span>
<span class="go"> [0.006 0.036 0.019 0.035 0.018 0.037 0.034 0.013]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="s1">&#39;compress&#39;</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q2</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(4)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(4) = [67.5, ..., 292.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01T00:00:00Z]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q2</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.034 0.003 0.018 0.024]</span>
<span class="go"> [0.036 0.045 0.046 0.006]</span>
<span class="go"> [0.131 0.124 0.087 0.057]</span>
<span class="go"> [0.059 0.039 0.058 0.009]</span>
<span class="go"> [0.036 0.019 0.018 0.034]]</span>
</pre></div>
</div>
</div>
<p>Note that if a multi-dimensional metadata construct is being used to
define the indices then some missing data may still be inserted at
unselected locations.</p>
</li>
</ul>
<ul>
<li><p><strong>envelope mode</strong>. The returned subspace is the smallest that
contains all of the selected indices. Missing data is inserted at
unselected locations within the envelope.</p>
<div class="literal-block-wrapper docutils container" id="id226">
<div class="code-block-caption"><span class="caption-text"><em>Create a subspace by selecting the 2nd, 3rd, 5th and 7th elements of the ‘X’ axis by creating an envelope of these elements with missing data within the envelope wherever needed.</em></span><a class="headerlink" href="#id226" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="s1">&#39;envelope&#39;</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q2</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(6)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(4) = [67.5, ..., 292.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01T00:00:00Z]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q2</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.034 0.003 -- 0.018 -- 0.024]</span>
<span class="go"> [0.036 0.045 -- 0.046 -- 0.006]</span>
<span class="go"> [0.131 0.124 -- 0.087 -- 0.057]</span>
<span class="go"> [0.059 0.039 -- 0.058 -- 0.009]</span>
<span class="go"> [0.036 0.019 -- 0.018 -- 0.034]]</span>
</pre></div>
</div>
</div>
</li>
</ul>
<ul>
<li><p><strong>full mode</strong>. The returned subspace has the same domain as the
original field construct. Missing data is inserted at unselected
locations.</p>
<div class="literal-block-wrapper docutils container" id="id227">
<div class="code-block-caption"><span class="caption-text"><em>Create a subspace by selecting the 2nd, 3rd, 5th and 7th elements of the ‘X’ axis with domain encompassing that of the original field construct with missing data within the domain wherever needed.</em></span><a class="headerlink" href="#id227" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q2</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01T00:00:00Z]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q2</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[-- 0.034 0.003 -- 0.018 -- 0.024 --]</span>
<span class="go"> [-- 0.036 0.045 -- 0.046 -- 0.006 --]</span>
<span class="go"> [-- 0.131 0.124 -- 0.087 -- 0.057 --]</span>
<span class="go"> [-- 0.059 0.039 -- 0.058 -- 0.009 --]</span>
<span class="go"> [-- 0.036 0.019 -- 0.018 -- 0.034 --]]</span>
</pre></div>
</div>
</div>
</li>
</ul>
<p>The <a class="reference internal" href="method/cf.Field.where.html#cf.Field.where" title="cf.Field.where"><code class="xref py py-obj docutils literal notranslate"><span class="pre">where</span></code></a> method of the field construct also allows values
(including missing data) to be assigned to the data based on criteria
applying to the field construct’s data, its metadata constructs; or
inserted from another field construct. See
<a class="reference internal" href="#assignment-by-condition"><span class="std std-ref">Assignment by condition</span></a>.</p>
</section>
<section id="multiple-dimensions">
<span id="id54"></span><h3><a class="toc-backref" href="#id430">Multiple dimensions</a><a class="headerlink" href="#multiple-dimensions" title="Permalink to this headline">¶</a></h3>
<p>Conditions may also be applied to multi-dimensional metadata
constructs</p>
<div class="literal-block-wrapper docutils container" id="id228">
<div class="code-block-caption"><span class="caption-text"><em>Create a subspace whose domain spans latitudes within the range of 51 to 53 degrees north, with the other domain axes remaining unchanged.</em></span><a class="headerlink" href="#id228" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">Field: air_temperature (ncvar%ta)</span>
<span class="go">---------------------------------</span>
<span class="go">Data            : air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K</span>
<span class="go">Cell methods    : grid_latitude(10): grid_longitude(9): mean where land (interval: 0.1 degrees) time(1): maximum</span>
<span class="go">Field ancils    : air_temperature standard_error(grid_latitude(10), grid_longitude(9)) = [[0.81, ..., 0.78]] K</span>
<span class="go">Dimension coords: time(1) = [2019-01-01 00:00:00]</span>
<span class="go">                : atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [2.2, ..., -1.76] degrees</span>
<span class="go">                : grid_longitude(9) = [-4.7, ..., -1.18] degrees</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[53.941, ..., 50.225]] degrees_N</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[2.004, ..., 8.156]] degrees_E</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., &#39;kappa&#39;]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[2391.9657, ..., 2392.6009]] km2</span>
<span class="go">Coord references: grid_mapping_name:rotated_latitude_longitude</span>
<span class="go">                : standard_name:atmosphere_hybrid_height_coordinate</span>
<span class="go">Domain ancils   : ncvar%a(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : ncvar%b(atmosphere_hybrid_height_coordinate(1)) = [20.0]</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 270.0]] m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[53.941 53.987 54.029 54.066 54.099 54.127 54.15  54.169 54.184]</span>
<span class="go"> [53.504 53.55  53.591 53.627 53.66  53.687 53.711 53.729 53.744]</span>
<span class="go"> [53.067 53.112 53.152 53.189 53.221 53.248 53.271 53.29  53.304]</span>
<span class="go"> [52.629 52.674 52.714 52.75  52.782 52.809 52.832 52.85  52.864]</span>
<span class="go"> [52.192 52.236 52.276 52.311 52.343 52.37  52.392 52.41  52.424]</span>
<span class="go"> [51.754 51.798 51.837 51.873 51.904 51.93  51.953 51.971 51.984]</span>
<span class="go"> [51.316 51.36  51.399 51.434 51.465 51.491 51.513 51.531 51.545]</span>
<span class="go"> [50.879 50.922 50.96  50.995 51.025 51.052 51.074 51.091 51.105]</span>
<span class="go"> [50.441 50.484 50.522 50.556 50.586 50.612 50.634 50.652 50.665]</span>
<span class="go"> [50.003 50.045 50.083 50.117 50.147 50.173 50.194 50.212 50.225]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">wi</span><span class="p">(</span><span class="mi">51</span><span class="p">,</span> <span class="mi">53</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t2</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[52.629 52.674 52.714 52.75  52.782 52.809 52.832 52.85  52.864]</span>
<span class="go"> [52.192 52.236 52.276 52.311 52.343 52.37  52.392 52.41  52.424]</span>
<span class="go"> [51.754 51.798 51.837 51.873 51.904 51.93  51.953 51.971 51.984]</span>
<span class="go"> [51.316 51.36  51.399 51.434 51.465 51.491 51.513 51.531 51.545]</span>
<span class="go"> [50.879 50.922 50.96  50.995 51.025 51.052 51.074 51.091 51.105]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t2</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[261.7 260.6 270.8 260.3 265.6 279.4 276.9 267.6 260.6]</span>
<span class="go">  [264.2 275.9 262.5 264.9 264.7 270.2 270.4 268.6 275.3]</span>
<span class="go">  [263.9 263.8 272.1 263.7 272.2 264.2 260.0 263.5 270.2]</span>
<span class="go">  [273.8 273.1 268.5 272.3 264.3 278.7 270.6 273.0 270.6]</span>
<span class="go">  [   --    --    --    -- 261.2 275.3 271.2 260.8 268.9]]]</span>
</pre></div>
</div>
</div>
<p>The “compress” mode is still the default mode, but because the indices
may not be acting along orthogonal dimensions, some missing data may
still need to be inserted into the field construct’s data, as is the
case in this example.</p>
</section>
<section id="assignment-by-metadata">
<span id="id55"></span><h3><a class="toc-backref" href="#id431">Assignment by metadata</a><a class="headerlink" href="#assignment-by-metadata" title="Permalink to this headline">¶</a></h3>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#assignment-by-index"><span class="std std-ref">Assignment by index</span></a>,
<a class="reference internal" href="#assignment-by-condition"><span class="std std-ref">Assignment by condition</span></a></p>
</div>
<p>Data elements can be changed by assigning to elements selected by
indices of the data (see <a class="reference internal" href="#assignment-by-index"><span class="std std-ref">Assignment by index</span></a>); by conditions
based on the data values of the field construct or one if its metadata
constructs (see <a class="reference internal" href="#assignment-by-condition"><span class="std std-ref">Assignment by condition</span></a>); or by identifying
indices based on arbitrary metadata constructs (as described in this
section).</p>
<p>Assignment by metadata makes use of the <a class="reference internal" href="method/cf.Field.indices.html#cf.Field.indices" title="cf.Field.indices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">indices</span></code></a> method of the
field construct to select metadata constructs and specify conditions
on their data. Indices for subspacing are then automatically inferred
from where the conditions are met. The tuple of indices returned by
the <a class="reference internal" href="method/cf.Field.indices.html#cf.Field.indices" title="cf.Field.indices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">indices</span></code></a> may then be used in normal <a class="reference internal" href="#assignment-by-index"><span class="std std-ref">assignment by
index</span></a>.</p>
<p>The <a class="reference internal" href="method/cf.Field.indices.html#cf.Field.indices" title="cf.Field.indices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">indices</span></code></a> method takes exactly the same arguments as the
<a class="reference internal" href="method/cf.Field.subspace.html#cf.Field.subspace" title="cf.Field.subspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">subspace</span></code></a> method of the field construct. See
<a class="reference internal" href="#subspacing-by-metadata"><span class="std std-ref">Subspacing by metadata</span></a> for details.</p>
<div class="literal-block-wrapper docutils container" id="id229">
<div class="code-block-caption"><span class="caption-text"><em>Assign air temperature values to the indices within certain longitude and latitude ranges.</em></span><a class="headerlink" href="#id229" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">Field: air_temperature (ncvar%ta)</span>
<span class="go">---------------------------------</span>
<span class="go">Data            : air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K</span>
<span class="go">Cell methods    : grid_latitude(10): grid_longitude(9): mean where land (interval: 0.1 degrees) time(1): maximum</span>
<span class="go">Field ancils    : air_temperature standard_error(grid_latitude(10), grid_longitude(9)) = [[0.76, ..., 0.32]] K</span>
<span class="go">Dimension coords: atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [2.2, ..., -1.76] degrees</span>
<span class="go">                : grid_longitude(9) = [-4.7, ..., -1.18] degrees</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[53.941, ..., 50.225]] degrees_N</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[2.004, ..., 8.156]] degrees_E</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., b&#39;kappa&#39;]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[2391.9657, ..., 2392.6009]] km2</span>
<span class="go">Coord references: grid_mapping_name:rotated_latitude_longitude</span>
<span class="go">                : standard_name:atmosphere_hybrid_height_coordinate</span>
<span class="go">Domain ancils   : ncvar%a(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : ncvar%b(atmosphere_hybrid_height_coordinate(1)) = [20.0]</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 270.0]] m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="n">grid_longitude</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">wi</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span>
<span class="go">(slice(0, 1, 1), slice(0, 10, 1), slice(2, 7, 1))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[262.8 270.5 -11.  -11.  -11.  -11.  -11.  278.9 269.2]</span>
<span class="go">  [272.7 268.4 -11.  -11.  -11.  -11.  -11.  265.7 279.5]</span>
<span class="go">  [269.7 279.1 -11.  -11.  -11.  -11.  -11.  272.5 263.7]</span>
<span class="go">  [261.7 260.6 -11.  -11.  -11.  -11.  -11.  267.6 260.6]</span>
<span class="go">  [264.2 275.9 -11.  -11.  -11.  -11.  -11.  268.6 275.3]</span>
<span class="go">  [263.9 263.8 -11.  -11.  -11.  -11.  -11.  263.5 270.2]</span>
<span class="go">  [273.8 273.1 -11.  -11.  -11.  -11.  -11.  273.  270.6]</span>
<span class="go">  [267.9 273.5 -11.  -11.  -11.  -11.  -11.  260.8 268.9]</span>
<span class="go">  [270.9 278.7 -11.  -11.  -11.  -11.  -11.  278.5 266.4]</span>
<span class="go">  [276.4 264.2 -11.  -11.  -11.  -11.  -11.  273.4 269.7]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">wi</span><span class="p">(</span><span class="mi">51</span><span class="p">,</span> <span class="mi">53</span><span class="p">))]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[262.8 270.5 -11.  -11.  -11.  -11.  -11.  278.9 269.2]</span>
<span class="go">  [272.7 268.4 -11.  -11.  -11.  -11.  -11.  265.7 279.5]</span>
<span class="go">  [269.7 279.1 -11.  -11.  -11.  -11.  -11.  272.5 263.7]</span>
<span class="go">  [-99.  -99.  -99.  -99.  -99.  -99.  -99.  -99.  -99. ]</span>
<span class="go">  [-99.  -99.  -99.  -99.  -99.  -99.  -99.  -99.  -99. ]</span>
<span class="go">  [-99.  -99.  -99.  -99.  -99.  -99.  -99.  -99.  -99. ]</span>
<span class="go">  [-99.  -99.  -99.  -99.  -99.  -99.  -99.  -99.  -99. ]</span>
<span class="go">  [267.9 273.5 -11.  -11.  -99.  -99.  -99.  -99.  -99. ]</span>
<span class="go">  [270.9 278.7 -11.  -11.  -11.  -11.  -11.  278.5 266.4]</span>
<span class="go">  [276.4 264.2 -11.  -11.  -11.  -11.  -11.  273.4 269.7]]]</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="sorting-and-selecting-from-field-lists">
<span id="id56"></span><h2><a class="toc-backref" href="#id432"><strong>Sorting and selecting from field lists</strong></a><a class="headerlink" href="#sorting-and-selecting-from-field-lists" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference internal" href="#field-lists"><span class="std std-ref">field list</span></a> may be sorted in-place using the
same syntax as a Python <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a>. By default the field list is sorted by
the values of the field constructs identities, but any sorting
criteria are possible.</p>
<div class="literal-block-wrapper docutils container" id="id230">
<div class="code-block-caption"><span class="caption-text"><em>Sort a field list by the field construct identities, and
by field construct units.</em></span><a class="headerlink" href="#id230" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span>
<span class="go">[&lt;CF Field: specific_humidity(latitude(5), longitude(8)) 1&gt;,</span>
<span class="go"> &lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span>
<span class="go">[&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;,</span>
<span class="go"> &lt;CF Field: specific_humidity(latitude(5), longitude(8)) 1&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span>
<span class="go">[&lt;CF Field: specific_humidity(latitude(5), longitude(8)) 1&gt;,</span>
<span class="go"> &lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;]</span>
</pre></div>
</div>
</div>
<p>A field list has methods for selecting field constructs that meet
various criteria:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Filter criteria</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.FieldList.select_by_identity.html#cf.FieldList.select_by_identity" title="cf.FieldList.select_by_identity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">select_by_identity</span></code></a></p></td>
<td><p>Field construct identity</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.FieldList.select_by_property.html#cf.FieldList.select_by_property" title="cf.FieldList.select_by_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">select_by_property</span></code></a></p></td>
<td><p>Property values</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.FieldList.select_by_units.html#cf.FieldList.select_by_units" title="cf.FieldList.select_by_units"><code class="xref py py-obj docutils literal notranslate"><span class="pre">select_by_units</span></code></a></p></td>
<td><p>Units values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.FieldList.select_by_rank.html#cf.FieldList.select_by_rank" title="cf.FieldList.select_by_rank"><code class="xref py py-obj docutils literal notranslate"><span class="pre">select_by_rank</span></code></a></p></td>
<td><p>The total number of domain axis constructs in the domain</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.FieldList.select_by_naxes.html#cf.FieldList.select_by_naxes" title="cf.FieldList.select_by_naxes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">select_by_naxes</span></code></a></p></td>
<td><p>The number of domain axis constructs spanned by the data</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.FieldList.select_by_construct.html#cf.FieldList.select_by_construct" title="cf.FieldList.select_by_construct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">select_by_construct</span></code></a></p></td>
<td><p>Existence and values of metadata constructs</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.FieldList.select_by_ncvar.html#cf.FieldList.select_by_ncvar" title="cf.FieldList.select_by_ncvar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">select_by_ncvar</span></code></a></p></td>
<td><p>NetCDF variable name (see the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>)</p></td>
</tr>
</tbody>
</table>
<p>Each of these methods returns a new (possibly empty) field list that
contains the selected field constructs.</p>
<div class="literal-block-wrapper docutils container" id="id231">
<div class="code-block-caption"><span class="caption-text"><em>Get field constructs by their identity.</em></span><a class="headerlink" href="#id231" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;*.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span>
<span class="go">[&lt;CF Field: specific_humidity(cf_role=timeseries_id(4), ncdim%timeseries(9))&gt;,</span>
<span class="go"> &lt;CF Field: eastward_wind(latitude(10), longitude(9)) m s-1&gt;,</span>
<span class="go"> &lt;CF Field: cell_area(ncdim%longitude(9), ncdim%latitude(10)) m2&gt;,</span>
<span class="go"> &lt;CF Field: specific_humidity(latitude(5), longitude(8)) 1&gt;,</span>
<span class="go"> &lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;,</span>
<span class="go"> &lt;CF Field: air_temperature(time(2), latitude(73), longitude(96)) K&gt;,</span>
<span class="go"> &lt;CF Field: air_potential_temperature(time(120), latitude(5), longitude(8)) K&gt;,</span>
<span class="go"> &lt;CF Field: precipitation_flux(time(2), latitude(4), longitude(5)) kg m2 s-1&gt;,</span>
<span class="go"> &lt;CF Field: precipitation_flux(time(1), latitude(64), longitude(128)) kg m-2 day-1&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">.</span><span class="n">select_by_identity</span><span class="p">(</span><span class="s1">&#39;precipitation_flux&#39;</span><span class="p">)</span>
<span class="go">[&lt;CF Field: precipitation_flux(time(2), latitude(4), longitude(5)) kg m2 s-1&gt;,</span>
<span class="go"> &lt;CF Field: precipitation_flux(time(1), latitude(64), longitude(128)) kg m-2 day-1&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">re</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">.</span><span class="n">select_by_identity</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;.*potential.*&#39;</span><span class="p">))</span>
<span class="go">[&lt;CF Field: air_potential_temperature(time(120), latitude(5), longitude(8)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">.</span><span class="n">select_by_identity</span><span class="p">(</span><span class="s1">&#39;relative_humidity&#39;</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</div>
<p>As a convenience, selection by field construct identity is also
possible by providing identities to a call of a field list itself, or
to its <a class="reference internal" href="method/cf.FieldList.select.html#cf.FieldList.select" title="cf.FieldList.select"><code class="xref py py-obj docutils literal notranslate"><span class="pre">select</span></code></a> method.</p>
<div class="literal-block-wrapper docutils container" id="id232">
<div class="code-block-caption"><span class="caption-text"><em>Get field constructs by their identity by calling the
instance directly, or with the ‘select’ method.</em></span><a class="headerlink" href="#id232" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="p">(</span><span class="s1">&#39;air_temperature&#39;</span><span class="p">)</span>
<span class="go">[&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;,</span>
<span class="go"> &lt;CF Field: air_temperature(time(2), latitude(73), longitude(96)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;air_temperature&#39;</span><span class="p">)</span>
<span class="go">[&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;,</span>
<span class="go"> &lt;CF Field: air_temperature(time(2), latitude(73), longitude(96)) K&gt;]</span>
</pre></div>
</div>
</div>
<section id="testing-criteria-on-a-field-construct">
<span id="id57"></span><h3><a class="toc-backref" href="#id433">Testing criteria on a field construct</a><a class="headerlink" href="#testing-criteria-on-a-field-construct" title="Permalink to this headline">¶</a></h3>
<p>A field construct has methods for ascertaining whether or not it meets
various criteria:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 73%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Match criteria</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.match_by_identity.html#cf.Field.match_by_identity" title="cf.Field.match_by_identity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">match_by_identity</span></code></a></p></td>
<td><p>Field construct identity</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.match.html#cf.Field.match" title="cf.Field.match"><code class="xref py py-obj docutils literal notranslate"><span class="pre">match</span></code></a></p></td>
<td><p>Field construct identity</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.match_by_property.html#cf.Field.match_by_property" title="cf.Field.match_by_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">match_by_property</span></code></a></p></td>
<td><p>Property values</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.match_by_units.html#cf.Field.match_by_units" title="cf.Field.match_by_units"><code class="xref py py-obj docutils literal notranslate"><span class="pre">match_by_units</span></code></a></p></td>
<td><p>Units values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.match_by_rank.html#cf.Field.match_by_rank" title="cf.Field.match_by_rank"><code class="xref py py-obj docutils literal notranslate"><span class="pre">match_by_rank</span></code></a></p></td>
<td><p>The total number of domain axis constructs in the domain</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.match_by_naxes.html#cf.Field.match_by_naxes" title="cf.Field.match_by_naxes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">match_by_naxes</span></code></a></p></td>
<td><p>The number of domain axis constructs spanned by the data</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.match_by_construct.html#cf.Field.match_by_construct" title="cf.Field.match_by_construct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">match_by_construct</span></code></a></p></td>
<td><p>Existence and values of metadata constructs</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.match_by_ncvar.html#cf.Field.match_by_ncvar" title="cf.Field.match_by_ncvar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">match_by_ncvar</span></code></a></p></td>
<td><p>NetCDF variable name (see the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>)</p></td>
</tr>
</tbody>
</table>
<p>Each of these methods returns <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> if the field construct matches
the given criteria, or else <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p>
<div class="literal-block-wrapper docutils container" id="id233">
<div class="code-block-caption"><span class="caption-text"><em>Match a field construct to its properties and metadata.</em></span><a class="headerlink" href="#id233" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">Field: air_temperature (ncvar%ta)</span>
<span class="go">---------------------------------</span>
<span class="go">Data            : air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K</span>
<span class="go">Cell methods    : grid_latitude(10): grid_longitude(9): mean where land (interval: 0.1 degrees) time(1): maximum</span>
<span class="go">Field ancils    : air_temperature standard_error(grid_latitude(10), grid_longitude(9)) = [[0.76, ..., 0.32]] K</span>
<span class="go">Dimension coords: atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [2.2, ..., -1.76] degrees</span>
<span class="go">                : grid_longitude(9) = [-4.7, ..., -1.18] degrees</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[53.941, ..., 50.225]] degrees_N</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[2.004, ..., 8.156]] degrees_E</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., &#39;kappa&#39;]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[2391.9657, ..., 2392.6009]] km2</span>
<span class="go">Coord references: grid_mapping_name:rotated_latitude_longitude</span>
<span class="go">                : standard_name:atmosphere_hybrid_height_coordinate</span>
<span class="go">Domain ancils   : ncvar%a(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : ncvar%b(atmosphere_hybrid_height_coordinate(1)) = [20.0]</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 270.0]] m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">match_by_identity</span><span class="p">(</span><span class="s1">&#39;air_temperature&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">match_by_rank</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">match_by_units</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">match_by_construct</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">wi</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<p>As a convenience, matching a field construct by identity is also
possible with the <a class="reference internal" href="method/cf.Field.match.html#cf.Field.match" title="cf.Field.match"><code class="xref py py-obj docutils literal notranslate"><span class="pre">match</span></code></a> method, which is as alias for
<a class="reference internal" href="method/cf.Field.match_by_identity.html#cf.Field.match_by_identity" title="cf.Field.match_by_identity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">match_by_identity</span></code></a>.</p>
<div class="literal-block-wrapper docutils container" id="id234">
<div class="code-block-caption"><span class="caption-text"><em>Match a field construct to its identity</em>.</span><a class="headerlink" href="#id234" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;specific_humidity&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;specific_humidity&#39;</span><span class="p">,</span> <span class="s1">&#39;air_temperature&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="encapsulating-conditions">
<span id="id58"></span><h2><a class="toc-backref" href="#id434"><strong>Encapsulating conditions</strong></a><a class="headerlink" href="#encapsulating-conditions" title="Permalink to this headline">¶</a></h2>
<p>A condition that may be applied to any construct (or, indeed, any
object) may be stored in a <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object. A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object
encapsulates a condition, such as “strictly less than 3”. When applied
to an object, via the <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> instance’s <a class="reference internal" href="method/cf.Query.evaluate.html#cf.Query.evaluate" title="cf.Query.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a> method
or the Python equality (<code class="xref py py-obj docutils literal notranslate"><span class="pre">==</span></code>) operator, the condition is evaluated in
the context of that object.</p>
<div class="literal-block-wrapper docutils container" id="id235">
<div class="code-block-caption"><span class="caption-text"><em>An example evaluating a strictly less than 3 query condition.</em></span><a class="headerlink" href="#id235" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span><span class="s1">&#39;lt&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span>
<span class="go">&lt;CF Query: (lt 3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">==</span> <span class="mi">2</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">!=</span> <span class="mi">2</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">==</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">&lt;CF Data(3): [True, True, False]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">[ True  True False]</span>
</pre></div>
</div>
</div>
<p>The following operators are supported when constructing <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a>
instances:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 87%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'lt'</span></code></p></td>
<td><p>A “strictly less than” condition</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'le'</span></code></p></td>
<td><p>A “less than or equal” condition</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'gt'</span></code></p></td>
<td><p>A “strictly greater than” condition</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'ge'</span></code></p></td>
<td><p>A “greater than or equal” condition</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'eq'</span></code></p></td>
<td><p>An “equal” condition</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'ne'</span></code></p></td>
<td><p>A “not equal” condition</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'wi'</span></code></p></td>
<td><p>A “within a range” condition</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'wo'</span></code></p></td>
<td><p>A “without a range” condition</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'set'</span></code></p></td>
<td><p>A “member of set” condition</p></td>
</tr>
</tbody>
</table>
<section id="compound-conditions">
<h3><a class="toc-backref" href="#id435">Compound conditions</a><a class="headerlink" href="#compound-conditions" title="Permalink to this headline">¶</a></h3>
<p>Multiple conditions may be combined with the Python bitwise “and”
(<code class="xref py py-obj docutils literal notranslate"><span class="pre">&amp;</span></code>) and “or” (<code class="xref py py-obj docutils literal notranslate"><span class="pre">|</span></code>) operators to form a new, compound <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a>
object.</p>
<div class="literal-block-wrapper docutils container" id="id236">
<div class="code-block-caption"><span class="caption-text"><em>An example evaluating a compound query operation involving a greater than or equal to 3 condition and a strictly less than 5 condition.</em></span><a class="headerlink" href="#id236" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ge3</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span><span class="s1">&#39;ge&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lt5</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span><span class="s1">&#39;lt&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">ge3</span> <span class="o">&amp;</span> <span class="n">lt5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span>
<span class="go">&lt;CF Query: [(ge 3) &amp; (lt 5)]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">==</span> <span class="mi">2</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">!=</span> <span class="mi">2</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">ge3</span> <span class="o">|</span> <span class="n">lt5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span>
<span class="go">&lt;CF Query: [(ge 3) | (lt 5)]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">==</span> <span class="mi">2</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">&amp;=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span><span class="s1">&#39;set&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span>
<span class="go">&lt;CF Query: [[(ge 3) | (lt 5)] &amp; (set [1, 3, 5])]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">==</span> <span class="mi">2</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">==</span> <span class="mi">3</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<p>A condition can also be applied to an attribute (as well as attributes
of attributes) of an object.</p>
<div class="literal-block-wrapper docutils container" id="id237">
<div class="code-block-caption"><span class="caption-text"><em>Define and apply a condition that is applied to the
upper bounds of a coordinate construct’s cells.</em></span><a class="headerlink" href="#id237" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">upper_bounds_ge_minus4</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span><span class="s1">&#39;ge&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;upper_bounds&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">dimension_coordinate</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span>
<span class="go">&lt;CF DimensionCoordinate: grid_longitude(9) degrees&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[-4.92 -4.48]</span>
<span class="go"> [-4.48 -4.04]</span>
<span class="go"> [-4.04 -3.6 ]</span>
<span class="go"> [-3.6  -3.16]</span>
<span class="go"> [-3.16 -2.72]</span>
<span class="go"> [-2.72 -2.28]</span>
<span class="go"> [-2.28 -1.84]</span>
<span class="go"> [-1.84 -1.4 ]</span>
<span class="go"> [-1.4  -0.96]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">upper_bounds_ge_minus4</span> <span class="o">==</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[False False  True  True  True  True  True  True  True]</span>
</pre></div>
</div>
</div>
</section>
<section id="condition-constructors">
<h3><a class="toc-backref" href="#id436">Condition constructors</a><a class="headerlink" href="#condition-constructors" title="Permalink to this headline">¶</a></h3>
<p>For convenience, many commonly used conditions can be created with
<a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> instance constructors.</p>
<div class="literal-block-wrapper docutils container" id="id238">
<div class="code-block-caption"><span class="caption-text"><em>An example of a constructor (for a cell containing a
value) and its equivalent construction from constructor
cf.Query instances.</em></span><a class="headerlink" href="#id238" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">&lt;CF Query: [lower_bounds(le 4) &amp; upper_bounds(ge 4)]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span><span class="s1">&#39;lt&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;lower_bounds&#39;</span><span class="p">)</span> <span class="o">&amp;</span>  <span class="n">cf</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span><span class="s1">&#39;ge&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;upper_bounds&#39;</span><span class="p">)</span>
<span class="go">&lt;CF Query: [lower_bounds(lt 4) &amp; upper_bounds(ge 4)]&gt;</span>
</pre></div>
</div>
</div>
<p>The following <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> constructors are available:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" colspan="2"><p><em>General conditions</em></p></th>
</tr>
<tr class="row-even"><th class="head"><p>Constructor</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.lt.html#cf.lt" title="cf.lt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.lt</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “strictly less than” condition</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="function/cf.le.html#cf.le" title="cf.le"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.le</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “less than or equal” condition</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.gt.html#cf.gt" title="cf.gt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.gt</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “strictly greater than” condition</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="function/cf.ge.html#cf.ge" title="cf.ge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.ge</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “strictly greater than or equal” condition</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.eq.html#cf.eq" title="cf.eq"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.eq</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for an “equal” condition</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="function/cf.ne.html#cf.ne" title="cf.ne"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.ne</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “not equal” condition</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.wi.html#cf.wi" title="cf.wi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.wi</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “within a range” condition</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="function/cf.wo.html#cf.wo" title="cf.wo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.wo</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “without a range” condition</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.set.html#cf.set" title="cf.set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.set</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “member of set” condition</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 86%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" colspan="2"><p><em>Date-time conditions</em></p></th>
</tr>
<tr class="row-even"><th class="head"><p>Constructor</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.year.html#cf.year" title="cf.year"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.year</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “year” condition</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="function/cf.month.html#cf.month" title="cf.month"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.month</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “month of the year” condition</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.day.html#cf.day" title="cf.day"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.day</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “day of the month” condition</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="function/cf.hour.html#cf.hour" title="cf.hour"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.hour</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “hour of the day” condition</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.minute.html#cf.minute" title="cf.minute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.minute</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “minute of the hour” condition</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="function/cf.second.html#cf.second" title="cf.second"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.second</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “second of the minute” condition</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.jja.html#cf.jja" title="cf.jja"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.jja</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “month of year in June, July or August” condition</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="function/cf.son.html#cf.son" title="cf.son"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.son</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “month of year in September, October, November” condition</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.djf.html#cf.djf" title="cf.djf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.djf</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “month of year in December, January, February” condition</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="function/cf.mam.html#cf.mam" title="cf.mam"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.mam</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “month of year in March, April, May” condition</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.seasons.html#cf.seasons" title="cf.seasons"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.seasons</span></code></a></p></td>
<td><p>A customisable list of <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> objects for “seasons in a year” conditions</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 85%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" colspan="2"><p><em>Coordinate cell conditions</em></p></th>
</tr>
<tr class="row-even"><th class="head"><p>Constructor</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.contains.html#cf.contains" title="cf.contains"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.contains</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “cell contains” condition</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="function/cf.cellsize.html#cf.cellsize" title="cf.cellsize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.cellsize</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “cell size” condition</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.cellgt.html#cf.cellgt" title="cf.cellgt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.cellgt</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “cell bounds strictly greater than” condition</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="function/cf.cellge.html#cf.cellge" title="cf.cellge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.cellge</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “cell bounds greater than or equal” condition</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.celllt.html#cf.celllt" title="cf.celllt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.celllt</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “cell bounds strictly less than” condition</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="function/cf.cellle.html#cf.cellle" title="cf.cellle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.cellle</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “cell bounds less than or equal” condition</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="function/cf.cellwi.html#cf.cellwi" title="cf.cellwi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.cellwi</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “cell bounds lie within range” condition</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="function/cf.cellwo.html#cf.cellwo" title="cf.cellwo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.cellwo</span></code></a></p></td>
<td><p>A <a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a> object for a “cell bounds lie without range” condition</p></td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container" id="id239">
<div class="code-block-caption"><span class="caption-text"><em>Some examples of ‘cf.Query’ objects returned by
constructors.</em></span><a class="headerlink" href="#id239" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">&lt;CF Query: (ge 3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="s1">&#39;2000-3-23&#39;</span><span class="p">))</span>
<span class="go">&lt;CF Query: (ge 2000-03-23 00:00:00)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">year</span><span class="p">(</span><span class="mi">1999</span><span class="p">)</span>
<span class="go">&lt;CF Query: year(eq 1999)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">wi</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="go">&lt;CF Query: month(wi [6, 8])&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">jja</span><span class="p">()</span>
<span class="go">&lt;CF Query: month(wi (6, 8))&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">&lt;CF Query: [lower_bounds(le 4) &amp; upper_bounds(ge 4)]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">cellsize</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">))</span>
<span class="go">&lt;CF Query: cellsize(lt 10 degrees)&gt;</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="assignment-by-condition">
<span id="id59"></span><h2><a class="toc-backref" href="#id437"><strong>Assignment by condition</strong></a><a class="headerlink" href="#assignment-by-condition" title="Permalink to this headline">¶</a></h2>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#assignment-by-index"><span class="std std-ref">Assignment by index</span></a>,
<a class="reference internal" href="#assignment-by-metadata"><span class="std std-ref">Assignment by metadata</span></a>, <a class="reference internal" href="#data-mask"><span class="std std-ref">Data mask</span></a></p>
</div>
<p>Data elements can be changed by assigning to elements selected by
indices of the data (see <a class="reference internal" href="#assignment-by-index"><span class="std std-ref">Assignment by index</span></a>); by conditions
based on the data values of the field construct or one of its metadata
constructs (as described in this section); or by identifying indices
based on arbitrary metadata constructs (see
<a class="reference internal" href="#assignment-by-metadata"><span class="std std-ref">Assignment by metadata</span></a>).</p>
<p>Assignment by condition uses the <a class="reference internal" href="method/cf.Field.where.html#cf.Field.where" title="cf.Field.where"><code class="xref py py-obj docutils literal notranslate"><span class="pre">where</span></code></a> method of the field
construct. This method automatically infers indices for assignment
from conditions on the field construct’s data, or its metadata, or
from other field constructs or data. Different values can be assigned
to where the conditions are, and are not, met.</p>
<div class="literal-block-wrapper docutils container" id="id240">
<div class="code-block-caption"><span class="caption-text"><em>Set all data elements that are less than 273.15 to
missing data.</em></span><a class="headerlink" href="#id240" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[262.8 270.5 279.8 269.5 260.9 265.  263.5 278.9 269.2]</span>
<span class="go">  [272.7 268.4 279.5 278.9 263.8 263.3 274.2 265.7 279.5]</span>
<span class="go">  [269.7 279.1 273.4 274.2 279.6 270.2 280.  272.5 263.7]</span>
<span class="go">  [261.7 260.6 270.8 260.3 265.6 279.4 276.9 267.6 260.6]</span>
<span class="go">  [264.2 275.9 262.5 264.9 264.7 270.2 270.4 268.6 275.3]</span>
<span class="go">  [263.9 263.8 272.1 263.7 272.2 264.2 260.  263.5 270.2]</span>
<span class="go">  [273.8 273.1 268.5 272.3 264.3 278.7 270.6 273.  270.6]</span>
<span class="go">  [267.9 273.5 279.8 260.3 261.2 275.3 271.2 260.8 268.9]</span>
<span class="go">  [270.9 278.7 273.2 261.7 271.6 265.8 273.  278.5 266.4]</span>
<span class="go">  [276.4 264.2 276.3 266.1 276.1 268.1 277.  273.4 269.7]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mf">273.15</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">masked</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[   --    -- 279.8    --    --    --    -- 278.9    --]</span>
<span class="go">  [   --    -- 279.5 278.9    --    -- 274.2    -- 279.5]</span>
<span class="go">  [   -- 279.1 273.4 274.2 279.6    -- 280.0    --    --]</span>
<span class="go">  [   --    --    --    --    -- 279.4 276.9    --    --]</span>
<span class="go">  [   -- 275.9    --    --    --    --    --    -- 275.3]</span>
<span class="go">  [   --    --    --    --    --    --    --    --    --]</span>
<span class="go">  [273.8    --    --    --    -- 278.7    --    --    --]</span>
<span class="go">  [   -- 273.5 279.8    --    -- 275.3    --    --    --]</span>
<span class="go">  [   -- 278.7 273.2    --    --    --    -- 278.5    --]</span>
<span class="go">  [276.4    -- 276.3    -- 276.1    -- 277.0 273.4    --]]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id241">
<div class="code-block-caption"><span class="caption-text"><em>Set all data elements that are less than 273.15 to 0,
and all other elements to 1.</em></span><a class="headerlink" href="#id241" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mf">273.15</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[0. 0. 1. 0. 0. 0. 0. 1. 0.]</span>
<span class="go">  [0. 0. 1. 1. 0. 0. 1. 0. 1.]</span>
<span class="go">  [0. 1. 1. 1. 1. 0. 1. 0. 0.]</span>
<span class="go">  [0. 0. 0. 0. 0. 1. 1. 0. 0.]</span>
<span class="go">  [0. 1. 0. 0. 0. 0. 0. 0. 1.]</span>
<span class="go">  [0. 0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="go">  [1. 0. 0. 0. 0. 1. 0. 0. 0.]</span>
<span class="go">  [0. 1. 1. 0. 0. 1. 0. 0. 0.]</span>
<span class="go">  [0. 1. 1. 0. 0. 0. 0. 1. 0.]</span>
<span class="go">  [1. 0. 1. 0. 1. 0. 1. 1. 0.]]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id242">
<div class="code-block-caption"><span class="caption-text"><em>Where the data of field ‘u’ is True, multiply all
elements of ‘t’ by -1, and at all other points set ‘t’ to
-99.</em></span><a class="headerlink" href="#id242" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mi">99</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[ -99.   -99.  -279.8  -99.   -99.   -99.   -99.  -278.9  -99. ]</span>
<span class="go">  [ -99.   -99.  -279.5 -278.9  -99.   -99.  -274.2  -99.  -279.5]</span>
<span class="go">  [ -99.  -279.1 -273.4 -274.2 -279.6  -99.  -280.   -99.   -99. ]</span>
<span class="go">  [ -99.   -99.   -99.   -99.   -99.  -279.4 -276.9  -99.   -99. ]</span>
<span class="go">  [ -99.  -275.9  -99.   -99.   -99.   -99.   -99.   -99.  -275.3]</span>
<span class="go">  [ -99.   -99.   -99.   -99.   -99.   -99.   -99.   -99.   -99. ]</span>
<span class="go">  [-273.8  -99.   -99.   -99.   -99.  -278.7  -99.   -99.   -99. ]</span>
<span class="go">  [ -99.  -273.5 -279.8  -99.   -99.  -275.3  -99.   -99.   -99. ]</span>
<span class="go">  [ -99.  -278.7 -273.2  -99.   -99.   -99.   -99.  -278.5  -99. ]</span>
<span class="go">  [-276.4  -99.  -276.3  -99.  -276.1  -99.  -277.  -273.4  -99. ]]]</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="method/cf.Field.where.html#cf.Field.where" title="cf.Field.where"><code class="xref py py-obj docutils literal notranslate"><span class="pre">where</span></code></a> method also allows the condition to be applied to a
metadata construct’s data:</p>
<div class="literal-block-wrapper docutils container" id="id243">
<div class="code-block-caption"><span class="caption-text"><em>Where the ‘Y’ coordinates are greater than 0.5, set the
field construct data to missing data.</em></span><a class="headerlink" href="#id243" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">masked</span><span class="p">,</span> <span class="n">construct</span><span class="o">=</span><span class="s1">&#39;grid_latitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[   --    --    --    --    --    --    --    --    --]</span>
<span class="go">  [   --    --    --    --    --    --    --    --    --]</span>
<span class="go">  [   --    --    --    --    --    --    --    --    --]</span>
<span class="go">  [   --    --    --    --    --    --    --    --    --]</span>
<span class="go">  [264.2 275.9 262.5 264.9 264.7 270.2 270.4 268.6 275.3]</span>
<span class="go">  [263.9 263.8 272.1 263.7 272.2 264.2 260.0 263.5 270.2]</span>
<span class="go">  [273.8 273.1 268.5 272.3 264.3 278.7 270.6 273.0 270.6]</span>
<span class="go">  [267.9 273.5 279.8 260.3 261.2 275.3 271.2 260.8 268.9]</span>
<span class="go">  [270.9 278.7 273.2 261.7 271.6 265.8 273.0 278.5 266.4]</span>
<span class="go">  [276.4 264.2 276.3 266.1 276.1 268.1 277.0 273.4 269.7]]]</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="#masked-values"><span class="std std-ref">hardness of the mask</span></a> is respected by the
<a class="reference internal" href="method/cf.Field.where.html#cf.Field.where" title="cf.Field.where"><code class="xref py py-obj docutils literal notranslate"><span class="pre">where</span></code></a> method, so missing data in the field construct can only
be unmasked if the mask has first been made soft.</p>
<p>There are many variants on how the condition and assignment values may
be specified. See the <a class="reference internal" href="method/cf.Field.where.html#cf.Field.where" title="cf.Field.where"><code class="xref py py-obj docutils literal notranslate"><span class="pre">where</span></code></a> method documentation for details.</p>
<p>The <a class="reference internal" href="method/cf.Field.where.html#cf.Field.where" title="cf.Field.where"><code class="xref py py-obj docutils literal notranslate"><span class="pre">where</span></code></a> method may be used for applying the mask from other
data:</p>
<div class="literal-block-wrapper docutils container" id="id244">
<div class="code-block-caption"><span class="caption-text"><em>Where the ‘Y’ coordinates are greater than 0.5, set the
field construct data to missing data.</em></span><a class="headerlink" href="#id244" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">masked</span><span class="p">))</span>
<span class="go">[[[   --    --    --    --    --    --    --    --    --]</span>
<span class="go">  [   --    --    --    --    --    --    --    --    --]</span>
<span class="go">  [   --    --    --    --    --    --    --    --    --]</span>
<span class="go">  [   --    --    --    --    --    --    --    --    --]</span>
<span class="go">  [264.2 275.9 262.5 264.9 264.7 270.2 270.4 268.6 275.3]</span>
<span class="go">  [263.9 263.8 272.1 263.7 272.2 264.2 260.0 263.5 270.2]</span>
<span class="go">  [273.8 273.1 268.5 272.3 264.3 278.7 270.6 273.0 270.6]</span>
<span class="go">  [267.9 273.5 279.8 260.3 261.2 275.3 271.2 260.8 268.9]</span>
<span class="go">  [270.9 278.7 273.2 261.7 271.6 265.8 273.0 278.5 266.4]</span>
<span class="go">  [276.4 264.2 276.3 266.1 276.1 268.1 277.0 273.4 269.7]]]</span>
</pre></div>
</div>
</div>
<p>The condition may also be any object that broadcasts to the field
constructs data:</p>
<div class="literal-block-wrapper docutils container" id="id245">
<div class="code-block-caption"><span class="caption-text"><em>Mask all points, and those in selected columns.</em></span><a class="headerlink" href="#id245" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">masked</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[-- -- -- -- -- -- -- -- --]</span>
<span class="go">  [-- -- -- -- -- -- -- -- --]</span>
<span class="go">  [-- -- -- -- -- -- -- -- --]</span>
<span class="go">  [-- -- -- -- -- -- -- -- --]</span>
<span class="go">  [-- -- -- -- -- -- -- -- --]</span>
<span class="go">  [-- -- -- -- -- -- -- -- --]</span>
<span class="go">  [-- -- -- -- -- -- -- -- --]</span>
<span class="go">  [-- -- -- -- -- -- -- -- --]</span>
<span class="go">  [-- -- -- -- -- -- -- -- --]</span>
<span class="go">  [-- -- -- -- -- -- -- -- --]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">where</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">masked</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[262.8 270.5 -- 269.5 -- -- -- 278.9 269.2]</span>
<span class="go">  [272.7 268.4 -- 278.9 -- -- -- 265.7 279.5]</span>
<span class="go">  [269.7 279.1 -- 274.2 -- -- -- 272.5 263.7]</span>
<span class="go">  [261.7 260.6 -- 260.3 -- -- -- 267.6 260.6]</span>
<span class="go">  [264.2 275.9 -- 264.9 -- -- -- 268.6 275.3]</span>
<span class="go">  [263.9 263.8 -- 263.7 -- -- -- 263.5 270.2]</span>
<span class="go">  [273.8 273.1 -- 272.3 -- -- -- 273.0 270.6]</span>
<span class="go">  [267.9 273.5 -- 260.3 -- -- -- 260.8 268.9]</span>
<span class="go">  [270.9 278.7 -- 261.7 -- -- -- 278.5 266.4]</span>
<span class="go">  [276.4 264.2 -- 266.1 -- -- -- 273.4 269.7]]]</span>
</pre></div>
</div>
</div>
<p>This is particularly useful when the field construct does not have
sufficient metadata to unambiguously identify its domain axes:</p>
<div class="literal-block-wrapper docutils container" id="id246">
<div class="code-block-caption"><span class="caption-text"><em>Mask all points from “v”, using the data objects and
therefore bypassing the metadata checks.</em></span><a class="headerlink" href="#id246" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">masked</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[   --    --    --    --    --    --    --    --    --]</span>
<span class="go">  [   --    --    --    --    --    --    --    --    --]</span>
<span class="go">  [   --    --    --    --    --    --    --    --    --]</span>
<span class="go">  [   --    --    --    --    --    --    --    --    --]</span>
<span class="go">  [264.2 275.9 262.5 264.9 264.7 270.2 270.4 268.6 275.3]</span>
<span class="go">  [263.9 263.8 272.1 263.7 272.2 264.2 260.0 263.5 270.2]</span>
<span class="go">  [273.8 273.1 268.5 272.3 264.3 278.7 270.6 273.0 270.6]</span>
<span class="go">  [267.9 273.5 279.8 260.3 261.2 275.3 271.2 260.8 268.9]</span>
<span class="go">  [270.9 278.7 273.2 261.7 271.6 265.8 273.0 278.5 266.4]</span>
<span class="go">  [276.4 264.2 276.3 266.1 276.1 268.1 277.0 273.4 269.7]]]</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="field-creation">
<span id="id60"></span><h2><a class="toc-backref" href="#id438"><strong>Field creation</strong></a><a class="headerlink" href="#field-creation" title="Permalink to this headline">¶</a></h2>
<p>There are various methods for creating a field construct in memory:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#ab-initio-creation"><span class="std std-ref">Ab initio creation</span></a>: Instantiate
instances of field and metadata construct classes and manually
provide the connections between them.</p></li>
</ul>
<ul class="simple">
<li><p><a class="reference internal" href="#command-modification"><span class="std std-ref">Command modification</span></a>: Produce the
commands that would create an already existing field construct, and
then modify them.</p></li>
</ul>
<ul class="simple">
<li><p><a class="reference internal" href="#creation-by-conversion"><span class="std std-ref">Creation by conversion</span></a>: Convert a
single metadata construct already in memory to an independent field
construct.</p></li>
</ul>
<ul class="simple">
<li><p><a class="reference internal" href="#creation-by-reading"><span class="std std-ref">Creation by reading</span></a>: Create field
constructs from a dataset on disk.</p></li>
</ul>
<ul class="simple">
<li><p><a class="reference internal" href="#creation-with-cfa"><span class="std std-ref">Creation with the cfa command line tool</span></a>:
Create field constructs from existing datasets on disk.</p></li>
</ul>
<p>Note that the cf package enables the creation of field constructs, but
CF-compliance is the responsibility of the user. For example, a
<code class="docutils literal notranslate"><span class="pre">units</span></code> property whose value is not a valid <a class="reference external" href="https://www.unidata.ucar.edu/software/udunits">UDUNITS</a> string is not
CF-compliant, but is allowed by the cf package.</p>
<section id="ab-initio-creation">
<span id="id61"></span><h3><a class="toc-backref" href="#id439">Ab initio creation</a><a class="headerlink" href="#ab-initio-creation" title="Permalink to this headline">¶</a></h3>
<p>Ab initio creation of a field construct has three stages:</p>
<p><strong>Stage 1:</strong> The field construct is created without metadata
constructs.</p>
<p><strong>Stage 2:</strong> Metadata constructs are created independently.</p>
<p><strong>Stage 3:</strong> The metadata constructs are inserted into the field
construct with cross-references to other, related metadata constructs
if required. For example, an auxiliary coordinate construct is related
to an ordered list of the domain axis constructs which correspond to
its data array dimensions.</p>
<p>There are two equivalent approaches to <strong>stages 1</strong> and <strong>2</strong>.</p>
<p>Either as much of the content as possible is specified during object
instantiation:</p>
<div class="literal-block-wrapper docutils container" id="id247">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct with a “standard_name”
property. Create dimension coordinate and field ancillary
constructs, both with properties and data.</em></span><a class="headerlink" href="#id247" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;precipitation_flux&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">&lt;CF Field: precipitation_flux&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">},</span>
<span class="gp">... </span>                              <span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span>
<span class="go">&lt;CF DimensionCoordinate: long_name=Longitude(3) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">FieldAncillary</span><span class="p">(</span>
<span class="gp">... </span>       <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;precipitation_flux status_flag&#39;</span><span class="p">},</span>
<span class="gp">... </span>       <span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int8&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span>
<span class="go">&lt;CF FieldAncillary: precipitation_flux status_flag(3) &gt;</span>
</pre></div>
</div>
</div>
<p>or else some or all content is added after instantiation via object
methods:</p>
<div class="literal-block-wrapper docutils container" id="id248">
<div class="code-block-caption"><span class="caption-text"><em>Create empty constructs and provide them with properties
and data after instantiation.</em></span><a class="headerlink" href="#id248" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Field</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">&lt;CF Field: &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="s1">&#39;precipitation_flux&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">&lt;CF Field: precipitation_flux&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span>
<span class="go">&lt;CF DimensionCoordinate:  &gt; # TODO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dc</span>
<span class="go">&lt;CF DimensionCoordinate: long_name=Longitude(3) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">FieldAncillary</span><span class="p">(</span>
<span class="gp">... </span>            <span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int8&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span>
<span class="go">&lt;CF FieldAncillary: (3) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="s1">&#39;precipitation_flux status_flag&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fa</span>
<span class="go">&lt;CF FieldAncillary: precipitation_flux status_flag(3) &gt;</span>
</pre></div>
</div>
</div>
<p>For <strong>stage 3</strong>, the <a class="reference internal" href="method/cf.Field.set_construct.html#cf.Field.set_construct" title="cf.Field.set_construct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_construct</span></code></a> method of the field
construct is used for setting metadata constructs and mapping data
array dimensions to domain axis constructs. The domain axis constructs
spanned by the data are inferred from the existing domain axis
constructs, provided that there are no ambiguities (such as two
dimensions of the same size), in which case they can be explicitly
provided via their construct keys. This method returns the construct
key for the metadata construct which can be used when other metadata
constructs are added to the field (e.g. to specify which domain axis
constructs correspond to a data array), or when other metadata
constructs are created (e.g. to identify the domain ancillary
constructs forming part of a coordinate reference construct):</p>
<div class="literal-block-wrapper docutils container" id="id249">
<div class="code-block-caption"><span class="caption-text"><em>Set a domain axis construct and use its construct key
when setting the dimension coordinate construct. Also
create a cell method construct that applies to the domain
axis construct.</em></span><a class="headerlink" href="#id249" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">longitude_axis</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">longitude_axis</span>
<span class="go">&#39;domainaxis0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">longitude_axis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span>
<span class="go">&#39;dimensioncoordinate0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">longitude_axis</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;minimum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
<span class="go">&#39;cellmethod0&#39;</span>
</pre></div>
</div>
</div>
<p>In general, the order in which metadata constructs are added to the
field does not matter, except when one metadata construct is required
by another, in which case the former must be added to the field first
so that its construct key is available to the latter. Cell method
constructs must, however, be set in the relative order in which their
methods were applied to the data.</p>
<p>The domain axis constructs spanned by a metadata construct’s data may
be changed after insertion with the <a class="reference internal" href="method/cf.Field.set_data_axes.html#cf.Field.set_data_axes" title="cf.Field.set_data_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_data_axes</span></code></a> method of
the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id250">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct with properties; data; and domain axis, cell method and dimension coordinate metadata constructs (data arrays have been generated with dummy values using numpy.arange).</em></span><a class="headerlink" href="#id250" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cf</span>

<span class="c1"># Initialise the field construct with properties</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;project&#39;</span><span class="p">:</span> <span class="s1">&#39;research&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;specific_humidity&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">})</span>

<span class="c1"># Create the domain axis constructs</span>
<span class="n">domain_axisT</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">domain_axisY</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">domain_axisX</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="c1"># Insert the domain axis constructs into the field. The</span>
<span class="c1"># set_construct method returns the domain axis construct key that</span>
<span class="c1"># will be used later to specify which domain axis corresponds to</span>
<span class="c1"># which dimension coordinate construct.</span>
<span class="n">axisT</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_axisT</span><span class="p">)</span>
<span class="n">axisY</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_axisY</span><span class="p">)</span>
<span class="n">axisX</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_axisX</span><span class="p">)</span>

<span class="c1"># Create and insert the field construct data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">40.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Create the cell method constructs</span>
<span class="n">cell_method1</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>

<span class="n">cell_method2</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">()</span>
<span class="n">cell_method2</span><span class="o">.</span><span class="n">set_axes</span><span class="p">(</span><span class="n">axisT</span><span class="p">)</span>
<span class="n">cell_method2</span><span class="o">.</span><span class="n">set_method</span><span class="p">(</span><span class="s1">&#39;maximum&#39;</span><span class="p">)</span>

<span class="c1"># Insert the cell method constructs into the field in the same</span>
<span class="c1"># order that their methods were applied to the data</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cell_method1</span><span class="p">)</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cell_method2</span><span class="p">)</span>

<span class="c1"># Create a &quot;time&quot; dimension coordinate construct, with coordinate</span>
<span class="c1"># bounds</span>
<span class="n">dimT</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
                            <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;days since 2018-12-01&#39;</span><span class="p">},</span>
                            <span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">15.5</span><span class="p">]),</span>
                            <span class="n">bounds</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mf">31.</span><span class="p">]])))</span>

<span class="c1"># Create a &quot;longitude&quot; dimension coordinate construct, without</span>
<span class="c1"># coordinate bounds</span>
<span class="n">dimX</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">8.</span><span class="p">)))</span>
<span class="n">dimX</span><span class="o">.</span><span class="n">set_properties</span><span class="p">({</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees_east&#39;</span><span class="p">})</span>

<span class="c1"># Create a &quot;longitude&quot; dimension coordinate construct</span>
<span class="n">dimY</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;units&#39;</span>        <span class="p">:</span> <span class="s1">&#39;degrees_north&#39;</span><span class="p">})</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">5.</span><span class="p">)</span>
<span class="n">dimY</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>

<span class="c1"># Create and insert the latitude coordinate bounds</span>
<span class="n">bounds_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">bounds_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span> <span class="o">-</span> <span class="mf">0.5</span>
<span class="n">bounds_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">bounds_array</span><span class="p">))</span>
<span class="n">dimY</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>

<span class="c1"># Insert the dimension coordinate constructs into the field,</span>
<span class="c1"># specifying to which domain axis each one corresponds</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimT</span><span class="p">)</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimY</span><span class="p">)</span>
<span class="n">Q</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimX</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id251">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new field construct.</em></span><a class="headerlink" href="#id251" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">------------------------</span>
<span class="go">Field: specific_humidity</span>
<span class="go">------------------------</span>
<span class="go">project = &#39;research&#39;</span>
<span class="go">standard_name = &#39;specific_humidity&#39;</span>
<span class="go">units = &#39;1&#39;</span>

<span class="go">Data(latitude(5), longitude(8)) = [[0.0, ..., 39.0]] 1</span>

<span class="go">Cell Method: area: mean</span>
<span class="go">Cell Method: time(1): maximum</span>

<span class="go">Domain Axis: latitude(5)</span>
<span class="go">Domain Axis: longitude(8)</span>
<span class="go">Domain Axis: time(1)</span>

<span class="go">Dimension coordinate: time</span>
<span class="go">    standard_name = &#39;time&#39;</span>
<span class="go">    units = &#39;days since 2018-12-01&#39;</span>
<span class="go">    Data(time(1)) = [2018-12-16 12:00:00]</span>
<span class="go">    Bounds:Data(time(1), 2) = [[2018-12-01 00:00:00, 2019-01-01 00:00:00]]</span>

<span class="go">Dimension coordinate: latitude</span>
<span class="go">    standard_name = &#39;latitude&#39;</span>
<span class="go">    units = &#39;degrees_north&#39;</span>
<span class="go">    Data(latitude(5)) = [0.0, ..., 4.0] degrees_north</span>
<span class="go">    Bounds:Data(latitude(5), 2) = [[-0.5, ..., 4.5]] degrees_north</span>

<span class="go">Dimension coordinate: longitude</span>
<span class="go">    standard_name = &#39;longitude&#39;</span>
<span class="go">    units = &#39;degrees_east&#39;</span>
<span class="go">    Data(longitude(8)) = [0.0, ..., 7.0] degrees_east</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Conventions</span></code> property does not need to be set because it is
automatically included in output files as a netCDF global
<code class="docutils literal notranslate"><span class="pre">Conventions</span></code> attribute, either as the CF version of the cf package
(as returned by the <a class="reference internal" href="function/cf.CF.html#cf.CF" title="cf.CF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.CF</span></code></a> function), or else specified via the
<em>Conventions</em> keyword of the <a class="reference internal" href="function/cf.write.html#cf.write" title="cf.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.write</span></code></a> function. See
<a class="reference internal" href="#writing-to-a-netcdf-dataset"><span class="std std-ref">Writing to a netCDF dataset</span></a> for details on how to specify
additional conventions.</p>
<p>If this field were to be written to a netCDF dataset then, in the
absence of predefined names, default netCDF variable and dimension
names would be automatically generated (based on standard names where
they exist). The setting of bespoke netCDF names is, however, easily
done with the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id252">
<div class="code-block-caption"><span class="caption-text"><em>Set netCDF variable and dimension names for the field
and metadata constructs.</em></span><a class="headerlink" href="#id252" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>

<span class="n">domain_axisT</span><span class="o">.</span><span class="n">nc_set_dimension</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">domain_axisY</span><span class="o">.</span><span class="n">nc_set_dimension</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
<span class="n">domain_axisX</span><span class="o">.</span><span class="n">nc_set_dimension</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>

<span class="n">dimT</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">dimY</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
<span class="n">dimX</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Here is a more complete example which creates a field construct that
contains every type of metadata construct (again, data arrays have
been generated with dummy values using <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="(in NumPy v1.24)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.arange</span></code></a>):</p>
<div class="literal-block-wrapper docutils container" id="id253">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct that contains at least one
instance of each type of metadata construct.</em></span><a class="headerlink" href="#id253" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cf</span>

<span class="c1"># Initialise the field construct</span>
<span class="n">tas</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
    <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;project&#39;</span><span class="p">:</span> <span class="s1">&#39;research&#39;</span><span class="p">,</span>
                <span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;air_temperature&#39;</span><span class="p">,</span>
                <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">})</span>

<span class="c1"># Create and set domain axis constructs</span>
<span class="n">axis_T</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">axis_Z</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">axis_Y</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">axis_X</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>

<span class="c1"># Set the field construct data</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">)))</span>

<span class="c1"># Create and set the cell method constructs</span>
<span class="n">cell_method1</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">(</span>
          <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axis_Y</span><span class="p">,</span> <span class="n">axis_X</span><span class="p">],</span>
          <span class="n">method</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span>
          <span class="n">qualifiers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;where&#39;</span><span class="p">:</span> <span class="s1">&#39;land&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;interval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;degrees&#39;</span><span class="p">)]})</span>

<span class="n">cell_method2</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">CellMethod</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axis_T</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;maximum&#39;</span><span class="p">)</span>

<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cell_method1</span><span class="p">)</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cell_method2</span><span class="p">)</span>

<span class="c1"># Create and set the field ancillary constructs</span>
<span class="n">field_ancillary</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">FieldAncillary</span><span class="p">(</span>
             <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;air_temperature standard_error&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">},</span>
             <span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">)))</span>

<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">field_ancillary</span><span class="p">)</span>

<span class="c1"># Create and set the dimension coordinate constructs</span>
<span class="n">dimension_coordinate_T</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
                           <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;days since 2018-12-01&#39;</span><span class="p">},</span>
                           <span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">15.5</span><span class="p">]),</span>
                           <span class="n">bounds</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">31</span><span class="p">]])))</span>

<span class="n">dimension_coordinate_Z</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;computed_standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;altitude&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;atmosphere_hybrid_height_coordinate&#39;</span><span class="p">},</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">1.5</span><span class="p">]),</span>
        <span class="n">bounds</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]])))</span>

<span class="n">dimension_coordinate_Y</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;grid_latitude&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees&#39;</span><span class="p">},</span>
        <span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">10.</span><span class="p">)),</span>
        <span class="n">bounds</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))))</span>

<span class="n">dimension_coordinate_X</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;grid_longitude&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees&#39;</span><span class="p">},</span>
    <span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">9.</span><span class="p">)),</span>
    <span class="n">bounds</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">))))</span>

<span class="n">dim_T</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimension_coordinate_T</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axis_T</span><span class="p">)</span>
<span class="n">dim_Z</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimension_coordinate_Z</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axis_Z</span><span class="p">)</span>
<span class="n">dim_Y</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimension_coordinate_Y</span><span class="p">)</span>
<span class="n">dim_X</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">dimension_coordinate_X</span><span class="p">)</span>

<span class="c1"># Create and set the auxiliary coordinate constructs</span>
<span class="n">auxiliary_coordinate_lat</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">AuxiliaryCoordinate</span><span class="p">(</span>
                      <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees_north&#39;</span><span class="p">},</span>
                      <span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">)))</span>

<span class="n">auxiliary_coordinate_lon</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">AuxiliaryCoordinate</span><span class="p">(</span>
                  <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees_east&#39;</span><span class="p">},</span>
                  <span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span>

<span class="n">array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcdefghij&#39;</span><span class="p">))</span>
<span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
<span class="n">auxiliary_coordinate_name</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">AuxiliaryCoordinate</span><span class="p">(</span>
                       <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Grid latitude name&#39;</span><span class="p">},</span>
                       <span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>

<span class="n">aux_LAT</span>  <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">auxiliary_coordinate_lat</span><span class="p">)</span>
<span class="n">aux_LON</span>  <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">auxiliary_coordinate_lon</span><span class="p">)</span>
<span class="n">aux_NAME</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">auxiliary_coordinate_name</span><span class="p">)</span>

<span class="c1"># Create and set domain ancillary constructs</span>
<span class="n">domain_ancillary_a</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DomainAncillary</span><span class="p">(</span>
                   <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">},</span>
                   <span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">10.</span><span class="p">]),</span>
                   <span class="n">bounds</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">]])))</span>

<span class="n">domain_ancillary_b</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DomainAncillary</span><span class="p">(</span>
                       <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">},</span>
                       <span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mf">20.</span><span class="p">]),</span>
                       <span class="n">bounds</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Bounds</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mi">14</span><span class="p">,</span> <span class="mf">26.</span><span class="p">]])))</span>

<span class="n">domain_ancillary_orog</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DomainAncillary</span><span class="p">(</span>
                          <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;surface_altitude&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">},</span>
                          <span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">)))</span>

<span class="n">domain_anc_A</span>    <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_ancillary_a</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axis_Z</span><span class="p">)</span>
<span class="n">domain_anc_B</span>    <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_ancillary_b</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axis_Z</span><span class="p">)</span>
<span class="n">domain_anc_OROG</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">domain_ancillary_orog</span><span class="p">)</span>

<span class="c1"># Create the datum for the coordinate reference constructs</span>
<span class="n">datum</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Datum</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;earth_radius&#39;</span><span class="p">:</span> <span class="mf">6371007.</span><span class="p">})</span>

<span class="c1"># Create the coordinate conversion for the horizontal coordinate</span>
<span class="c1"># reference construct</span>
<span class="n">coordinate_conversion_h</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">CoordinateConversion</span><span class="p">(</span>
              <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;grid_mapping_name&#39;</span><span class="p">:</span> <span class="s1">&#39;rotated_latitude_longitude&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;grid_north_pole_latitude&#39;</span><span class="p">:</span> <span class="mf">38.0</span><span class="p">,</span>
                          <span class="s1">&#39;grid_north_pole_longitude&#39;</span><span class="p">:</span> <span class="mf">190.0</span><span class="p">})</span>

<span class="c1"># Create the coordinate conversion for the vertical coordinate</span>
<span class="c1"># reference construct</span>
<span class="n">coordinate_conversion_v</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">CoordinateConversion</span><span class="p">(</span>
         <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;atmosphere_hybrid_height_coordinate&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;computed_standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;altitude&#39;</span><span class="p">},</span>
         <span class="n">domain_ancillaries</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">domain_anc_A</span><span class="p">,</span>
                             <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">domain_anc_B</span><span class="p">,</span>
                             <span class="s1">&#39;orog&#39;</span><span class="p">:</span> <span class="n">domain_anc_OROG</span><span class="p">})</span>

<span class="c1"># Create the vertical coordinate reference construct</span>
<span class="n">horizontal_crs</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">CoordinateReference</span><span class="p">(</span>
                   <span class="n">datum</span><span class="o">=</span><span class="n">datum</span><span class="p">,</span>
                   <span class="n">coordinate_conversion</span><span class="o">=</span><span class="n">coordinate_conversion_h</span><span class="p">,</span>
                   <span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="n">dim_X</span><span class="p">,</span>
                                <span class="n">dim_Y</span><span class="p">,</span>
                                <span class="n">aux_LAT</span><span class="p">,</span>
                                <span class="n">aux_LON</span><span class="p">])</span>

<span class="c1"># Create the vertical coordinate reference construct</span>
<span class="n">vertical_crs</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">CoordinateReference</span><span class="p">(</span>
                 <span class="n">datum</span><span class="o">=</span><span class="n">datum</span><span class="p">,</span>
                 <span class="n">coordinate_conversion</span><span class="o">=</span><span class="n">coordinate_conversion_v</span><span class="p">,</span>
                 <span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="n">dim_Z</span><span class="p">])</span>

<span class="c1"># Set the coordinate reference constructs</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">horizontal_crs</span><span class="p">)</span>
<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">vertical_crs</span><span class="p">)</span>

<span class="c1"># Create and set the cell measure constructs</span>
<span class="n">cell_measure</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">CellMeasure</span><span class="p">(</span><span class="n">measure</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">,</span>
                 <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;km2&#39;</span><span class="p">},</span>
                 <span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">90.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span>

<span class="n">tas</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cell_measure</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The new field construct may now be inspected:</p>
<div class="literal-block-wrapper docutils container" id="id254">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new field construct.</em></span><a class="headerlink" href="#id254" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tas</span><span class="p">)</span>
<span class="go">Field: air_temperature</span>
<span class="go">----------------------</span>
<span class="go">Data            : air_temperature(grid_latitude(10), grid_longitude(9)) K</span>
<span class="go">Cell methods    : grid_latitude(10): grid_longitude(9): mean where land (interval: 0.1 degrees) time(1): maximum</span>
<span class="go">Field ancils    : air_temperature standard_error(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 89.0]] K</span>
<span class="go">Dimension coords: time(1) = [2018-12-16 12:00:00]</span>
<span class="go">                : atmosphere_hybrid_height_coordinate(1) = [1.5]</span>
<span class="go">                : grid_latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : grid_longitude(9) = [0.0, ..., 8.0] degrees</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 89.0]] degrees_north</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[0.0, ..., 89.0]] degrees_east</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., j]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[0.0, ..., 89.0]] km2</span>
<span class="go">Coord references: atmosphere_hybrid_height_coordinate</span>
<span class="go">                : rotated_latitude_longitude</span>
<span class="go">Domain ancils   : key%domainancillary0(atmosphere_hybrid_height_coordinate(1)) = [10.0] m</span>
<span class="go">                : key%domainancillary1(atmosphere_hybrid_height_coordinate(1)) = [20.0] 1</span>
<span class="go">                : surface_altitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 89.0]] m</span>
</pre></div>
</div>
</div>
</section>
<section id="command-modification">
<span id="id62"></span><h3><a class="toc-backref" href="#id440">Command modification</a><a class="headerlink" href="#command-modification" title="Permalink to this headline">¶</a></h3>
<p>It is sometimes convenient to produce the commands that would create
an already existing field construct, and then modify them to create
the desired field construct. The commands are produced by the
<a class="reference internal" href="method/cf.Field.creation_commands.html#cf.Field.creation_commands" title="cf.Field.creation_commands"><code class="xref py py-obj docutils literal notranslate"><span class="pre">creation_commands</span></code></a> method of the existing field construct.</p>
<div class="literal-block-wrapper docutils container" id="id255">
<div class="code-block-caption"><span class="caption-text"><em>Produce the commands that would create an existing field
construct.</em></span><a class="headerlink" href="#id255" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">creation_commands</span><span class="p">())</span>
<span class="go"># field: specific_humidity</span>
<span class="go">f = cf.Field()</span>
<span class="go">f.set_properties({&#39;Conventions&#39;: &#39;CF-1.7&#39;, &#39;project&#39;: &#39;research&#39;, &#39;standard_name&#39;: &#39;specific_humidity&#39;, &#39;units&#39;: &#39;1&#39;})</span>
<span class="go">d = cf.Data([[0.007, 0.034, 0.003, 0.014, 0.018, 0.037, 0.024, 0.029], [0.023, 0.036, 0.045, 0.062, 0.046, 0.073, 0.006, 0.066], [0.11, 0.131, 0.124, 0.146, 0.087, 0.103, 0.057, 0.011], [0.029, 0.059, 0.039, 0.07, 0.058, 0.072, 0.009, 0.017], [0.006, 0.036, 0.019, 0.035, 0.018, 0.037, 0.034, 0.013]], units=&#39;1&#39;, dtype=&#39;f8&#39;)</span>
<span class="go">f.set_data(d)</span>
<span class="go">f.nc_set_variable(&#39;q&#39;)</span>

<span class="go"># netCDF global attributes</span>
<span class="go">f.nc_set_global_attributes({&#39;Conventions&#39;: None, &#39;project&#39;: None})</span>

<span class="go"># domain_axis: ncdim%lat</span>
<span class="go">c = cf.DomainAxis()</span>
<span class="go">c.set_size(5)</span>
<span class="go">c.nc_set_dimension(&#39;lat&#39;)</span>
<span class="go">f.set_construct(c, key=&#39;domainaxis0&#39;, copy=False)</span>

<span class="go"># domain_axis: ncdim%lon</span>
<span class="go">c = cf.DomainAxis()</span>
<span class="go">c.set_size(8)</span>
<span class="go">c.nc_set_dimension(&#39;lon&#39;)</span>
<span class="go">f.set_construct(c, key=&#39;domainaxis1&#39;, copy=False)</span>

<span class="go"># domain_axis:</span>
<span class="go">c = cf.DomainAxis()</span>
<span class="go">c.set_size(1)</span>
<span class="go">f.set_construct(c, key=&#39;domainaxis2&#39;, copy=False)</span>

<span class="go"># field data axes</span>
<span class="go">f.set_data_axes((&#39;domainaxis0&#39;, &#39;domainaxis1&#39;))</span>

<span class="go"># dimension_coordinate: latitude</span>
<span class="go">c = cf.DimensionCoordinate()</span>
<span class="go">c.set_properties({&#39;units&#39;: &#39;degrees_north&#39;, &#39;standard_name&#39;: &#39;latitude&#39;})</span>
<span class="go">d = cf.Data([-75.0, -45.0, 0.0, 45.0, 75.0], units=&#39;degrees_north&#39;, dtype=&#39;f8&#39;)</span>
<span class="go">c.set_data(d)</span>
<span class="go">c.nc_set_variable(&#39;lat&#39;)</span>
<span class="go">b = cf.Bounds()</span>
<span class="go">b.set_properties({})</span>
<span class="go">d = cf.Data([[-90.0, -60.0], [-60.0, -30.0], [-30.0, 30.0], [30.0, 60.0], [60.0, 90.0]], units=&#39;degrees_north&#39;, dtype=&#39;f8&#39;)</span>
<span class="go">b.set_data(d)</span>
<span class="go">b.nc_set_variable(&#39;lat_bnds&#39;)</span>
<span class="go">c.set_bounds(b)</span>
<span class="go">f.set_construct(c, axes=(&#39;domainaxis0&#39;,), key=&#39;dimensioncoordinate0&#39;, copy=False)</span>

<span class="go"># dimension_coordinate: longitude</span>
<span class="go">c = cf.DimensionCoordinate()</span>
<span class="go">c.set_properties({&#39;units&#39;: &#39;degrees_east&#39;, &#39;standard_name&#39;: &#39;longitude&#39;})</span>
<span class="go">d = cf.Data([22.5, 67.5, 112.5, 157.5, 202.5, 247.5, 292.5, 337.5], units=&#39;degrees_east&#39;, dtype=&#39;f8&#39;)</span>
<span class="go">c.set_data(d)</span>
<span class="go">c.nc_set_variable(&#39;lon&#39;)</span>
<span class="go">b = cf.Bounds()</span>
<span class="go">b.set_properties({})</span>
<span class="go">d = cf.Data([[0.0, 45.0], [45.0, 90.0], [90.0, 135.0], [135.0, 180.0], [180.0, 225.0], [225.0, 270.0], [270.0, 315.0], [315.0, 360.0]], units=&#39;degrees_east&#39;, dtype=&#39;f8&#39;)</span>
<span class="go">b.set_data(d)</span>
<span class="go">b.nc_set_variable(&#39;lon_bnds&#39;)</span>
<span class="go">c.set_bounds(b)</span>
<span class="go">f.set_construct(c, axes=(&#39;domainaxis1&#39;,), key=&#39;dimensioncoordinate1&#39;, copy=False)</span>

<span class="go"># dimension_coordinate: time</span>
<span class="go">c = cf.DimensionCoordinate()</span>
<span class="go">c.set_properties({&#39;units&#39;: &#39;days since 2018-12-01&#39;, &#39;standard_name&#39;: &#39;time&#39;})</span>
<span class="go">d = cf.Data([31.0], units=&#39;days since 2018-12-01&#39;, dtype=&#39;f8&#39;)</span>
<span class="go">c.set_data(d)</span>
<span class="go">c.nc_set_variable(&#39;time&#39;)</span>
<span class="go">f.set_construct(c, axes=(&#39;domainaxis2&#39;,), key=&#39;dimensioncoordinate2&#39;, copy=False)</span>

<span class="go"># cell_method</span>
<span class="go">c = cf.CellMethod()</span>
<span class="go">c.set_method(&#39;mean&#39;)</span>
<span class="go">c.set_axes((&#39;area&#39;,))</span>
<span class="go">f.set_construct(c)</span>
</pre></div>
</div>
</div>
<p>Some example fields are always available from the <a class="reference internal" href="function/cf.example_field.html#cf.example_field" title="cf.example_field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.example_field</span></code></a>
function.</p>
</section>
<section id="creating-data-from-an-array-on-disk">
<span id="id63"></span><h3><a class="toc-backref" href="#id441">Creating data from an array on disk</a><a class="headerlink" href="#creating-data-from-an-array-on-disk" title="Permalink to this headline">¶</a></h3>
<p>All the of above examples use arrays in memory to construct the data
instances for the field and metadata constructs. It is, however,
possible to create data from arrays that reside on disk. The <a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a>
function creates data in this manner. A pointer to an array in a
netCDF file can be stored in a <a class="reference internal" href="class/cf.NetCDFArray.html#cf.NetCDFArray" title="cf.NetCDFArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.NetCDFArray</span></code></a> instance, which is is
used to initialise a <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instance.</p>
<div class="literal-block-wrapper docutils container" id="id256">
<div class="code-block-caption"><span class="caption-text"><em>Define a variable from a dataset with the netCDF package
and use it to create a NetCDFArray instance with which to
initialise a Data instance.</em></span><a class="headerlink" href="#id256" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">netCDF4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nc</span> <span class="o">=</span> <span class="n">netCDF4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;ta&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">netcdf_array</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">NetCDFArray</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;file.nc&#39;</span><span class="p">,</span> <span class="n">ncvar</span><span class="o">=</span><span class="s1">&#39;ta&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">dtype</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">shape</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_disk</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">netcdf_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id257">
<div class="code-block-caption"><span class="caption-text"><em>Read the netCDF variable’s data into memory and
initialise another Data instance with it. Compare the
values of the two data instances.</em></span><a class="headerlink" href="#id257" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">numpy_array</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="o">...</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_memory</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_disk</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">data_memory</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<p>Note that data type, number of dimensions, dimension sizes and number
of elements of the array on disk that are used to initialise the
<a class="reference internal" href="class/cf.NetCDFArray.html#cf.NetCDFArray" title="cf.NetCDFArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.NetCDFArray</span></code></a> instance are those expected by the CF data model,
which may be different to those of the netCDF variable in the file
(although they are the same in the above example). For example, a
netCDF character array of shape <code class="docutils literal notranslate"><span class="pre">(12,</span> <span class="pre">9)</span></code> is viewed in cf as a
one-dimensional string array of shape <code class="docutils literal notranslate"><span class="pre">(12,)</span></code>.</p>
</section>
<section id="creation-by-conversion">
<span id="id64"></span><h3><a class="toc-backref" href="#id442">Creation by conversion</a><a class="headerlink" href="#creation-by-conversion" title="Permalink to this headline">¶</a></h3>
<p>An independent field construct may be created from an existing
metadata construct using <a class="reference internal" href="method/cf.Field.convert.html#cf.Field.convert" title="cf.Field.convert"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert</span></code></a> method of the field
construct, which identifies a unique metadata construct and returns a
new field construct based on its properties and data. The new field
construct always has domain axis constructs corresponding to the data,
and (by default) any other metadata constructs that further define its
domain.</p>
<div class="literal-block-wrapper docutils container" id="id258">
<div class="code-block-caption"><span class="caption-text"><em>Create an independent field construct from the “surface
altitude” metadata construct.</em></span><a class="headerlink" href="#id258" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">construct_key</span><span class="p">(</span><span class="s1">&#39;surface_altitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orog</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">orog</span><span class="p">)</span>
<span class="go">Field: surface_altitude</span>
<span class="go">-----------------------</span>
<span class="go">Data            : surface_altitude(grid_latitude(10), grid_longitude(9)) m</span>
<span class="go">Dimension coords: grid_latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : grid_longitude(9) = [0.0, ..., 8.0] degrees</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(10), grid_longitude(9)) = [[0.0, ..., 89.0]] degrees_north</span>
<span class="go">                : longitude(grid_longitude(9), grid_latitude(10)) = [[0.0, ..., 89.0]] degrees_east</span>
<span class="go">                : long_name=Grid latitude name(grid_latitude(10)) = [--, ..., j]</span>
<span class="go">Cell measures   : measure:area(grid_longitude(9), grid_latitude(10)) = [[0.0, ..., 89.0]] km2</span>
<span class="go">Coord references: rotated_latitude_longitude</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="method/cf.Field.convert.html#cf.Field.convert" title="cf.Field.convert"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert</span></code></a> method has an option to only include domain axis
constructs in the new field construct, with no other metadata
constructs.</p>
<div class="literal-block-wrapper docutils container" id="id259">
<div class="code-block-caption"><span class="caption-text"><em>Create an independent field construct from the “surface
altitude” metadata construct, but without a complete
domain.</em></span><a class="headerlink" href="#id259" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">orog1</span> <span class="o">=</span> <span class="n">tas</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">full_domain</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">orog1</span><span class="p">)</span>
<span class="go">Field: surface_altitude</span>
<span class="go">-----------------------</span>
<span class="go">Data            : surface_altitude(key%domainaxis2(10), key%domainaxis3(9)) m</span>
</pre></div>
</div>
</div>
</section>
<section id="creation-by-reading">
<span id="id65"></span><h3><a class="toc-backref" href="#id443">Creation by reading</a><a class="headerlink" href="#creation-by-reading" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a> function <a class="reference internal" href="#reading-datasets"><span class="std std-ref">reads a netCDF dataset</span></a> and returns the contents as a list of zero or more
field constructs, each one corresponding to a unique CF-netCDF data
variable in the dataset. For example, the field construct <code class="docutils literal notranslate"><span class="pre">tas</span></code> that
was created manually can be <a class="reference internal" href="#writing-to-a-netcdf-dataset"><span class="std std-ref">written to a netCDF dataset</span></a> and then read back into memory:</p>
<div class="literal-block-wrapper docutils container" id="id260">
<div class="code-block-caption"><span class="caption-text"><em>Write the field construct that was created manually to
disk, and then read it back into a new field construct.</em></span><a class="headerlink" href="#id260" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tas</span><span class="p">,</span> <span class="s1">&#39;tas.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;tas.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span>
<span class="go">[&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;]</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a> function also allows field constructs to be derived
directly from the netCDF variables that correspond to particular types
metadata constructs. In this case, the new field constructs will have
a domain limited to that which can be inferred from the corresponding
netCDF variable, but without the connections that are defined by the
parent netCDF data variable. This will often result in a new field
construct that has fewer metadata constructs than one created with the
<a class="reference internal" href="method/cf.Field.convert.html#cf.Field.convert" title="cf.Field.convert"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert</span></code></a> method.</p>
<div class="literal-block-wrapper docutils container" id="id261">
<div class="code-block-caption"><span class="caption-text"><em>Read the file, treating formula terms netCDF variables
(which map to domain ancillary constructs) as additional
CF-netCDF data variables.</em></span><a class="headerlink" href="#id261" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fields</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;tas.nc&#39;</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="s1">&#39;domain_ancillary&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fields</span>
<span class="go">[&lt;CF Field: ncvar%a(atmosphere_hybrid_height_coordinate(1)) m&gt;,</span>
<span class="go"> &lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;,</span>
<span class="go"> &lt;CF Field: ncvar%b(atmosphere_hybrid_height_coordinate(1)) 1&gt;,</span>
<span class="go"> &lt;CF Field: surface_altitude(grid_latitude(10), grid_longitude(9)) m&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orog_from_file</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">orog_from_file</span><span class="p">)</span>
<span class="go">Field: surface_altitude (ncvar%surface_altitude)</span>
<span class="go">------------------------------------------------</span>
<span class="go">Data            : surface_altitude(grid_latitude(10), grid_longitude(9)) m</span>
<span class="go">Dimension coords: grid_latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : grid_longitude(9) = [0.0, ..., 8.0] degrees</span>
</pre></div>
</div>
</div>
<p>Comparing the field constructs <code class="docutils literal notranslate"><span class="pre">orog_from_file</span></code> (created with
<a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a>) and <code class="docutils literal notranslate"><span class="pre">orog</span></code> (created with the <a class="reference internal" href="method/cf.Field.convert.html#cf.Field.convert" title="cf.Field.convert"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert</span></code></a> method of
the <code class="docutils literal notranslate"><span class="pre">tas</span></code> field construct), the former lacks the auxiliary
coordinate, cell measure and coordinate reference constructs of the
latter. This is because the surface altitude netCDF variable in
<code class="docutils literal notranslate"><span class="pre">tas.nc</span></code> does not have the <code class="docutils literal notranslate"><span class="pre">coordinates</span></code>, <code class="docutils literal notranslate"><span class="pre">cell_measures</span></code> nor
<code class="docutils literal notranslate"><span class="pre">grid_mapping</span></code> netCDF attributes that would link it to auxiliary
coordinate, cell measure and grid mapping netCDF variables.</p>
</section>
<section id="creation-with-cfa">
<span id="id66"></span><h3><a class="toc-backref" href="#id444">Creation with cfa</a><a class="headerlink" href="#creation-with-cfa" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">cfa</span></code> command line tool may be used to <a class="reference internal" href="#file-inspection-with-cfa"><span class="std std-ref">inspect datasets on
disk</span></a> and also to create new datasets from
them. <a class="reference internal" href="#aggregation"><span class="std std-ref">Aggregation</span></a> may be carried out within
files, or within and between files, or not used; and <a class="reference internal" href="#external-variables"><span class="std std-ref">external
variables</span></a> may be incorporated.</p>
<div class="literal-block-wrapper docutils container" id="id262">
<div class="code-block-caption"><span class="caption-text"><em>Use cfa to create new, single dataset that combines the
field constructs from two files.</em></span><a class="headerlink" href="#id262" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cfa<span class="w"> </span>file.nc
<span class="go">CF Field: specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K</span>
<span class="gp">$ </span>cfa<span class="w"> </span>air_temperature.nc
<span class="go">CF Field: air_temperature(time(2), latitude(73), longitude(96)) K</span>
<span class="gp">$ </span>cfa<span class="w"> </span>-o<span class="w"> </span>new_dataset.nc<span class="w"> </span>file.nc<span class="w"> </span>air_temperature.nc
<span class="gp">$ </span>cfa<span class="w">  </span>new_dataset.nc
<span class="go">CF Field: specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K</span>
<span class="go">CF Field: air_temperature(time(2), latitude(73), longitude(96)) K</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="copying">
<span id="id67"></span><h2><a class="toc-backref" href="#id445"><strong>Copying</strong></a><a class="headerlink" href="#copying" title="Permalink to this headline">¶</a></h2>
<p>A field construct may be copied with its <a class="reference internal" href="method/cf.Field.copy.html#cf.Field.copy" title="cf.Field.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a> method. This
produces a “deep copy”, i.e. the new field construct is completely
independent of the original field.</p>
<div class="literal-block-wrapper docutils container" id="id263">
<div class="code-block-caption"><span class="caption-text"><em>Copy a field construct and change elements of the copy,
showing that the original field construct has not been
altered.</em></span><a class="headerlink" href="#id263" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;CF Data(1, 1, 1): [[[-1e+30]]] K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;CF Data(1, 1, 1): [[[-1.0]]] K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">del_construct</span><span class="p">(</span><span class="s1">&#39;grid_latitude&#39;</span><span class="p">)</span>
<span class="go">&lt;CF DimensionCoordinate: grid_latitude(10) degrees&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;grid_latitude&#39;</span><span class="p">)</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;grid_latitude&#39;</span><span class="p">)</span>
<span class="go">{&#39;dimensioncoordinate1&#39;: &lt;CF DimensionCoordinate: grid_latitude(10) degrees&gt;}</span>
</pre></div>
</div>
</div>
<p>Equivalently, the <a class="reference external" href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy.deepcopy</span></code></a> function may be used:</p>
<div class="literal-block-wrapper docutils container" id="id264">
<div class="code-block-caption"><span class="caption-text"><em>Copy a field construct with the built-in copy module.</em></span><a class="headerlink" href="#id264" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">copy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Metadata constructs may be copied individually in the same manner:</p>
<div class="literal-block-wrapper docutils container" id="id265">
<div class="code-block-caption"><span class="caption-text"><em>Copy a metadata construct.</em></span><a class="headerlink" href="#id265" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">orog</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;surface_altitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Arrays within <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instances are copied with a <a class="reference external" href="https://en.wikipedia.org/wiki/Copy-on-write">copy-on-write</a> technique. This means
that a copy takes up very little memory, even when the original
constructs contain very large data arrays, and the copy operation is
fast.</p>
<section id="field-list-copying">
<span id="id68"></span><h3><a class="toc-backref" href="#id446">Field list copying</a><a class="headerlink" href="#field-list-copying" title="Permalink to this headline">¶</a></h3>
<p>A <a class="reference internal" href="#field-lists"><span class="std std-ref">field list</span></a> also has a <a class="reference internal" href="method/cf.FieldList.copy.html#cf.FieldList.copy" title="cf.FieldList.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a> method
that creates a new field list containing copies all of the field
construct elements.</p>
<hr class="docutils" />
</section>
</section>
<section id="equality">
<span id="id69"></span><h2><a class="toc-backref" href="#id447"><strong>Equality</strong></a><a class="headerlink" href="#equality" title="Permalink to this headline">¶</a></h2>
<p>Whether or not two field constructs are the same is tested with either
field construct’s <a class="reference internal" href="method/cf.Field.equals.html#cf.Field.equals" title="cf.Field.equals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">equals</span></code></a> method.</p>
<div class="literal-block-wrapper docutils container" id="id266">
<div class="code-block-caption"><span class="caption-text"><em>A field construct is always equal to itself, a copy of
itself and a complete subspace of itself. The “verbose”
keyword will give some (but not necessarily all) of the
reasons why two field constructs are not the same.</em></span><a class="headerlink" href="#id266" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">...</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Field: Different Units: &lt;Units: K&gt; != &lt;Units: 1&gt;</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To return specific detail about the differences between two
constructs, should they not be equal, increase the verbosity
of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">equals</span></code> method (or globally, see
<a class="reference internal" href="#controlling-output-messages"><span class="std std-ref">Controlling output messages</span></a>),
as demonstrated in an example above.</p>
<p>Otherwise, for default verbosity, only a <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>
result will be given.</p>
</div>
<p>Equality is strict by default. This means that for two field
constructs to be considered equal they must have corresponding
metadata constructs and for each pair of constructs:</p>
<ul class="simple">
<li><p>the descriptive properties must be the same (with the exception of
the field construct’s <code class="docutils literal notranslate"><span class="pre">Conventions</span></code> property, which is never
checked), and vector-valued properties must have same the size and
be element-wise equal, and</p></li>
<li><p>if there are data arrays then they must have same shape, data type
and be element-wise equal.</p></li>
</ul>
<p>Two real numbers <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are considered equal if
<span class="math notranslate nohighlight">\(|x - y| \le a_{tol} + r_{tol}|y|\)</span>, where <span class="math notranslate nohighlight">\(a_{tol}\)</span> (the
tolerance on absolute differences) and <span class="math notranslate nohighlight">\(r_{tol}\)</span> (the tolerance
on relative differences) are positive, typically very small
numbers. By default both are set to the system epsilon (the difference
between 1 and the least value greater than 1 that is representable as
a float). Their values may be inspected and changed with the
<a class="reference internal" href="function/cf.atol.html#cf.atol" title="cf.atol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.atol</span></code></a> and <a class="reference internal" href="function/cf.rtol.html#cf.rtol" title="cf.rtol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.rtol</span></code></a> functions.</p>
<p>Note that the above equation is not symmetric in <span class="math notranslate nohighlight">\(x\)</span> and
<span class="math notranslate nohighlight">\(y\)</span>, so that for two fields <code class="docutils literal notranslate"><span class="pre">f1</span></code> and <code class="docutils literal notranslate"><span class="pre">f2</span></code>, <code class="docutils literal notranslate"><span class="pre">f1.equals(f2)</span></code>
may be different from <code class="docutils literal notranslate"><span class="pre">f2.equals(f1)</span></code> in some rare cases.</p>
<div class="literal-block-wrapper docutils container" id="id267">
<div class="code-block-caption"><span class="caption-text"><em>The atol and rtol functions allow the numerical equality
tolerances to be inspected and changed.</em></span><a class="headerlink" href="#id267" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">atol</span><span class="p">())</span>
<span class="go">2.220446049250313e-16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">rtol</span><span class="p">())</span>
<span class="go">2.220446049250313e-16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">original</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">rtol</span><span class="p">(</span><span class="mf">0.00001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">rtol</span><span class="p">())</span>
<span class="go">1e-05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">rtol</span><span class="p">(</span><span class="n">original</span><span class="p">))</span>
<span class="go">1e-05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">rtol</span><span class="p">())</span>
<span class="go">2.220446049250313e-16</span>
</pre></div>
</div>
</div>
<p>The <span class="math notranslate nohighlight">\(a_{tol}\)</span> and <span class="math notranslate nohighlight">\(r_{tol}\)</span> constants may be set for a
runtime context established when executing a <code class="xref py py-obj docutils literal notranslate"><span class="pre">with</span></code> statement.</p>
<div class="literal-block-wrapper docutils container" id="id268">
<div class="code-block-caption"><span class="caption-text"><em>Evaluate equality in a runtime contenxt with a different
value of ‘atol’.</em></span><a class="headerlink" href="#id268" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">t</span> <span class="o">-</span> <span class="mf">0.00001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">cf</span><span class="o">.</span><span class="n">atol</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">t2</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<p>NetCDF elements, such as netCDF variable and dimension names, do not
constitute part of the CF data model and so are not checked on any
construct.</p>
<p>The <a class="reference internal" href="method/cf.Field.equals.html#cf.Field.equals" title="cf.Field.equals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">equals</span></code></a> method has optional parameters for modifying the
criteria for considering two fields to be equal:</p>
<ul class="simple">
<li><p>named properties may be omitted from the comparison,</p></li>
<li><p>fill value and missing data value properties may be ignored,</p></li>
<li><p>the data type of data arrays may be ignored, and</p></li>
<li><p>the tolerances on absolute and relative differences for numerical
comparisons may be temporarily changed, without changing the default
settings.</p></li>
</ul>
<p>Metadata constructs may also be tested for equality:</p>
<div class="literal-block-wrapper docutils container" id="id269">
<div class="code-block-caption"><span class="caption-text"><em>Metadata constructs also have an equals method, that
behaves in a similar manner.</em></span><a class="headerlink" href="#id269" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">orog</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;surface_altitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orog</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">orog</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<section id="field-list-equality">
<span id="id70"></span><h3><a class="toc-backref" href="#id448">Field list equality</a><a class="headerlink" href="#field-list-equality" title="Permalink to this headline">¶</a></h3>
<p>A <a class="reference internal" href="#field-lists"><span class="std std-ref">field list</span></a> also has an <a class="reference internal" href="method/cf.FieldList.equals.html#cf.FieldList.equals" title="cf.FieldList.equals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">equals</span></code></a>
method that compares two field lists. It returns <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> if and only if
field constructs at the same index are equal. This method also has an
<em>unordered</em> parameter that, when <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, treats the two field lists as
unordered collections of field constructs, i.e. in this case <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> is
returned if and only if field constructs are pair-wise equal,
irrespective of their positions in the list.</p>
<hr class="docutils" />
</section>
</section>
<section id="netcdf-interface">
<span id="id71"></span><h2><a class="toc-backref" href="#id449"><strong>NetCDF interface</strong></a><a class="headerlink" href="#netcdf-interface" title="Permalink to this headline">¶</a></h2>
<p>The logical CF data model is independent of netCDF, but the CF
conventions are designed to enable the processing and sharing of
datasets stored in netCDF files. Therefore, the cf package includes
methods for recording and editing netCDF elements that are not part of
the CF model, but are nonetheless often required to interpret and
create CF-netCDF datasets. See the section on <a class="reference external" href="https://ncas-cms.github.io/cfdm/philosophy.html#philosophy" title="(in Python cfdm package v1.10)"><span class="xref std std-ref">philosophy</span></a> for a further discussion.</p>
<p>When a netCDF dataset is read, netCDF elements (such as dimension and
variable names, and some attribute values) that do not have a place in
the CF data model are, nevertheless, stored within the appropriate
cf constructs. This allows them to be used when writing field
constructs to a new netCDF dataset, and also makes them accessible as
filters to a <a class="reference internal" href="class/cf.Constructs.html#cf.Constructs" title="cf.Constructs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Constructs</span></code></a> instance:</p>
<div class="literal-block-wrapper docutils container" id="id270">
<div class="code-block-caption"><span class="caption-text"><em>Retrieve metadata constructs based on their netCDF
names.</em></span><a class="headerlink" href="#id270" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="o">.</span><span class="n">filter_by_ncvar</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">))</span>
<span class="go">Constructs:</span>
<span class="go">{&#39;domainancillary1&#39;: &lt;CF DomainAncillary: ncvar%b(1) &gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;ncvar</span><span class="si">%x</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">&lt;CF DimensionCoordinate: grid_longitude(9) degrees&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;ncdim</span><span class="si">%x</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">&lt;CF Constructs: domain_axis(1)&gt;</span>
</pre></div>
</div>
</div>
<p>Each construct has methods to access the netCDF elements which it
requires. For example, the field construct has the following methods:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 55%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.nc_get_variable.html#cf.Field.nc_get_variable" title="cf.Field.nc_get_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_variable</span></code></a></p></td>
<td><p>Return the netCDF variable name</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.nc_set_variable.html#cf.Field.nc_set_variable" title="cf.Field.nc_set_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable</span></code></a></p></td>
<td><p>Set the netCDF variable name</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.nc_del_variable.html#cf.Field.nc_del_variable" title="cf.Field.nc_del_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_variable</span></code></a></p></td>
<td><p>Remove the netCDF variable name</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.nc_has_variable.html#cf.Field.nc_has_variable" title="cf.Field.nc_has_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_has_variable</span></code></a></p></td>
<td><p>Whether the netCDF variable name has
been set</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.nc_global_attributes.html#cf.Field.nc_global_attributes" title="cf.Field.nc_global_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_global_attributes</span></code></a></p></td>
<td><p>Return the selection of properties to
be written as netCDF global attributes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.nc_set_global_attribute.html#cf.Field.nc_set_global_attribute" title="cf.Field.nc_set_global_attribute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attribute</span></code></a></p></td>
<td><p>Set a property to be written as a
netCDF global attribute</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.nc_set_global_attributes.html#cf.Field.nc_set_global_attributes" title="cf.Field.nc_set_global_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attributes</span></code></a></p></td>
<td><p>Set properties to be written as
netCDF global attributes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.nc_clear_global_attributes.html#cf.Field.nc_clear_global_attributes" title="cf.Field.nc_clear_global_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_global_attributes</span></code></a></p></td>
<td><p>Clear the selection of properties
to be written as netCDF global
attributes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.nc_group_attributes.html#cf.Field.nc_group_attributes" title="cf.Field.nc_group_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_group_attributes</span></code></a></p></td>
<td><p>Return the selection of properties to
be written as netCDF group attributes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.nc_set_group_attribute.html#cf.Field.nc_set_group_attribute" title="cf.Field.nc_set_group_attribute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_group_attribute</span></code></a></p></td>
<td><p>Set a property to be written as a
netCDF group attribute</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.nc_set_group_attributes.html#cf.Field.nc_set_group_attributes" title="cf.Field.nc_set_group_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_group_attributes</span></code></a></p></td>
<td><p>Set properties to be written as
netCDF group attributes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.nc_clear_group_attributes.html#cf.Field.nc_clear_group_attributes" title="cf.Field.nc_clear_group_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_group_attributes</span></code></a></p></td>
<td><p>Clear the selection of properties
to be written as netCDF group
attributes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.nc_variable_groups.html#cf.Field.nc_variable_groups" title="cf.Field.nc_variable_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_variable_groups</span></code></a></p></td>
<td><p>Return the netCDF group structure</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.nc_set_variable_groups.html#cf.Field.nc_set_variable_groups" title="cf.Field.nc_set_variable_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable_groups</span></code></a></p></td>
<td><p>Set the netCDF group structure</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.nc_clear_variable_groups.html#cf.Field.nc_clear_variable_groups" title="cf.Field.nc_clear_variable_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_variable_groups</span></code></a></p></td>
<td><p>Remove the netCDF group structure</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.nc_geometry_variable_groups.html#cf.Field.nc_geometry_variable_groups" title="cf.Field.nc_geometry_variable_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_geometry_variable_groups</span></code></a></p></td>
<td><p>Return the netCDF geometry
variable ggroup structure</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.nc_set_geometry_variable_groups.html#cf.Field.nc_set_geometry_variable_groups" title="cf.Field.nc_set_geometry_variable_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_geometry_variable_groups</span></code></a></p></td>
<td><p>Set the netCDF geometry
variable group structure</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.nc_clear_geometry_variable_groups.html#cf.Field.nc_clear_geometry_variable_groups" title="cf.Field.nc_clear_geometry_variable_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_geometry_variable_groups</span></code></a></p></td>
<td><p>Remove the netCDF geometry
variable group structure</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.nc_del_component_variable.html#cf.Field.nc_del_component_variable" title="cf.Field.nc_del_component_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_component_variable</span></code></a></p></td>
<td><p>Remove the netCDF variable name for
all components of the given type.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.nc_set_component_variable.html#cf.Field.nc_set_component_variable" title="cf.Field.nc_set_component_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_variable</span></code></a></p></td>
<td><p>Set the netCDF variable name for all
components of the given type.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.nc_set_component_variable_groups.html#cf.Field.nc_set_component_variable_groups" title="cf.Field.nc_set_component_variable_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_variable_groups</span></code></a></p></td>
<td><p>Set the netCDF variable groups
hierarchy for all components of
the given type.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.nc_clear_component_variable_groups.html#cf.Field.nc_clear_component_variable_groups" title="cf.Field.nc_clear_component_variable_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_component_variable_groups</span></code></a></p></td>
<td><p>Remove the netCDF variable groups
hierarchy for all components of the
given type.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.nc_del_component_dimension.html#cf.Field.nc_del_component_dimension" title="cf.Field.nc_del_component_dimension"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_component_dimension</span></code></a></p></td>
<td><p>Remove the netCDF dimension name for
all components of the given type.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.nc_set_component_dimension.html#cf.Field.nc_set_component_dimension" title="cf.Field.nc_set_component_dimension"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_dimension</span></code></a></p></td>
<td><p>Set the netCDF dimension name for all
components of the given type.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.nc_set_component_dimension_groups.html#cf.Field.nc_set_component_dimension_groups" title="cf.Field.nc_set_component_dimension_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_dimension_groups</span></code></a></p></td>
<td><p>Set the netCDF dimension groups
hierarchy for all components of the
given type.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.nc_clear_component_dimension_groups.html#cf.Field.nc_clear_component_dimension_groups" title="cf.Field.nc_clear_component_dimension_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_component_dimension_groups</span></code></a></p></td>
<td><p>Remove the netCDF dimension groups
hierarchy for all components of the
given type.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.nc_del_component_sample_dimension.html#cf.Field.nc_del_component_sample_dimension" title="cf.Field.nc_del_component_sample_dimension"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_component_sample_dimension</span></code></a></p></td>
<td><p>Remove the netCDF sample dimension
name for all components of the given type.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.nc_set_component_sample_dimension.html#cf.Field.nc_set_component_sample_dimension" title="cf.Field.nc_set_component_sample_dimension"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_sample_dimension</span></code></a></p></td>
<td><p>Set the netCDF sample dimension name
for all components of the given type.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.nc_set_component_sample_dimension_groups.html#cf.Field.nc_set_component_sample_dimension_groups" title="cf.Field.nc_set_component_sample_dimension_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_sample_dimension_groups</span></code></a></p></td>
<td><p>Set the netCDF sample dimension
groups hierarchy for all components
of the given type.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.nc_clear_component_sample_dimension_groups.html#cf.Field.nc_clear_component_sample_dimension_groups" title="cf.Field.nc_clear_component_sample_dimension_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_component_sample_dimension_groups</span></code></a></p></td>
<td><p>Remove the netCDF sample dimension
groups hierarchy for all components
of the given type.</p></td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container" id="id271">
<div class="code-block-caption"><span class="caption-text"><em>Access netCDF elements associated with the field and
metadata constructs.</em></span><a class="headerlink" href="#id271" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;q&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: None, &#39;project&#39;: None}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_set_variable</span><span class="p">(</span><span class="s1">&#39;humidity&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;humidity&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;lat&#39;</span>
</pre></div>
</div>
</div>
<p>The complete collection of netCDF interface methods is:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 37%" />
<col style="width: 32%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Classes</p></th>
<th class="head"><p>NetCDF element</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_variable</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cf.DimensionCoordinate.html#cf.DimensionCoordinate" title="cf.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cf.AuxiliaryCoordinate.html#cf.AuxiliaryCoordinate" title="cf.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cf.CellMeasure.html#cf.CellMeasure" title="cf.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cf.DomainAncillary.html#cf.DomainAncillary" title="cf.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cf.FieldAncillary.html#cf.FieldAncillary" title="cf.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cf.CoordinateReference.html#cf.CoordinateReference" title="cf.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>,  <a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cf.Datum.html#cf.Datum" title="cf.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datum</span></code></a>, <a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cf.List.html#cf.List" title="cf.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></p></td>
<td><p>Variable name</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_variable</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cf.DimensionCoordinate.html#cf.DimensionCoordinate" title="cf.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cf.AuxiliaryCoordinate.html#cf.AuxiliaryCoordinate" title="cf.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cf.CellMeasure.html#cf.CellMeasure" title="cf.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cf.DomainAncillary.html#cf.DomainAncillary" title="cf.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cf.FieldAncillary.html#cf.FieldAncillary" title="cf.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cf.CoordinateReference.html#cf.CoordinateReference" title="cf.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cf.Datum.html#cf.Datum" title="cf.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datum</span></code></a>, <a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cf.List.html#cf.List" title="cf.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></p></td>
<td><p>Variable name</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_has_variable</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cf.DimensionCoordinate.html#cf.DimensionCoordinate" title="cf.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cf.AuxiliaryCoordinate.html#cf.AuxiliaryCoordinate" title="cf.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cf.CellMeasure.html#cf.CellMeasure" title="cf.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cf.DomainAncillary.html#cf.DomainAncillary" title="cf.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cf.FieldAncillary.html#cf.FieldAncillary" title="cf.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cf.CoordinateReference.html#cf.CoordinateReference" title="cf.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cf.Datum.html#cf.Datum" title="cf.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datum</span></code></a>, <a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cf.List.html#cf.List" title="cf.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></p></td>
<td><p>Variable name</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cf.DimensionCoordinate.html#cf.DimensionCoordinate" title="cf.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cf.AuxiliaryCoordinate.html#cf.AuxiliaryCoordinate" title="cf.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cf.CellMeasure.html#cf.CellMeasure" title="cf.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cf.DomainAncillary.html#cf.DomainAncillary" title="cf.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cf.FieldAncillary.html#cf.FieldAncillary" title="cf.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cf.CoordinateReference.html#cf.CoordinateReference" title="cf.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cf.Datum.html#cf.Datum" title="cf.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datum</span></code></a>, <a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cf.List.html#cf.List" title="cf.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></p></td>
<td><p>Variable name</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cf.DimensionCoordinate.html#cf.DimensionCoordinate" title="cf.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cf.AuxiliaryCoordinate.html#cf.AuxiliaryCoordinate" title="cf.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cf.CellMeasure.html#cf.CellMeasure" title="cf.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cf.DomainAncillary.html#cf.DomainAncillary" title="cf.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cf.FieldAncillary.html#cf.FieldAncillary" title="cf.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cf.CoordinateReference.html#cf.CoordinateReference" title="cf.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cf.Datum.html#cf.Datum" title="cf.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datum</span></code></a>, <a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cf.List.html#cf.List" title="cf.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cf.DimensionCoordinate.html#cf.DimensionCoordinate" title="cf.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cf.AuxiliaryCoordinate.html#cf.AuxiliaryCoordinate" title="cf.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cf.CellMeasure.html#cf.CellMeasure" title="cf.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cf.DomainAncillary.html#cf.DomainAncillary" title="cf.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cf.FieldAncillary.html#cf.FieldAncillary" title="cf.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cf.CoordinateReference.html#cf.CoordinateReference" title="cf.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cf.Datum.html#cf.Datum" title="cf.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datum</span></code></a>, <a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cf.List.html#cf.List" title="cf.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a>, <a class="reference internal" href="class/cf.DimensionCoordinate.html#cf.DimensionCoordinate" title="cf.DimensionCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DimensionCoordinate</span></code></a>,
<a class="reference internal" href="class/cf.AuxiliaryCoordinate.html#cf.AuxiliaryCoordinate" title="cf.AuxiliaryCoordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AuxiliaryCoordinate</span></code></a>, <a class="reference internal" href="class/cf.CellMeasure.html#cf.CellMeasure" title="cf.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a>,
<a class="reference internal" href="class/cf.DomainAncillary.html#cf.DomainAncillary" title="cf.DomainAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAncillary</span></code></a>, <a class="reference internal" href="class/cf.FieldAncillary.html#cf.FieldAncillary" title="cf.FieldAncillary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FieldAncillary</span></code></a>,
<a class="reference internal" href="class/cf.CoordinateReference.html#cf.CoordinateReference" title="cf.CoordinateReference"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordinateReference</span></code></a>, <a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>,
<a class="reference internal" href="class/cf.Datum.html#cf.Datum" title="cf.Datum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datum</span></code></a>, <a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="class/cf.List.html#cf.List" title="cf.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.DomainAxis.html#cf.DomainAxis" title="cf.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>, <a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>,
<a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Dimension name</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.DomainAxis.html#cf.DomainAxis" title="cf.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>, <a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>,
<a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Dimension name</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_has_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.DomainAxis.html#cf.DomainAxis" title="cf.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>, <a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>,
<a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Dimension name</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.DomainAxis.html#cf.DomainAxis" title="cf.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>, <a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>,
<a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Dimension name</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.DomainAxis.html#cf.DomainAxis" title="cf.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>, <a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>,
<a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.DomainAxis.html#cf.DomainAxis" title="cf.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>, <a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>,
<a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.DomainAxis.html#cf.DomainAxis" title="cf.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a>, <a class="reference internal" href="class/cf.Bounds.html#cf.Bounds" title="cf.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a>, <a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>,
<a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_is_unlimited</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.DomainAxis.html#cf.DomainAxis" title="cf.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a></p></td>
<td><p>Unlimited dimension</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_unlimited</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.DomainAxis.html#cf.DomainAxis" title="cf.DomainAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DomainAxis</span></code></a></p></td>
<td><p>Unlimited dimension</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_global_attributes</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Global attributes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attribute</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Global attributes</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attributes</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Global attributes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_global_attributes</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Global attributes</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_geometry_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_geometry_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_geometry_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_group_attributes</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group attributes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_group_attribute</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group attributes</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_group_attributes</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group attributes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_group_attributes</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Group attributes</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_component_variable</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_variable</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_component_variable_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_component_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_component_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_component_sample_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_sample_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_component_sample_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_component_sample_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></p></td>
<td><p>Component common netCDF properties</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_external</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.CellMeasure.html#cf.CellMeasure" title="cf.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a></p></td>
<td><p>External variable status</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_external</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.CellMeasure.html#cf.CellMeasure" title="cf.CellMeasure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellMeasure</span></code></a></p></td>
<td><p>External variable status</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_del_sample_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Sample dimension name</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_get_sample_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Sample dimension name</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_has_sample_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Sample dimension name</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_sample_dimension</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a>, <a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>Sample dimension name</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_sample_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_sample_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_clear_sample_dimension_groups</span></code></p></td>
<td><p><a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Count</span></code></a></p></td>
<td><p>Group hierarchy</p></td>
</tr>
</tbody>
</table>
<hr class="docutils" />
</section>
<section id="writing-to-a-netcdf-dataset">
<span id="id72"></span><h2><a class="toc-backref" href="#id450"><strong>Writing to a netCDF dataset</strong></a><a class="headerlink" href="#writing-to-a-netcdf-dataset" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="function/cf.write.html#cf.write" title="cf.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.write</span></code></a> function writes a field construct, or a sequence of
field constructs, to a new netCDF file on disk:</p>
<div class="literal-block-wrapper docutils container" id="id272">
<div class="code-block-caption"><span class="caption-text"><em>Write a field construct to a netCDF dataset on disk.</em></span><a class="headerlink" href="#id272" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%humidity)</span>
<span class="go">-----------------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s1">&#39;q_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The new dataset is structured as follows:</p>
<div class="literal-block-wrapper docutils container" id="id273">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new dataset with the ncdump command line
tool.</em></span><a class="headerlink" href="#id273" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ncdump<span class="w"> </span>-h<span class="w"> </span>q_file.nc
<span class="go">netcdf q_file {</span>
<span class="go">dimensions:</span>
<span class="go">     lat = 5 ;</span>
<span class="go">     bounds2 = 2 ;</span>
<span class="go">     lon = 8 ;</span>
<span class="go">variables:</span>
<span class="go">     double lat_bnds(lat, bounds2) ;</span>
<span class="go">     double lat(lat) ;</span>
<span class="go">             lat:units = &quot;degrees_north&quot; ;</span>
<span class="go">             lat:standard_name = &quot;latitude&quot; ;</span>
<span class="go">             lat:bounds = &quot;lat_bnds&quot; ;</span>
<span class="go">     double lon_bnds(lon, bounds2) ;</span>
<span class="go">     double lon(lon) ;</span>
<span class="go">             lon:units = &quot;degrees_east&quot; ;</span>
<span class="go">             lon:standard_name = &quot;longitude&quot; ;</span>
<span class="go">             lon:bounds = &quot;lon_bnds&quot; ;</span>
<span class="go">     double time ;</span>
<span class="go">             time:units = &quot;days since 2018-12-01&quot; ;</span>
<span class="go">             time:standard_name = &quot;time&quot; ;</span>
<span class="go">     double humidity(lat, lon) ;</span>
<span class="go">             humidity:standard_name = &quot;specific_humidity&quot; ;</span>
<span class="go">             humidity:cell_methods = &quot;area: mean&quot; ;</span>
<span class="go">             humidity:units = &quot;1&quot; ;</span>
<span class="go">             humidity:coordinates = &quot;time&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">             :Conventions = &quot;CF-1.7&quot; ;</span>
<span class="go">             :project = &quot;research&quot; ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<p>Note that netCDF is the only available output file format.</p>
<p>A sequence of field constructs is written in exactly the same way:</p>
<div class="literal-block-wrapper docutils container" id="id274">
<div class="code-block-caption"><span class="caption-text"><em>Write multiple field constructs to a netCDF dataset on
disk.</em></span><a class="headerlink" href="#id274" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">[&lt;CF Field: specific_humidity(latitude(5), longitude(8)) 1&gt;,</span>
<span class="go"> &lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;new_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>By default the output file will be for CF-1.10.</p>
<p>The <a class="reference internal" href="function/cf.write.html#cf.write" title="cf.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.write</span></code></a> function has optional parameters to</p>
<ul class="simple">
<li><p>set the output netCDF format (all netCDF3 and netCDF4 formats are
possible);</p></li>
<li><p>append to the netCDF file rather than over-writing it by default;</p></li>
<li><p>specify which field construct properties should become netCDF data
variable attributes and which should become netCDF global
attributes;</p></li>
<li><p>set extra netCDF global attributes;</p></li>
<li><p>create <a class="reference internal" href="#external-variables"><span class="std std-ref">external variables</span></a> in an external
file;</p></li>
<li><p>specify the version of the CF conventions (from CF-1.6 up to
CF-1.10), and of any other conventions that the file adheres
to;</p></li>
<li><p>change the data type of output data arrays;</p></li>
<li><p>apply netCDF compression and packing; and</p></li>
<li><p>set the endian-ness of the output data.</p></li>
</ul>
<p>For example, to use the <code class="xref py py-obj docutils literal notranslate"><span class="pre">mode</span></code> parameter to append a new field, or fields,
to a netCDF file whilst preserving the field or fields already contained
in that file:</p>
<div class="literal-block-wrapper docutils container" id="id275">
<div class="code-block-caption"><span class="caption-text"><em>Append field constructs to a netCDF dataset on
disk.</em></span><a class="headerlink" href="#id275" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">example_field</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;append-example-file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;append-example-file.nc&#39;</span><span class="p">)</span>
<span class="go">[&lt;CF Field: air_potential_temperature(time(36), latitude(5), longitude(8)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">example_field</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span>
<span class="go">&lt;CF Field: specific_humidity(latitude(5), longitude(8)) 1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="s1">&#39;append-example-file.nc&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;append-example-file.nc&#39;</span><span class="p">)</span>
<span class="go">[&lt;CF Field: air_potential_temperature(time(36), latitude(5), longitude(8)) K&gt;,</span>
<span class="go"> &lt;CF Field: specific_humidity(latitude(5), longitude(8)) 1&gt;]</span>
</pre></div>
</div>
</div>
<p>Output netCDF variable and dimension names read from a netCDF dataset
are stored in the resulting field constructs, and may also be set
manually with the <a class="reference internal" href="method/cf.Field.nc_set_variable.html#cf.Field.nc_set_variable" title="cf.Field.nc_set_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_variable</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_dimension</span></code>
and <code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_sample_dimension</span></code> methods. If a name has not been
set then one will be generated internally (usually based on the
standard name if it exists).</p>
<p>It is possible to create netCDF unlimited dimensions using the
<a class="reference internal" href="method/cf.DomainAxis.nc_set_unlimited.html#cf.DomainAxis.nc_set_unlimited" title="cf.DomainAxis.nc_set_unlimited"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_unlimited</span></code></a> method of the domain axis construct.</p>
<p>A field construct is not transformed through being written to a file
on disk and subsequently read back from that file.</p>
<div class="literal-block-wrapper docutils container" id="id276">
<div class="code-block-caption"><span class="caption-text"><em>Read a file that has been created by writing a field
construct, and compare the result with the original field
construct in memory.</em></span><a class="headerlink" href="#id276" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;q_file.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<section id="global-attributes">
<span id="id73"></span><h3><a class="toc-backref" href="#id451">Global attributes</a><a class="headerlink" href="#global-attributes" title="Permalink to this headline">¶</a></h3>
<p>The field construct properties that correspond to the standardised
description-of-file-contents attributes are automatically written as
netCDF global attributes. Other attributes may also be written as
netCDF global attributes if they have been identified as such with the
<em>global_attributes</em> keyword, or via the
<a class="reference internal" href="method/cf.Field.nc_set_global_attribute.html#cf.Field.nc_set_global_attribute" title="cf.Field.nc_set_global_attribute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attribute</span></code></a> or <a class="reference internal" href="method/cf.Field.nc_set_global_attributes.html#cf.Field.nc_set_global_attributes" title="cf.Field.nc_set_global_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attributes</span></code></a>
methods of the field constructs. In either case, the creation of a
netCDF global attribute depends on the corresponding property values
being identical across all of the field constructs being written to
the file. If they are all equal then the property will be written as a
netCDF global attribute and not as an attribute of any netCDF data
variable; if any differ then the property is written only to each
netCDF data variable.</p>
<div class="literal-block-wrapper docutils container" id="id277">
<div class="code-block-caption"><span class="caption-text"><em>Request that the “model” property is written as a netCDF
global attribute, using the “global_attributes” keyword.</em></span><a class="headerlink" href="#id277" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="s1">&#39;model_A&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;f_file.nc&#39;</span><span class="p">,</span> <span class="n">global_attributes</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id278">
<div class="code-block-caption"><span class="caption-text"><em>Request that the “model” property is written as a netCDF
global attribute, using the “nc_set_global_attribute”
method.</em></span><a class="headerlink" href="#id278" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: None, &#39;project&#39;: None}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">nc_set_global_attribute</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: None, &#39;project&#39;: None, &#39;model&#39;: None}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;f_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>It is possible to create both a netCDF global attribute and a netCDF
data variable attribute with the same name, but with different
values. This may be done by assigning the global value to the property
name with the <a class="reference internal" href="method/cf.Field.nc_set_global_attribute.html#cf.Field.nc_set_global_attribute" title="cf.Field.nc_set_global_attribute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attribute</span></code></a> or
<a class="reference internal" href="method/cf.Field.nc_set_global_attributes.html#cf.Field.nc_set_global_attributes" title="cf.Field.nc_set_global_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_global_attributes</span></code></a> method, or by via the
<em>file_descriptors</em> keyword. For the former technique, any
inconsistencies arising from multiple field constructs being written
to the same file will be resolved by omitting the netCDF global
attribute from the file.</p>
<div class="literal-block-wrapper docutils container" id="id279">
<div class="code-block-caption"><span class="caption-text"><em>Request that the “information” property is written as
netCDF global and data variable attributes, with
different values, using the “nc_set_global_attribute”
method.</em></span><a class="headerlink" href="#id279" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;information&#39;</span><span class="p">,</span> <span class="s1">&#39;variable information&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.7&#39;,</span>
<span class="go"> &#39;information&#39;: &#39;variable information&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;specific_humidity&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;1&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">nc_set_global_attribute</span><span class="p">(</span><span class="s1">&#39;information&#39;</span><span class="p">,</span> <span class="s1">&#39;global information&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: None,</span>
<span class="go">&#39;information&#39;: &#39;global information&#39;,</span>
<span class="go"> &#39;model&#39;: None,</span>
<span class="go"> &#39;project&#39;: None}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;f_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>NetCDF global attributes defined with the <em>file_descriptors</em> keyword
of the <a class="reference internal" href="function/cf.write.html#cf.write" title="cf.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.write</span></code></a> function will always be written as requested,
independently of the netCDF data variable attributes, and superseding
any global attributes that may have been defined with the
<em>global_attributes</em> keyword, or set on the individual field
constructs.</p>
<div class="literal-block-wrapper docutils container" id="id280">
<div class="code-block-caption"><span class="caption-text"><em>Insist that the “history” property is written as netCDF
a global attribute, with the “file_descriptors” keyword.</em></span><a class="headerlink" href="#id280" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;f_file.nc&#39;</span><span class="p">,</span> <span class="n">file_descriptors</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;history&#39;</span><span class="p">:</span> <span class="s1">&#39;created in 2019&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_file</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;f_file.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_file</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_file</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: &#39;CF-1.7&#39;,</span>
<span class="go"> &#39;history&#39;: &#39;created in 2019&#39;,</span>
<span class="go"> &#39;information&#39;: &#39;variable information&#39;,</span>
<span class="go"> &#39;model&#39;: &#39;model_A&#39;,</span>
<span class="go"> &#39;project&#39;: &#39;research&#39;,</span>
<span class="go"> &#39;standard_name&#39;: &#39;specific_humidity&#39;,</span>
<span class="go"> &#39;units&#39;: &#39;1&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_file</span><span class="o">.</span><span class="n">nc_global_attributes</span><span class="p">()</span>
<span class="go">{&#39;Conventions&#39;: None,</span>
<span class="go"> &#39;history&#39;: None,</span>
<span class="go"> &#39;information&#39;: &#39;global information&#39;,</span>
<span class="go"> &#39;project&#39;: None}</span>
</pre></div>
</div>
</div>
</section>
<section id="conventions">
<span id="id74"></span><h3><a class="toc-backref" href="#id452">Conventions</a><a class="headerlink" href="#conventions" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Conventions</span></code> netCDF global attribute containing the version of
the CF conventions is always automatically created. If the version of
the CF conventions has been set as a field property, or with the
<em>Conventions</em> keyword of the <a class="reference internal" href="function/cf.write.html#cf.write" title="cf.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.write</span></code></a> function, then it is
ignored. However, other conventions that may apply can be set with
either technique.</p>
<div class="literal-block-wrapper docutils container" id="id281">
<div class="code-block-caption"><span class="caption-text"><em>Two ways to add additional conventions to the
“Conventions” netCDF global attribute.</em></span><a class="headerlink" href="#id281" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f_file</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;Conventions&#39;</span><span class="p">,</span> <span class="s1">&#39;UGRID1.0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;f_file.nc&#39;</span><span class="p">,</span> <span class="n">Conventions</span><span class="o">=</span><span class="s1">&#39;UGRID1.0&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="scalar-coordinate-variables">
<span id="id75"></span><h3><a class="toc-backref" href="#id453">Scalar coordinate variables</a><a class="headerlink" href="#scalar-coordinate-variables" title="Permalink to this headline">¶</a></h3>
<p>A CF-netCDF scalar (i.e. zero-dimensional) coordinate variable is
created from a size one dimension coordinate construct that spans a
domain axis construct which is not spanned by the field construct’s
data, nor the data of any other metadata construct. This occurs for
the field construct <code class="docutils literal notranslate"><span class="pre">q</span></code>, for which the “time” dimension coordinate
construct was to the file <code class="docutils literal notranslate"><span class="pre">q_file.nc</span></code> as a scalar coordinate
variable.</p>
<p>To change this so that the “time” dimension coordinate construct is
written as a CF-netCDF size one coordinate variable, the field
construct’s data must be expanded to span the corresponding size one
domain axis construct, by using the <a class="reference internal" href="method/cf.Field.insert_dimension.html#cf.Field.insert_dimension" title="cf.Field.insert_dimension"><code class="xref py py-obj docutils literal notranslate"><span class="pre">insert_dimension</span></code></a> method
of the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id282">
<div class="code-block-caption"><span class="caption-text"><em>Write the “time” dimension coordinate construct to a
(non-scalar) CF-netCDF coordinate variable by inserting
the corresponding dimension into the field construct’s
data.</em></span><a class="headerlink" href="#id282" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%humidity)</span>
<span class="go">-----------------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="go">&lt;CF Field: specific_humidity(latitude(5), longitude(8)) 1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">construct_key</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axes</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">get_data_axes</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axes</span>
<span class="go">(&#39;domainaxis2&#39;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">insert_dimension</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span>
<span class="go">&lt;CF Field: specific_humidity(time(1), latitude(5), longitude(8)) 1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">q2</span><span class="p">,</span> <span class="s1">&#39;q2_file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The new dataset is structured as follows (note, relative to file
<code class="docutils literal notranslate"><span class="pre">q_file.nc</span></code>, the existence of the “time” dimension and the lack of a
“coordinates” attribute on the, now three-dimensional, data variable):</p>
<div class="literal-block-wrapper docutils container" id="id283">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new dataset with the ncdump command line
tool.</em></span><a class="headerlink" href="#id283" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ncdump<span class="w"> </span>-h<span class="w"> </span>q2_file.nc
<span class="go">netcdf q2_file {</span>
<span class="go">dimensions:</span>
<span class="go">     lat = 5 ;</span>
<span class="go">     bounds2 = 2 ;</span>
<span class="go">     lon = 8 ;</span>
<span class="go">     time = 1 ;</span>
<span class="go">variables:</span>
<span class="go">     double lat_bnds(lat, bounds2) ;</span>
<span class="go">     double lat(lat) ;</span>
<span class="go">             lat:units = &quot;degrees_north&quot; ;</span>
<span class="go">             lat:standard_name = &quot;latitude&quot; ;</span>
<span class="go">             lat:bounds = &quot;lat_bnds&quot; ;</span>
<span class="go">     double lon_bnds(lon, bounds2) ;</span>
<span class="go">     double lon(lon) ;</span>
<span class="go">             lon:units = &quot;degrees_east&quot; ;</span>
<span class="go">             lon:standard_name = &quot;longitude&quot; ;</span>
<span class="go">             lon:bounds = &quot;lon_bnds&quot; ;</span>
<span class="go">     double time(time) ;</span>
<span class="go">             time:units = &quot;days since 2018-12-01&quot; ;</span>
<span class="go">             time:standard_name = &quot;time&quot; ;</span>
<span class="go">     double humidity(time, lat, lon) ;</span>
<span class="go">             humidity:units = &quot;1&quot; ;</span>
<span class="go">             humidity:standard_name = &quot;specific_humidity&quot; ;</span>
<span class="go">             humidity:cell_methods = &quot;area: mean&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">             :Conventions = &quot;CF-1.7&quot; ;</span>
<span class="go">             :project = &quot;research&quot; ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
</section>
<section id="strings">
<span id="id76"></span><h3><a class="toc-backref" href="#id454">Strings</a><a class="headerlink" href="#strings" title="Permalink to this headline">¶</a></h3>
<p>String-valued data may be written to netCDF files either as netCDF
character arrays with a trailing dimension large enough to contain the
longest value, or as netCDF4 string arrays. The former is allowed for
all formats of netCDF3 and netCDF4 format files; but string arrays may
only be written to netCDF4 format files (note that string arrays can
not be written to netCDF4 classic format files).</p>
<p>By default, netCDF string arrays will be created whenever possible,
and in all other cases netCDF character arrays will be
used. Alternatively, netCDF character arrays can be used in all cases
by setting the <em>string</em> keyword of the <a class="reference internal" href="function/cf.write.html#cf.write" title="cf.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.write</span></code></a> function.</p>
</section>
<section id="groups">
<h3><a class="toc-backref" href="#id455">Groups</a><a class="headerlink" href="#groups" title="Permalink to this headline">¶</a></h3>
<p>NetCDF4 files with hierarchical groups may be created if a group
structure is defined by the netCDF variable and dimension names,
accessed via the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>.  See the
section on <a class="reference internal" href="#hierarchical-groups"><span class="std std-ref">hierarchical groups</span></a> for
details.</p>
<hr class="docutils" />
</section>
</section>
<section id="hierarchical-groups">
<span id="id77"></span><h2><a class="toc-backref" href="#id456"><strong>Hierarchical groups</strong></a><a class="headerlink" href="#hierarchical-groups" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#groups">Hierarchical groups</a> provide a mechanism to structure variables
within netCDF4 datasets, with well defined rules for resolving
references to out-of-group netCDF variables and dimensions.</p>
<p>A group structure that may be applied when writing to disk can be
created ab initio with the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>. For example, the data variable and a coordinate
construct may be moved to a sub-group that has its own group
attribute, and a coordinate construct may be moved to a different
sub-group:</p>
<div class="literal-block-wrapper docutils container" id="id284">
<div class="code-block-caption"><span class="caption-text"><em>Create a group structure and write it to disk.</em></span><a class="headerlink" href="#id284" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%/forecast/model/q)</span>
<span class="go">--------------------------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;comment&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_set_group_attribute</span><span class="p">(</span><span class="s1">&#39;comment&#39;</span><span class="p">,</span> <span class="s1">&#39;group comment&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">nc_set_variable_groups</span><span class="p">([</span><span class="s1">&#39;forecast&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">])</span>
<span class="go">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">nc_set_variable_groups</span><span class="p">([</span><span class="s1">&#39;forecast&#39;</span><span class="p">])</span>
<span class="go">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s1">&#39;grouped.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id285">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new grouped dataset with the ncdump command
line tool.</em></span><a class="headerlink" href="#id285" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ncdump<span class="w"> </span>-h<span class="w"> </span>grouped.nc
<span class="go">netcdf grouped {</span>
<span class="go">dimensions:</span>
<span class="go">        lat = 5 ;</span>
<span class="go">        bounds2 = 2 ;</span>
<span class="go">        lon = 8 ;</span>
<span class="go">variables:</span>
<span class="go">        double lat_bnds(lat, bounds2) ;</span>
<span class="go">        double lat(lat) ;</span>
<span class="go">                lat:units = &quot;degrees_north&quot; ;</span>
<span class="go">                lat:standard_name = &quot;latitude&quot; ;</span>
<span class="go">                lat:bounds = &quot;lat_bnds&quot; ;</span>
<span class="go">        double lon_bnds(lon, bounds2) ;</span>
<span class="go">        double lon(lon) ;</span>
<span class="go">                lon:units = &quot;degrees_east&quot; ;</span>
<span class="go">                lon:standard_name = &quot;longitude&quot; ;</span>
<span class="go">                lon:bounds = &quot;lon_bnds&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">                :Conventions = &quot;CF-1.8&quot; ;</span>
<span class="go">                :comment = &quot;comment&quot; ;</span>

<span class="go">group: forecast {</span>
<span class="go">  variables:</span>
<span class="go">        double time ;</span>
<span class="go">                time:units = &quot;days since 2018-12-01&quot; ;</span>
<span class="go">                time:standard_name = &quot;time&quot; ;</span>

<span class="go">  group: model {</span>
<span class="go">    variables:</span>
<span class="go">        double q(lat, lon) ;</span>
<span class="go">                q:project = &quot;research&quot; ;</span>
<span class="go">                q:standard_name = &quot;specific_humidity&quot; ;</span>
<span class="go">                q:units = &quot;1&quot; ;</span>
<span class="go">                q:coordinates = &quot;time&quot; ;</span>
<span class="go">                q:cell_methods = &quot;area: mean&quot; ;</span>

<span class="go">    // group attributes:</span>
<span class="go">                :comment = &quot;group comment&quot; ;</span>
<span class="go">    } // group model</span>
<span class="go">  } // group forecast</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<p>When reading a netCDF dataset, the group structure and groups
attributes are recorded and are made accessible via the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF
interface</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id286">
<div class="code-block-caption"><span class="caption-text"><em>Read the grouped file and inspect its group structure.</em></span><a class="headerlink" href="#id286" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;grouped.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%/forecast/q)</span>
<span class="go">--------------------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;/forecast/model/q&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">nc_variable_groups</span><span class="p">()</span>
<span class="go">(&#39;forecast&#39;, &#39;model&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">nc_group_attributes</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">{&#39;comment&#39;: &#39;group comment&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;lat&#39;</span>
</pre></div>
</div>
</div>
<p>By default field constructs are written out to a dataset with their
groups struct (if any) intact. It is always possible, however, to
create a “flat” dataset, i.e. one without any sub-groups. This does
not require the removal of the group structure from the field
construct and all of its components (although that is possible), as it
can be done by simply by overriding the existing group structure by
setting the <em>group</em> keyword to <a class="reference internal" href="function/cf.write.html#cf.write" title="cf.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.write</span></code></a> to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p>
<div class="literal-block-wrapper docutils container" id="id287">
<div class="code-block-caption"><span class="caption-text"><em>Write the field construct to a file with the same group
structure, and also to a flat file.</em></span><a class="headerlink" href="#id287" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;flat.nc&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>NetCDF variables in the flattened output file will inherit any netCDF
group attributes, providing that they are not superseded by variable
attributes. The output netCDF variable and dimension names will be
taken as the basenames of any that have been pre-defined. This is the
case in file <code class="docutils literal notranslate"><span class="pre">flat.nc</span></code>, for which the netCDF variable <code class="docutils literal notranslate"><span class="pre">q</span></code> has
inherited the <code class="docutils literal notranslate"><span class="pre">comment</span></code> attribute that was originally set on the
<code class="docutils literal notranslate"><span class="pre">/forecast/model</span></code> group. NetCDF group attributes may be set and
accessed via the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>, for both
netCDF variable and netCDF dimensions.</p>
<div class="literal-block-wrapper docutils container" id="id288">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the flat version of the dataset with the ncdump
command line tool.</em></span><a class="headerlink" href="#id288" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ncdump<span class="w"> </span>-h<span class="w"> </span>flat_out.nc
<span class="go">netcdf flat {</span>
<span class="go">dimensions:</span>
<span class="go">        lat = 5 ;</span>
<span class="go">        bounds2 = 2 ;</span>
<span class="go">        lon = 8 ;</span>
<span class="go">variables:</span>
<span class="go">        double lat_bnds(lat, bounds2) ;</span>
<span class="go">        double lat(lat) ;</span>
<span class="go">                lat:units = &quot;degrees_north&quot; ;</span>
<span class="go">                lat:standard_name = &quot;latitude&quot; ;</span>
<span class="go">                lat:bounds = &quot;lat_bnds&quot; ;</span>
<span class="go">        double lon_bnds(lon, bounds2) ;</span>
<span class="go">        double lon(lon) ;</span>
<span class="go">                lon:units = &quot;degrees_east&quot; ;</span>
<span class="go">                lon:standard_name = &quot;longitude&quot; ;</span>
<span class="go">                lon:bounds = &quot;lon_bnds&quot; ;</span>
<span class="go">        double time ;</span>
<span class="go">                time:units = &quot;days since 2018-12-01&quot; ;</span>
<span class="go">                time:standard_name = &quot;time&quot; ;</span>
<span class="go">        double q(lat, lon) ;</span>
<span class="go">                q:comment = &quot;group comment&quot; ;</span>
<span class="go">                q:project = &quot;research&quot; ;</span>
<span class="go">                q:standard_name = &quot;specific_humidity&quot; ;</span>
<span class="go">                q:units = &quot;1&quot; ;</span>
<span class="go">                q:coordinates = &quot;time&quot; ;</span>
<span class="go">                q:cell_methods = &quot;area: mean&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">                :Conventions = &quot;CF-1.8&quot; ;</span>
<span class="go">                :comment = &quot;comment&quot; ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<p>The fields constructs read from a grouped file are identical to those
read from the flat version of the file:</p>
<div class="literal-block-wrapper docutils container" id="id289">
<div class="code-block-caption"><span class="caption-text"><em>Demonstrate that the field constructs are indpendent of
the dataset structure.</em></span><a class="headerlink" href="#id289" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;flat.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="external-variables">
<span id="id78"></span><h2><a class="toc-backref" href="#id457"><strong>External variables</strong></a><a class="headerlink" href="#external-variables" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#external-variables">External variables</a> are those in a netCDF file that are referred to,
but which are not present in it. Instead, such variables are stored in
other netCDF files known as “external files”. External variables may,
however, be incorporated into the field constructs of the dataset, as
if they had actually been stored in the same file, simply by providing
the external file names to the <a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a> function.</p>
<p>This is illustrated with the files <code class="docutils literal notranslate"><span class="pre">parent.nc</span></code> (found in the
<a class="reference internal" href="#sample-datasets"><span class="std std-ref">sample datasets</span></a>):</p>
<div class="literal-block-wrapper docutils container" id="id290">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the parent dataset with the ncdump command line
tool.</em></span><a class="headerlink" href="#id290" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ncdump<span class="w"> </span>-h<span class="w"> </span>parent.nc
<span class="go">netcdf parent {</span>
<span class="go">dimensions:</span>
<span class="go">     latitude = 10 ;</span>
<span class="go">     longitude = 9 ;</span>
<span class="go">variables:</span>
<span class="go">     double latitude(latitude) ;</span>
<span class="go">             latitude:units = &quot;degrees_north&quot; ;</span>
<span class="go">             latitude:standard_name = &quot;latitude&quot; ;</span>
<span class="go">     double longitude(longitude) ;</span>
<span class="go">             longitude:units = &quot;degrees_east&quot; ;</span>
<span class="go">             longitude:standard_name = &quot;longitude&quot; ;</span>
<span class="go">     double eastward_wind(latitude, longitude) ;</span>
<span class="go">             eastward_wind:units = &quot;m s-1&quot; ;</span>
<span class="go">             eastward_wind:standard_name = &quot;eastward_wind&quot; ;</span>
<span class="go">             eastward_wind:cell_measures = &quot;area: areacella&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">             :Conventions = &quot;CF-1.7&quot; ;</span>
<span class="go">             :external_variables = &quot;areacella&quot; ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<p>and <code class="docutils literal notranslate"><span class="pre">external.nc</span></code> (found in the <a class="reference internal" href="#sample-datasets"><span class="std std-ref">sample datasets</span></a>):</p>
<div class="literal-block-wrapper docutils container" id="id291">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the external dataset with the ncdump command
line tool.</em></span><a class="headerlink" href="#id291" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ncdump<span class="w"> </span>-h<span class="w"> </span>external.nc
<span class="go">netcdf external {</span>
<span class="go">dimensions:</span>
<span class="go">     latitude = 10 ;</span>
<span class="go">     longitude = 9 ;</span>
<span class="go">variables:</span>
<span class="go">     double areacella(longitude, latitude) ;</span>
<span class="go">             areacella:units = &quot;m2&quot; ;</span>
<span class="go">             areacella:standard_name = &quot;cell_area&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">             :Conventions = &quot;CF-1.7&quot; ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<p>The dataset in <code class="docutils literal notranslate"><span class="pre">parent.nc</span></code> may be read <em>without</em> specifying the
external file <code class="docutils literal notranslate"><span class="pre">external.nc</span></code>. In this case a cell measure construct
is still created, but one without any metadata or data:</p>
<div class="literal-block-wrapper docutils container" id="id292">
<div class="code-block-caption"><span class="caption-text"><em>Read the parent dataset without specifying the location
of any external datasets.</em></span><a class="headerlink" href="#id292" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;parent.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">Field: eastward_wind (ncvar%eastward_wind)</span>
<span class="go">------------------------------------------</span>
<span class="go">Data            : eastward_wind(latitude(10), longitude(9)) m s-1</span>
<span class="go">Dimension coords: latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : longitude(9) = [0.0, ..., 8.0] degrees</span>
<span class="go">Cell measures   : measure:area (external variable: ncvar%areacella)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">constructs</span><span class="p">(</span><span class="s1">&#39;measure:area&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span>
<span class="go">&lt;CF CellMeasure: measure:area &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_get_external</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;areacella&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">has_data</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<p>If this field construct were to be written to disk using <a class="reference internal" href="function/cf.write.html#cf.write" title="cf.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.write</span></code></a>,
then the output file would be identical to the original <code class="docutils literal notranslate"><span class="pre">parent.nc</span></code>
file, i.e. the netCDF variable name of the cell measure construct
(<code class="docutils literal notranslate"><span class="pre">areacella</span></code>) would be listed by the <code class="docutils literal notranslate"><span class="pre">external_variables</span></code> global
attribute.</p>
<p>However, the dataset may also be read <em>with</em> the external file. In
this case a cell measure construct is created with all of the metadata
and data from the external file, as if the netCDF cell measure
variable had been present in the parent dataset:</p>
<div class="literal-block-wrapper docutils container" id="id293">
<div class="code-block-caption"><span class="caption-text"><em>Read the parent dataset whilst providing the external
dataset containing the external variables.</em></span><a class="headerlink" href="#id293" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;parent.nc&#39;</span><span class="p">,</span> <span class="n">external</span><span class="o">=</span><span class="s1">&#39;external.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">Field: eastward_wind (ncvar%eastward_wind)</span>
<span class="go">------------------------------------------</span>
<span class="go">Data            : eastward_wind(latitude(10), longitude(9)) m s-1</span>
<span class="go">Dimension coords: latitude(10) = [0.0, ..., 9.0] degrees</span>
<span class="go">                : longitude(9) = [0.0, ..., 8.0] degrees</span>
<span class="go">Cell measures   : measure:area(longitude(9), latitude(10)) = [[100000.5, ..., 100089.5]] m2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;measure:area&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span>
<span class="go">&lt;CF CellMeasure: measure:area(9, 10) m2&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_get_external</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_get_variable</span><span class="p">()</span>
<span class="go">&#39;areacella&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="go">{&#39;standard_name&#39;: &#39;cell_area&#39;, &#39;units&#39;: &#39;m2&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;CF Data(9, 10): [[100000.5, ..., 100089.5]] m2&gt;</span>
</pre></div>
</div>
</div>
<p>If this field construct were to be written to disk using <a class="reference internal" href="function/cf.write.html#cf.write" title="cf.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.write</span></code></a>
then by default the cell measure construct, with all of its metadata
and data, would be written to the named output file, along with all of
the other constructs. There would be no <code class="docutils literal notranslate"><span class="pre">external_variables</span></code> global
attribute.</p>
<p>To create a reference to an external variable in an output netCDF
file, set the status of the cell measure construct to “external” with
its <a class="reference internal" href="method/cf.CellMeasure.nc_set_external.html#cf.CellMeasure.nc_set_external" title="cf.CellMeasure.nc_set_external"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nc_set_external</span></code></a> method.</p>
<div class="literal-block-wrapper docutils container" id="id294">
<div class="code-block-caption"><span class="caption-text"><em>Flag the cell measure as external and write the field
construct to a new file.</em></span><a class="headerlink" href="#id294" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">.</span><span class="n">nc_set_external</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;new_parent.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To create a reference to an external variable in the an output netCDF
file and simultaneously create an external file containing the
variable, set the status of the cell measure construct to “external”
and provide an external file name to the <a class="reference internal" href="function/cf.write.html#cf.write" title="cf.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.write</span></code></a> function:</p>
<div class="literal-block-wrapper docutils container" id="id295">
<div class="code-block-caption"><span class="caption-text"><em>Write the field construct to a new file and the cell
measure construct to an external file.</em></span><a class="headerlink" href="#id295" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;new_parent.nc&#39;</span><span class="p">,</span> <span class="n">external</span><span class="o">=</span><span class="s1">&#39;new_external.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="external-files-with-cfa">
<span id="external-variables-with-cfa"></span><h3><a class="toc-backref" href="#id458">External files with cfa</a><a class="headerlink" href="#external-files-with-cfa" title="Permalink to this headline">¶</a></h3>
<p>One or more external files may also be included with the <a class="reference internal" href="#file-inspection-with-cfa"><span class="std std-ref">cfa
command line tool</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id296">
<div class="code-block-caption"><span class="caption-text"><em>Use cfa to describe the parent file without resolving
the external variable reference.</em></span><a class="headerlink" href="#id296" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cfa<span class="w"> </span>parent.nc
<span class="go">Field: eastward_wind (ncvar%eastward_wind)</span>
<span class="go">------------------------------------------</span>
<span class="go">Data            : eastward_wind(latitude(10), longitude(9)) m s-1</span>
<span class="go">Dimension coords: latitude(10) = [0.0, ..., 9.0] degrees_north</span>
<span class="go">                : longitude(9) = [0.0, ..., 8.0] degrees_east</span>
<span class="go">Cell measures   : measure:area (external variable: ncvar%areacella)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id297">
<div class="code-block-caption"><span class="caption-text"><em>Providing an external file with the “-e” option allows
the reference to be resolved.</em></span><a class="headerlink" href="#id297" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cfa<span class="w"> </span>-e<span class="w"> </span>external.nc<span class="w"> </span>parent.nc
<span class="go">Field: eastward_wind (ncvar%eastward_wind)</span>
<span class="go">------------------------------------------</span>
<span class="go">Data            : eastward_wind(latitude(10), longitude(9)) m s-1</span>
<span class="go">Dimension coords: latitude(10) = [0.0, ..., 9.0] degrees_north</span>
<span class="go">                : longitude(9) = [0.0, ..., 8.0] degrees_east</span>
<span class="go">Cell measures   : measure:area(longitude(9), latitude(10)) = [[100000.5, ..., 100089.5]] m2</span>
</pre></div>
</div>
</div>
<p>External variables will be written into new datasets if the <em>-v</em>
option is omitted.</p>
<hr class="docutils" />
</section>
</section>
<section id="aggregation">
<span id="id79"></span><h2><a class="toc-backref" href="#id459"><strong>Aggregation</strong></a><a class="headerlink" href="#aggregation" title="Permalink to this headline">¶</a></h2>
<p>Aggregation is the combination of field constructs to create a new
field construct that occupies a “larger” domain. Using the
<a class="reference internal" href="aggregation_rules.html#aggregation-rules"><span class="std std-ref">aggregation rules</span></a>, field constructs are
separated into aggregatable groups and each group is then aggregated
to a single field construct. Note that aggregation is possible over
multiple dimensions simultaneously.</p>
<p>Aggregation is, by default, applied to field constructs read from
datasets with the <a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a> function, but may also be applied to field
constructs in memory with the <a class="reference internal" href="function/cf.aggregate.html#cf.aggregate" title="cf.aggregate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.aggregate</span></code></a> function.</p>
<div class="literal-block-wrapper docutils container" id="id298">
<div class="code-block-caption"><span class="caption-text"><em>Demonstrate that the aggregation applied by ‘cf.read’ is
equivalent to that carried by ‘cf.aggregate’. This is
done by splitting a field up into parts, writing those to
disk, and then reading those parts and aggregating them.</em></span><a class="headerlink" href="#id298" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;air_temperature.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">&lt;CF Field: air_temperature(time(2), latitude(73), longitude(96)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_parts</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span> <span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">30</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">30</span><span class="p">:</span><span class="mi">96</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">30</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">30</span><span class="p">:</span><span class="mi">96</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_parts</span>
<span class="go">[&lt;CF Field: air_temperature(time(1), latitude(73), longitude(30)) K&gt;,</span>
<span class="go"> &lt;CF Field: air_temperature(time(1), latitude(73), longitude(66)) K&gt;,</span>
<span class="go"> &lt;CF Field: air_temperature(time(1), latitude(73), longitude(30)) K&gt;,</span>
<span class="go"> &lt;CF Field: air_temperature(time(1), latitude(73), longitude(66)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">a_parts</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_air_temperature.nc&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;[0-3]_air_temperature.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;[0-3]_air_temperature.nc&#39;</span><span class="p">,</span> <span class="n">aggregate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">[&lt;CF Field: air_temperature(time(2), latitude(73), longitude(96)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span>
<span class="go">[&lt;CF Field: air_temperature(time(2), latitude(73), longitude(96)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="function/cf.aggregate.html#cf.aggregate" title="cf.aggregate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.aggregate</span></code></a> function has optional parameters to</p>
<ul class="simple">
<li><p>Display information about the aggregation process,</p></li>
<li><p>Relax the conditions to the need for standard names and units
properties,</p></li>
<li><p>Specify whether or not to allow field constructs with overlapping or
non-contiguous cells to be aggregated,</p></li>
<li><p>Define the treatment of properties with different values across the
set of aggregated field constructs,</p></li>
<li><p>Create a new aggregated domain axes with coordinate values taken
from a named field construct property,</p></li>
<li><p>Restrict aggregation to particular domain axes, and</p></li>
<li><p>Set the tolerance for numerical comparisons.</p></li>
</ul>
<p>These parameters are also available to the <a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a> function via its
<em>aggregate</em> parameter.</p>
<p>Note that when reading <a class="reference internal" href="#pp-and-um-fields-files"><span class="std std-ref">PP and UM fields files</span></a> with <a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a>, the <em>relaxed_units</em> option
is <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> by default, because units are not always available to field
constructs derived from <a class="reference internal" href="#pp-and-um-fields-files"><span class="std std-ref">PP and UM fields files</span></a>.</p>
<p>Field constructs that are logically similar but arranged differently
are also aggregatable.</p>
<div class="literal-block-wrapper docutils container" id="id299">
<div class="code-block-caption"><span class="caption-text"><em>Show that the aggregation is unchanged when one of the
field constructs has a different axis order and different
units.</em></span><a class="headerlink" href="#id299" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">a_parts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">[&lt;CF Field: air_temperature(time(2), latitude(73), longitude(96)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degreesC&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_parts</span>
<span class="go">[&lt;CF Field: air_temperature(time(1), latitude(73), longitude(30)) K&gt;,</span>
<span class="go"> &lt;CF Field: air_temperature(longitude(66), latitude(73), time(1)) degreesC&gt;,</span>
<span class="go"> &lt;CF Field: air_temperature(time(1), latitude(73), longitude(30)) K&gt;,</span>
<span class="go"> &lt;CF Field: air_temperature(time(1), latitude(73), longitude(66)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">a_parts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span>
<span class="go">[&lt;CF Field: air_temperature(time(2), latitude(73), longitude(96)) K&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="compression">
<span id="id80"></span><h2><a class="toc-backref" href="#id460"><strong>Compression</strong></a><a class="headerlink" href="#compression" title="Permalink to this headline">¶</a></h2>
<p>The CF conventions have support for saving space by identifying and
removing unwanted missing data.  Such compression techniques store the
data more efficiently and result in no precision loss. The CF data
model, however, views compressed arrays in their uncompressed form.</p>
<p>Therefore, the field construct contains domain axis constructs for the
compressed dimensions and presents a view of compressed data in its
uncompressed form, even though the “underlying array” (i.e. the actual
array on disk or in memory that is contained in a <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instance) is
compressed. This means that the cf package includes algorithms for
uncompressing each type of compressed array.</p>
<p>There are two basic types of compression supported by the CF
conventions: ragged arrays (as used by <a class="reference internal" href="#discrete-sampling-geometries"><span class="std std-ref">discrete sampling
geometries</span></a>) and <a class="reference internal" href="#gathering"><span class="std std-ref">compression by
gathering</span></a>, each of which has particular implementation
details, but the following access patterns and behaviours apply to
both:</p>
<ul class="simple">
<li><p>Whether or not the data are compressed is tested with the
<a class="reference internal" href="method/cf.Data.get_compression_type.html#cf.Data.get_compression_type" title="cf.Data.get_compression_type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_compression_type</span></code></a> method of the <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instance.</p></li>
</ul>
<ul class="simple">
<li><p>The compressed underlying array may be retrieved as a numpy array
with the <a class="reference internal" href="attribute/cf.Data.compressed_array.html#cf.Data.compressed_array" title="cf.Data.compressed_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compressed_array</span></code></a> attribute of the <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instance.</p></li>
</ul>
<ul class="simple">
<li><p>Accessing the data via the <a class="reference internal" href="attribute/cf.Field.array.html#cf.Field.array" title="cf.Field.array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> attribute returns a numpy
array that is uncompressed. The underlying array will also be
uncompressed.</p></li>
</ul>
<ul class="simple">
<li><p>A subspace of a field construct is created with indices of the
uncompressed form of the data. The new subspace will no longer be
compressed, i.e. its underlying arrays will be uncompressed, but the
original data will remain compressed. It follows that all of the
data in a field construct may be uncompressed by indexing the field
construct with (indices equivalent to) <a class="reference external" href="https://docs.python.org/3/library/constants.html#Ellipsis" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Ellipsis</span></code></a>.</p></li>
</ul>
<ul class="simple">
<li><p>If data elements are modified by <a class="reference internal" href="#assignment-by-index"><span class="std std-ref">assigning</span></a> to indices of the uncompressed form of the
data, then the compressed underlying array is replaced by its
uncompressed form.</p></li>
</ul>
<ul class="simple">
<li><p>An uncompressed field construct can be compressed, prior to being
written to a dataset, with its <a class="reference internal" href="method/cf.Field.compress.html#cf.Field.compress" title="cf.Field.compress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compress</span></code></a> method, which also
compresses the metadata constructs as required.</p></li>
</ul>
<ul class="simple">
<li><p>An compressed field construct can be uncompressed with its
<a class="reference internal" href="method/cf.Field.uncompress.html#cf.Field.uncompress" title="cf.Field.uncompress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">uncompress</span></code></a> method, which also uncompresses the metadata
constructs as required.</p></li>
</ul>
<ul class="simple">
<li><p>If an underlying array is compressed at the time of writing to disk
with the <a class="reference internal" href="function/cf.write.html#cf.write" title="cf.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.write</span></code></a> function, then it is written to the file as a
compressed array, along with the supplementary netCDF variables and
attributes that are required for the encoding. This means that if a
dataset using compression is read from disk then it will be written
back to disk with the same compression, unless data elements have
been modified by assignment.</p></li>
</ul>
<p>Examples of all of the above may be found in the sections on
<a class="reference internal" href="#discrete-sampling-geometries"><span class="std std-ref">discrete sampling geometries</span></a> and
<a class="reference internal" href="#gathering"><span class="std std-ref">gathering</span></a>.</p>
<section id="discrete-sampling-geometries">
<span id="id81"></span><h3><a class="toc-backref" href="#id461">Discrete sampling geometries</a><a class="headerlink" href="#discrete-sampling-geometries" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#discrete-sampling-geometries">Discrete sampling geometry (DSG)</a> features may be compressed by
combining them using one of three ragged array representations:
<a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_contiguous_ragged_array_representation">contiguous</a>, <a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_indexed_ragged_array_representation">indexed</a> or <a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_ragged_array_representation_of_time_series_profiles">indexed contiguous</a>.</p>
<p>The count variable that is required to uncompress a contiguous, or
indexed contiguous, ragged array is stored in a <a class="reference internal" href="class/cf.Count.html#cf.Count" title="cf.Count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Count</span></code></a> instance
and is accessed with the <a class="reference internal" href="method/cf.Data.get_count.html#cf.Data.get_count" title="cf.Data.get_count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_count</span></code></a> method of the <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a>
instance.</p>
<p>The index variable that is required to uncompress an indexed, or
indexed contiguous, ragged array is stored in an <a class="reference internal" href="class/cf.Index.html#cf.Index" title="cf.Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Index</span></code></a> instance
and is accessed with the <a class="reference internal" href="method/cf.Data.get_index.html#cf.Data.get_index" title="cf.Data.get_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_index</span></code></a> method of the <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a>
instance.</p>
<p>The contiguous case is is illustrated with the file <code class="docutils literal notranslate"><span class="pre">contiguous.nc</span></code>
(found in the <a class="reference internal" href="#sample-datasets"><span class="std std-ref">sample datasets</span></a>):</p>
<div class="literal-block-wrapper docutils container" id="id300">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the compressed dataset with the ncdump command
line tool.</em></span><a class="headerlink" href="#id300" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ncdump<span class="w"> </span>-h<span class="w"> </span>contiguous.nc
<span class="go">dimensions:</span>
<span class="go">     station = 4 ;</span>
<span class="go">     obs = 24 ;</span>
<span class="go">     strlen8 = 8 ;</span>
<span class="go">variables:</span>
<span class="go">     int row_size(station) ;</span>
<span class="go">             row_size:long_name = &quot;number of observations for this station&quot; ;</span>
<span class="go">             row_size:sample_dimension = &quot;obs&quot; ;</span>
<span class="go">     double time(obs) ;</span>
<span class="go">             time:units = &quot;days since 1970-01-01 00:00:00&quot; ;</span>
<span class="go">             time:standard_name = &quot;time&quot; ;</span>
<span class="go">     double lat(station) ;</span>
<span class="go">             lat:units = &quot;degrees_north&quot; ;</span>
<span class="go">             lat:standard_name = &quot;latitude&quot; ;</span>
<span class="go">     double lon(station) ;</span>
<span class="go">             lon:units = &quot;degrees_east&quot; ;</span>
<span class="go">             lon:standard_name = &quot;longitude&quot; ;</span>
<span class="go">     double alt(station) ;</span>
<span class="go">             alt:units = &quot;m&quot; ;</span>
<span class="go">             alt:positive = &quot;up&quot; ;</span>
<span class="go">             alt:standard_name = &quot;height&quot; ;</span>
<span class="go">             alt:axis = &quot;Z&quot; ;</span>
<span class="go">     char station_name(station, strlen8) ;</span>
<span class="go">             station_name:long_name = &quot;station name&quot; ;</span>
<span class="go">             station_name:cf_role = &quot;timeseries_id&quot; ;</span>
<span class="go">     double humidity(obs) ;</span>
<span class="go">             humidity:standard_name = &quot;specific_humidity&quot; ;</span>
<span class="go">             humidity:coordinates = &quot;time lat lon alt station_name&quot; ;</span>
<span class="go">             humidity:_FillValue = -999.9 ;</span>

<span class="go">// global attributes:</span>
<span class="go">             :Conventions = &quot;CF-1.7&quot; ;</span>
<span class="go">             :featureType = &quot;timeSeries&quot; ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<p>Reading and inspecting this file shows the data presented in
two-dimensional uncompressed form, whilst the underlying array is
still in the one-dimension ragged representation described in the
file:</p>
<div class="literal-block-wrapper docutils container" id="id301">
<div class="code-block-caption"><span class="caption-text"><em>Read a field construct from a dataset that has been
compressed with contiguous ragged arrays, and inspect its
data in uncompressed form.</em></span><a class="headerlink" href="#id301" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;contiguous.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%humidity)</span>
<span class="go">-----------------------------------------</span>
<span class="go">Data            : specific_humidity(ncdim%station(4), ncdim%timeseries(9))</span>
<span class="go">Dimension coords:</span>
<span class="go">Auxiliary coords: time(ncdim%station(4), ncdim%timeseries(9)) = [[1969-12-29 00:00:00, ..., 1970-01-07 00:00:00]]</span>
<span class="go">                : latitude(ncdim%station(4)) = [-9.0, ..., 78.0] degrees_north</span>
<span class="go">                : longitude(ncdim%station(4)) = [-23.0, ..., 178.0] degrees_east</span>
<span class="go">                : height(ncdim%station(4)) = [0.5, ..., 345.0] m</span>
<span class="go">                : cf_role:timeseries_id(ncdim%station(4)) = [station1, ..., station4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.12 0.05 0.18   --   --   --   --   --   --]</span>
<span class="go"> [0.05 0.11 0.2  0.15 0.08 0.04 0.06   --   --]</span>
<span class="go"> [0.15 0.19 0.15 0.17 0.07   --   --   --   --]</span>
<span class="go"> [0.11 0.03 0.14 0.16 0.02 0.09 0.1  0.04 0.11]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id302">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the underlying compressed array and the count
variable that defines how to uncompress the data.</em></span><a class="headerlink" href="#id302" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;ragged contiguous&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">compressed_array</span><span class="p">)</span>
<span class="go">[0.12 0.05 0.18 0.05 0.11 0.2 0.15 0.08 0.04 0.06 0.15 0.19 0.15 0.17 0.07</span>
<span class="go"> 0.11 0.03 0.14 0.16 0.02 0.09 0.1 0.04 0.11]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_variable</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_variable</span>
<span class="go">&lt;CF Count: long_name=number of observations for this station(4) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">count_variable</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[3 7 5 9]</span>
</pre></div>
</div>
</div>
<p>The timeseries for the second station is easily selected by indexing
the “station” axis of the field construct:</p>
<div class="literal-block-wrapper docutils container" id="id303">
<div class="code-block-caption"><span class="caption-text"><em>Get the data for the second station.</em></span><a class="headerlink" href="#id303" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">station2</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">station2</span>
<span class="go">&lt;CF Field: specific_humidity(cf_role=timeseries_id(1), ncdim%timeseries(9))&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">station2</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.05 0.11 0.2 0.15 0.08 0.04 0.06 -- --]]</span>
</pre></div>
</div>
</div>
<p>The underlying array of original data remains in compressed form until
data array elements are modified:</p>
<div class="literal-block-wrapper docutils container" id="id304">
<div class="code-block-caption"><span class="caption-text"><em>Change an element of the data and show that the
underlying array is no longer compressed.</em></span><a class="headerlink" href="#id304" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;ragged contiguous&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.12 0.05 0.18   --   --   --   --   --   --]</span>
<span class="go"> [0.05 0.11 -9.0 0.15 0.08 0.04 0.06   --   --]</span>
<span class="go"> [0.15 0.19 0.15 0.17 0.07   --   --   --   --]</span>
<span class="go"> [0.11 0.03 0.14 0.16 0.02 0.09 0.1  0.04 0.11]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
</div>
<p>Perhaps the easiest way to create a compressed field construct is to
create the equivalent uncompressed field construct and then compress
it with its <a class="reference internal" href="method/cf.Field.compress.html#cf.Field.compress" title="cf.Field.compress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compress</span></code></a> method, which also compresses the
metadata constructs as required.</p>
<div class="literal-block-wrapper docutils container" id="id305">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct and then compress it.</em></span><a class="headerlink" href="#id305" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cf</span>

<span class="c1"># Define the array values</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mf">280.0</span><span class="p">,</span>   <span class="o">-</span><span class="mi">99</span><span class="p">,</span>   <span class="o">-</span><span class="mi">99</span><span class="p">,</span>   <span class="o">-</span><span class="mi">99</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">281.0</span><span class="p">,</span> <span class="mf">279.0</span><span class="p">,</span> <span class="mf">278.0</span><span class="p">,</span> <span class="mf">279.5</span><span class="p">]])</span>
<span class="n">data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="o">-</span><span class="mi">99</span><span class="p">),</span> <span class="n">cf</span><span class="o">.</span><span class="n">masked</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create the field construct</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Field</span><span class="p">()</span>
<span class="n">T</span><span class="o">.</span><span class="n">set_properties</span><span class="p">({</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;air_temperature&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;featureType&#39;</span><span class="p">:</span> <span class="s1">&#39;timeSeries&#39;</span><span class="p">})</span>

<span class="c1"># Create the domain axis constructs</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Set the data for the field</span>
<span class="n">T</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Compress the data</span>
<span class="n">T</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="s1">&#39;contiguous&#39;</span><span class="p">,</span>
       <span class="n">count_properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;number of obs for this timeseries&#39;</span><span class="p">},</span>
       <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The new compressed field construct can now be inspected and written to
a netCDF file:</p>
<div class="literal-block-wrapper docutils container" id="id306">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new field construct and write it to disk.</em></span><a class="headerlink" href="#id306" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">T</span>
<span class="go">&lt;CF Field: air_temperature(key%domainaxis1(2), key%domainaxis0(4)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[280.0    --    --    --]</span>
<span class="go"> [281.0 279.0 278.0 279.5]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;ragged contiguous&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">compressed_array</span><span class="p">)</span>
<span class="go">[280.  281.  279.  278.  279.5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_variable</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_variable</span>
<span class="go">&lt;CF Count: long_name=number of obs for this timeseries(2) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">count_variable</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[1 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="s1">&#39;T_contiguous.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The content of the new file is:</p>
<div class="literal-block-wrapper docutils container" id="id307">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new compressed dataset with the ncdump
command line tool.</em></span><a class="headerlink" href="#id307" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ncdump<span class="w"> </span>T_contiguous.nc
<span class="go">netcdf T_contiguous {</span>
<span class="go">dimensions:</span>
<span class="go">     dim = 2 ;</span>
<span class="go">     element = 5 ;</span>
<span class="go">variables:</span>
<span class="go">     int64 count(dim) ;</span>
<span class="go">             count:long_name = &quot;number of obs for this timeseries&quot; ;</span>
<span class="go">             count:sample_dimension = &quot;element&quot; ;</span>
<span class="go">     float air_temperature(element) ;</span>
<span class="go">             air_temperature:units = &quot;K&quot; ;</span>
<span class="go">             air_temperature:standard_name = &quot;air_temperature&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">             :Conventions = &quot;CF-1.7&quot; ;</span>
<span class="go">             :featureType = &quot;timeSeries&quot; ;</span>
<span class="go">data:</span>

<span class="go"> count = 1, 4 ;</span>

<span class="go"> air_temperature = 280, 281, 279, 278, 279.5 ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<p>Exactly the same field construct may be also created explicitly with
underlying compressed data. A construct with an underlying ragged
array is created by initialising a <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instance with a ragged
array that is stored in one of three special array objects:
<a class="reference internal" href="class/cf.RaggedContiguousArray.html#cf.RaggedContiguousArray" title="cf.RaggedContiguousArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RaggedContiguousArray</span></code></a>, <a class="reference internal" href="class/cf.RaggedIndexedArray.html#cf.RaggedIndexedArray" title="cf.RaggedIndexedArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RaggedIndexedArray</span></code></a> or
<a class="reference internal" href="class/cf.RaggedIndexedContiguousArray.html#cf.RaggedIndexedContiguousArray" title="cf.RaggedIndexedContiguousArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RaggedIndexedContiguousArray</span></code></a>.</p>
<div class="literal-block-wrapper docutils container" id="id308">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct explicitly with compressed
data.</em></span><a class="headerlink" href="#id308" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cf</span>

<span class="c1"># Define the ragged array values</span>
<span class="n">ragged_array</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">280</span><span class="p">,</span> <span class="mi">281</span><span class="p">,</span> <span class="mi">279</span><span class="p">,</span> <span class="mi">278</span><span class="p">,</span> <span class="mf">279.5</span><span class="p">])</span>

<span class="c1"># Define the count array values</span>
<span class="n">count_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>

<span class="c1"># Create the count variable</span>
<span class="n">count_variable</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Count</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">count_array</span><span class="p">))</span>
<span class="n">count_variable</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;number of obs for this timeseries&#39;</span><span class="p">)</span>

<span class="c1"># Create the contiguous ragged array object, specifying the</span>
<span class="c1"># uncompressed shape</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">RaggedContiguousArray</span><span class="p">(</span>
                 <span class="n">compressed_array</span><span class="o">=</span><span class="n">ragged_array</span><span class="p">,</span>
                 <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                 <span class="n">count_variable</span><span class="o">=</span><span class="n">count_variable</span><span class="p">)</span>

<span class="c1"># Create the field construct</span>
<span class="n">T</span><span class="o">.</span><span class="n">set_properties</span><span class="p">({</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;air_temperature&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;featureType&#39;</span><span class="p">:</span> <span class="s1">&#39;timeSeries&#39;</span><span class="p">})</span>

<span class="c1"># Create the domain axis constructs for the uncompressed array</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Set the data for the field</span>
<span class="n">T</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>
</pre></div>
</div>
</div>
</section>
<section id="gathering">
<span id="id82"></span><h3><a class="toc-backref" href="#id462">Gathering</a><a class="headerlink" href="#gathering" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#compression-by-gathering">Compression by gathering</a> combines axes of a multidimensional array
into a new, discrete axis whilst omitting the missing values and thus
reducing the number of values that need to be stored.</p>
<p>The list variable that is required to uncompress a gathered array is
stored in a <a class="reference internal" href="class/cf.List.html#cf.List" title="cf.List"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.List</span></code></a> object and is retrieved with the <a class="reference internal" href="method/cf.Data.get_list.html#cf.Data.get_list" title="cf.Data.get_list"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_list</span></code></a>
method of the <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instance.</p>
<p>This is illustrated with the file <code class="docutils literal notranslate"><span class="pre">gathered.nc</span></code> (found in the
<a class="reference internal" href="#sample-datasets"><span class="std std-ref">sample datasets</span></a>):</p>
<div class="literal-block-wrapper docutils container" id="id309">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the compressed dataset with the ncdump command
line tool.</em></span><a class="headerlink" href="#id309" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ncdump<span class="w"> </span>-h<span class="w"> </span>gathered.nc
<span class="go">netcdf gathered {</span>
<span class="go">dimensions:</span>
<span class="go">     time = 2 ;</span>
<span class="go">     lat = 4 ;</span>
<span class="go">     lon = 5 ;</span>
<span class="go">     landpoint = 7 ;</span>
<span class="go">variables:</span>
<span class="go">     double time(time) ;</span>
<span class="go">             time:standard_name = &quot;time&quot; ;</span>
<span class="go">             time:units = &quot;days since 2000-1-1&quot; ;</span>
<span class="go">     double lat(lat) ;</span>
<span class="go">             lat:standard_name = &quot;latitude&quot; ;</span>
<span class="go">             lat:units = &quot;degrees_north&quot; ;</span>
<span class="go">     double lon(lon) ;</span>
<span class="go">             lon:standard_name = &quot;longitude&quot; ;</span>
<span class="go">             lon:units = &quot;degrees_east&quot; ;</span>
<span class="go">     int landpoint(landpoint) ;</span>
<span class="go">             landpoint:compress = &quot;lat lon&quot; ;</span>
<span class="go">     double pr(time, landpoint) ;</span>
<span class="go">             pr:standard_name = &quot;precipitation_flux&quot; ;</span>
<span class="go">             pr:units = &quot;kg m2 s-1&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">             :Conventions = &quot;CF-1.7&quot; ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<p>Reading and inspecting this file shows the data presented in
three-dimensional uncompressed form, whilst the underlying array is
still in the two-dimensional gathered representation described in the
file:</p>
<div class="literal-block-wrapper docutils container" id="id310">
<div class="code-block-caption"><span class="caption-text"><em>Read a field construct from a dataset that has been
compressed by gathering, and inspect its data in
uncompressed form.</em></span><a class="headerlink" href="#id310" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;gathered.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">Field: precipitation_flux (ncvar%pr)</span>
<span class="go">------------------------------------</span>
<span class="go">Data            : precipitation_flux(time(2), latitude(4), longitude(5)) kg m2 s-1</span>
<span class="go">Dimension coords: time(2) = [2000-02-01 00:00:00, 2000-03-01 00:00:00]</span>
<span class="go">                : latitude(4) = [-90.0, ..., -75.0] degrees_north</span>
<span class="go">                : longitude(5) = [0.0, ..., 40.0] degrees_east</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[--       0.000122 0.0008   --       --      ]</span>
<span class="go">  [0.000177 --       0.000175 0.00058  --      ]</span>
<span class="go">  [--       --       --       --       --      ]</span>
<span class="go">  [--       0.000206 --       0.0007   --      ]]</span>

<span class="go"> [[--       0.000202 0.000174 --       --      ]</span>
<span class="go">  [0.00084  --       0.000201 0.0057   --      ]</span>
<span class="go">  [--       --       --       --       --      ]</span>
<span class="go">  [--       0.000223 --       0.000102 --      ]]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id311">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the underlying compressed array and the list
variable that defines how to uncompress the data.</em></span><a class="headerlink" href="#id311" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;gathered&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">compressed_array</span><span class="p">)</span>
<span class="go">[[0.000122 0.0008   0.000177 0.000175 0.00058 0.000206 0.0007  ]</span>
<span class="go"> [0.000202 0.000174 0.00084  0.000201 0.0057  0.000223 0.000102]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_variable</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_variable</span>
<span class="go">&lt;CF List: ncvar%landpoint(7) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">list_variable</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[ 1  2  5  7  8 16 18]</span>
</pre></div>
</div>
</div>
<p>Subspaces based on the uncompressed axes of the field construct are
easily created:</p>
<div class="literal-block-wrapper docutils container" id="id312">
<div class="code-block-caption"><span class="caption-text"><em>Get subspaces based on indices of the uncompressed
data.</em></span><a class="headerlink" href="#id312" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;CF Field: precipitation_flux(time(1), latitude(4), longitude(5)) kg m2 s-1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="go">&lt;CF Field: precipitation_flux(time(1), latitude(4), longitude(2)) kg m2 s-1&gt;</span>
</pre></div>
</div>
</div>
<p>The underlying array of original data remains in compressed form until
data array elements are modified:</p>
<div class="literal-block-wrapper docutils container" id="id313">
<div class="code-block-caption"><span class="caption-text"><em>Change an element of the data and show that the
underlying array is no longer compressed.</em></span><a class="headerlink" href="#id313" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;gathered&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
</div>
<p>A construct with an underlying gathered array is created by
initialising a <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instance with a gathered array that is stored
in the special <a class="reference internal" href="class/cf.GatheredArray.html#cf.GatheredArray" title="cf.GatheredArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.GatheredArray</span></code></a> array object. The following code
creates a simple field construct with an underlying gathered array:</p>
<div class="literal-block-wrapper docutils container" id="id314">
<div class="code-block-caption"><span class="caption-text"><em>Create a field construct with compressed data.</em></span><a class="headerlink" href="#id314" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">cf</span>

<span class="c1"># Define the gathered values</span>
<span class="n">gathered_array</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>

<span class="c1"># Define the list array values</span>
<span class="n">list_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="c1"># Create the list variable</span>
<span class="n">list_variable</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">list_array</span><span class="p">))</span>

<span class="c1"># Create the gathered array object, specifying the mapping between</span>
<span class="c1"># compressed and uncompressed dimensions, and the uncompressed</span>
<span class="c1"># shape.</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">GatheredArray</span><span class="p">(</span>
                 <span class="n">compressed_array</span><span class="o">=</span><span class="n">gathered_array</span><span class="p">,</span>
                 <span class="n">compressed_dimensions</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]},</span>
                 <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                 <span class="n">list_variable</span><span class="o">=</span><span class="n">list_variable</span>
        <span class="p">)</span>

<span class="c1"># Create the field construct with the domain axes and the gathered</span>
<span class="c1"># array</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;precipitation_flux&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;kg m-2 s-1&#39;</span><span class="p">})</span>

<span class="c1"># Create the domain axis constructs for the uncompressed array</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">set_construct</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">DomainAxis</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Set the data for the field</span>
<span class="n">P</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">array</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Note that, because compression by gathering acts on a subset of the
array dimensions, it is necessary to state the position of the
compressed dimension in the compressed array (with the
<code class="docutils literal notranslate"><span class="pre">compressed_dimension</span></code> parameter of the <a class="reference internal" href="class/cf.GatheredArray.html#cf.GatheredArray" title="cf.GatheredArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.GatheredArray</span></code></a>
initialisation).</p>
<p>The new field construct can now be inspected and written a netCDF file:</p>
<div class="literal-block-wrapper docutils container" id="id315">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the new field construct and write it to disk.</em></span><a class="headerlink" href="#id315" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">P</span>
<span class="go">&lt;CF Field: precipitation_flux(key%domainaxis0(2), key%domainaxis1(3), key%domainaxis2(2)) kg m-2 s-1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[ -- 2.0]</span>
<span class="go">  [ --  --]</span>
<span class="go">  [1.0 3.0]]</span>

<span class="go"> [[ -- 4.0]</span>
<span class="go">  [ --  --]</span>
<span class="go">  [0.0 5.0]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_compression_type</span><span class="p">()</span>
<span class="go">&#39;gathered&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">compressed_array</span><span class="p">)</span>
<span class="go">[[2. 1. 3.]</span>
<span class="go"> [4. 0. 5.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_variable</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_variable</span>
<span class="go">&lt;CF List: (3) &gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">list_variable</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[1 4 5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="s1">&#39;P_gathered.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The content of the new file is:</p>
<div class="literal-block-wrapper docutils container" id="id316">
<div class="code-block-caption"><span class="caption-text"><em>Inspect new the compressed dataset with the ncdump
command line tool.</em></span><a class="headerlink" href="#id316" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ncdump<span class="w"> </span>P_gathered.nc
<span class="go">netcdf P_gathered {</span>
<span class="go">dimensions:</span>
<span class="go">     dim = 2 ;</span>
<span class="go">     dim_1 = 3 ;</span>
<span class="go">     dim_2 = 2 ;</span>
<span class="go">     list = 3 ;</span>
<span class="go">variables:</span>
<span class="go">     int64 list(list) ;</span>
<span class="go">             list:compress = &quot;dim_1 dim_2&quot; ;</span>
<span class="go">     float precipitation_flux(dim, list) ;</span>
<span class="go">             precipitation_flux:units = &quot;kg m-2 s-1&quot; ;</span>
<span class="go">             precipitation_flux:standard_name = &quot;precipitation_flux&quot; ;</span>

<span class="go">// global attributes:</span>
<span class="go">             :Conventions = &quot;CF-1.7&quot; ;</span>
<span class="go">data:</span>

<span class="go"> list = 1, 4, 5 ;</span>

<span class="go"> precipitation_flux =</span>
<span class="go">  2, 1, 3,</span>
<span class="go">  4, 0, 5 ;</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="coordinate-subsampling">
<span id="coordinate-subampling"></span><h3><a class="toc-backref" href="#id463">Coordinate subsampling</a><a class="headerlink" href="#coordinate-subsampling" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#compression-by-coordinate-subsampling">Lossy compression by coordinate subsampling</a> was introduced into the
CF conventions at CF-1.9, but is not yet available in cfdm. It will be
ready in a future 3.x.0 release.</p>
<hr class="docutils" />
</section>
</section>
<section id="pp-and-um-fields-files">
<span id="id83"></span><h2><a class="toc-backref" href="#id464"><strong>PP and UM fields files</strong></a><a class="headerlink" href="#pp-and-um-fields-files" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a> function can read PP files and UM fields files (as
output by some versions of the <a class="reference external" href="https://en.wikipedia.org/wiki/Unified_Model">Unified Model</a>, for example), mapping
their contents into field constructs. 32-bit and 64-bit PP and UM
fields files of any endian-ness can be read. In nearly all cases the
file format is auto-detectable from the first 64 bits in the file, but
for the few occasions when this is not possible <a class="footnote-reference brackets" href="#um" id="id84">2</a>, the <em>um</em>
keyword of <a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a> allows the format to be specified. The the UM
version (if not inferrable from the PP or lookup header information)
and the height of the upper bound of the top model level may also be
set with the <em>um</em> keyword.</p>
<p>Note that 2-d “slices” within a single file are always combined, where
possible, into field constructs with 3-d, 4-d or 5-d data. This is
done prior to the <a class="reference internal" href="#aggregation"><span class="std std-ref">field construct aggregation</span></a>
carried out by the <a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a> function.</p>
<div class="literal-block-wrapper docutils container" id="id317">
<div class="code-block-caption"><span class="caption-text"><em>Read a PP file into field constructs.</em></span><a class="headerlink" href="#id317" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;umfile.pp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span>
<span class="go">[&lt;CF Field: surface_air_pressure(time(3), latitude(73), longitude(96)) Pa&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Field: surface_air_pressure (ncvar%UM_m01s00i001_vn405)</span>
<span class="go">-------------------------------------------------------</span>
<span class="go">Data            : surface_air_pressure(time(3), latitude(73), longitude(96)) Pa</span>
<span class="go">Cell methods    : time(3): mean</span>
<span class="go">Dimension coords: time(3) = [2160-06-01 00:00:00, 2161-06-01 00:00:00, 2162-06-01 00:00:00] 360_day</span>
<span class="go">                : latitude(73) = [90.0, ..., -90.0] degrees_north</span>
<span class="go">                : longitude(96) = [0.0, ..., 356.25] degrees_east</span>
</pre></div>
</div>
</div>
<section id="converting-pp-and-um-fields-files-to-netcdf-files">
<h3><a class="toc-backref" href="#id465">Converting PP and UM fields files to netCDF files</a><a class="headerlink" href="#converting-pp-and-um-fields-files-to-netcdf-files" title="Permalink to this headline">¶</a></h3>
<p>PP and UM fields files may read with <a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a> and subsequently
written to disk as netCDF files with <a class="reference internal" href="function/cf.write.html#cf.write" title="cf.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.write</span></code></a>.</p>
<div class="literal-block-wrapper docutils container" id="id318">
<div class="code-block-caption"><span class="caption-text"><em>Write the field constructs from a PP file to a netCDF
dataset.</em></span><a class="headerlink" href="#id318" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="s1">&#39;umfile1.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Alternatively, the <code class="docutils literal notranslate"><span class="pre">cfa</span></code> command line tool may be used with PP and UM
fields files in exactly the same way as netCDF files. This provides a
view of PP and UM fields files as CF field constructs, and also easily
converts PP and UM fields files to netCDF datasets on disk.</p>
<div class="literal-block-wrapper docutils container" id="id319">
<div class="code-block-caption"><span class="caption-text"><em>Use the ‘cfa’ shell command to view a PP file and
convert it to a netCDF dataset.</em></span><a class="headerlink" href="#id319" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cfa<span class="w"> </span>umfile.pp
<span class="go">CF Field: surface_air_pressure(time(3), latitude(73), longitude(96)) Pa</span>
<span class="gp">$ </span>cfa<span class="w"> </span>-o<span class="w"> </span>umfile2.nc<span class="w"> </span>umfile.pp
<span class="gp">$ </span>cfa<span class="w"> </span>umfile2.nc
<span class="go">CF Field: surface_air_pressure(time(3), latitude(73), longitude(96)) Pa</span>
</pre></div>
</div>
</div>
</section>
<section id="mapping-of-pp-header-items-to-field-constructs">
<h3><a class="toc-backref" href="#id466">Mapping of PP header items to field constructs</a><a class="headerlink" href="#mapping-of-pp-header-items-to-field-constructs" title="Permalink to this headline">¶</a></h3>
<p>In addition to the creation of any CF constructs and properties that
are implied by the <a class="reference external" href="http://artefacts.ceda.ac.uk/badc_datadocs/um/umdp_F3-UMDPF3.pdf">PP and lookup header</a>,
certain lookup header items are stored, for convenience, as field
construct properties:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 35%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Header item</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Field construct property</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>LBEXP</p></td>
<td><p>Experiment identity</p></td>
<td><p>runid</p></td>
</tr>
<tr class="row-odd"><td><p>LBTIM</p></td>
<td><p>Time indicator</p></td>
<td><p>lbtim</p></td>
</tr>
<tr class="row-even"><td><p>LBPROC</p></td>
<td><p>Processing code</p></td>
<td><p>lbproc</p></td>
</tr>
<tr class="row-odd"><td><p>LBUSER(4)</p></td>
<td><p>STASH code</p></td>
<td><p>stash_code</p></td>
</tr>
<tr class="row-even"><td><p>LBUSER(7)</p></td>
<td><p>Internal submodel</p></td>
<td><p>submodel</p></td>
</tr>
</tbody>
</table>
<p>All such field construct properties are stored as strings. The value
of LBEXP is an integer that is decoded to a string identity before
being stored as a field construct property.</p>
</section>
<section id="stash-code-to-standard-name-mappings">
<h3><a class="toc-backref" href="#id467">STASH code to standard name mappings</a><a class="headerlink" href="#stash-code-to-standard-name-mappings" title="Permalink to this headline">¶</a></h3>
<p>The standard name and units properties of a field construct are
inferred from the STASH code of the PP and lookup headers. The text
database that maps header items to standard names and units is stored
in the file <code class="docutils literal notranslate"><span class="pre">etc/STASH_to_CF.txt</span></code> within the cf library
installation. The database is available as a dictionary, keyed by
submodel and stash code tuples, a copy of which is returned by the
<a class="reference internal" href="function/cf.stash2standard_name.html#cf.stash2standard_name" title="cf.stash2standard_name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.stash2standard_name</span></code></a> function. The database contains many STASH
codes without standard names nor units, and will not contain
user-defined STASH codes. However, modifying existing entries, or
adding new ones, is straight forward with the
<a class="reference internal" href="function/cf.load_stash2standard_name.html#cf.load_stash2standard_name" title="cf.load_stash2standard_name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.load_stash2standard_name</span></code></a> function.</p>
<div class="literal-block-wrapper docutils container" id="id320">
<div class="code-block-caption"><span class="caption-text"><em>Inspect the STASH to standard name database, and modify
it.</em></span><a class="headerlink" href="#id320" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stash</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">stash2standard_name</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stash</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
<span class="go">([&#39;THETA AFTER TIMESTEP                &#39;,</span>
<span class="go">  &#39;K&#39;,</span>
<span class="go">  None,</span>
<span class="go">  None,</span>
<span class="go">  &#39;air_potential_temperature&#39;,</span>
<span class="go">  {},</span>
<span class="go">  &#39;&#39;],)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stash</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)]</span>
<span class="go">([&#39;UNFILTERED OROGRAPHY                &#39;,</span>
<span class="go">  None,</span>
<span class="go">  708.0,</span>
<span class="go">  None,</span>
<span class="go">  &#39;&#39;,</span>
<span class="go">  {},</span>
<span class="go"> &#39;&#39;],)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stash</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
<span class="go">([&#39;U COMPNT OF WIND AFTER TIMESTEP     &#39;,</span>
<span class="go">  &#39;m s-1&#39;,</span>
<span class="go">  None,</span>
<span class="go">  None,</span>
<span class="go">  &#39;eastward_wind&#39;,</span>
<span class="go">  {},</span>
<span class="go">  &#39;true_latitude_longitude&#39;],</span>
<span class="go"> [&#39;U COMPNT OF WIND AFTER TIMESTEP     &#39;,</span>
<span class="go">  &#39;m s-1&#39;,</span>
<span class="go">  None,</span>
<span class="go">  None,</span>
<span class="go">  &#39;x_wind&#39;,</span>
<span class="go">  {},</span>
<span class="go">  &#39;rotated_latitude_longitude&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stash</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">152</span><span class="p">)]</span>
<span class="go">([&#39;DENSITY*R*R   C-P RHO LEVS:VAR DUMMY&#39;,</span>
<span class="go">  None,</span>
<span class="go">  401.0,</span>
<span class="go">  407.0,</span>
<span class="go">  &#39;&#39;,</span>
<span class="go">  {},</span>
<span class="go">  &#39;&#39;],</span>
<span class="go"> [&#39;RIVER DIRECTION                     &#39;,</span>
<span class="go">  None,</span>
<span class="go">  505.0,</span>
<span class="go">  None,</span>
<span class="go">  &#39;&#39;,</span>
<span class="go">  {},</span>
<span class="go">  &#39;&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">999</span><span class="p">)</span> <span class="ow">in</span> <span class="n">stash</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;new_STASH.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">new</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">new</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;1!999!My STASH code!1!!!ultraviolet_index!!&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">load_stash2standard_name</span><span class="p">(</span><span class="s1">&#39;new_STASH.txt&#39;</span><span class="p">,</span> <span class="n">merge</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_stash</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">stash2standard_name</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_stash</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">999</span><span class="p">)]</span>
<span class="go">([&#39;My STASH code&#39;,</span>
<span class="go">  &#39;1&#39;,</span>
<span class="go">  None,</span>
<span class="go">  None,</span>
<span class="go">  &#39;ultraviolet_index&#39;,</span>
<span class="go">  {},</span>
<span class="go">  &#39;&#39;],)</span>
</pre></div>
</div>
</div>
<p>Note that some STASH codes have multiple standard name mappings. This
could be due to the standard name being a function of other parts of
the header (as is the case for <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">2)</span></code>) and <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">152)</span></code>), or the
the STASH code only being valid for particular UM versions (as is the
case for <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">152)</span></code>).</p>
<hr class="docutils" />
</section>
</section>
<section id="statistical-collapses">
<span id="id85"></span><h2><a class="toc-backref" href="#id468"><strong>Statistical collapses</strong></a><a class="headerlink" href="#statistical-collapses" title="Permalink to this headline">¶</a></h2>
<p>Collapsing one or more dimensions reduces their size and replaces the
data along those axes with representative statistical values. The
result is a new field construct with consistent metadata for the
collapsed values. Collapses are carried with the <a class="reference internal" href="method/cf.Field.collapse.html#cf.Field.collapse" title="cf.Field.collapse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collapse</span></code></a>
method of the field construct.</p>
<p>By default all axes with size greater than 1 are collapsed completely
(i.e. to size 1) with a given <a class="reference internal" href="#collapse-methods"><span class="std std-ref">collapse method</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id321">
<div class="code-block-caption"><span class="caption-text"><em>Find the minimum of the entire data.</em></span><a class="headerlink" href="#id321" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;timeseries.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(120), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: time(120) = [1959-12-16 12:00:00, ..., 1969-11-16 00:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;minimum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(1), latitude(1), longitude(1)) K</span>
<span class="go">Cell methods    : area: mean time(1): latitude(1): longitude(1): minimum</span>
<span class="go">Dimension coords: time(1) = [1964-11-30 12:00:00]</span>
<span class="go">                : latitude(1) = [0.0] degrees_north</span>
<span class="go">                : longitude(1) = [180.0] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[198.9]]]</span>
</pre></div>
</div>
</div>
<p>In the above example, note that the operation has been recorded in a
new cell method construct (<code class="docutils literal notranslate"><span class="pre">time(1):</span> <span class="pre">latitude(1):</span> <span class="pre">longitude(1):</span>
<span class="pre">minimum</span></code>) in the output field construct, and the dimension coordinate
constructs each now have a single cell. The air pressure time
dimension was not included in the collapse because it already had size
1 in the original field construct.</p>
<p>The collapse can also be applied to any subset of the field
construct’s dimensions. In this case, the domain axis and coordinate
constructs for the non-collapsed dimensions remain the same. This is
implemented either with the <em>axes</em> keyword, or with a <a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#cell-methods">CF-netCDF cell
methods</a>-like syntax for describing both the collapse dimensions
and the collapse method in a single string. The latter syntax uses
<a class="reference internal" href="#construct-identities"><span class="std std-ref">construct identities</span></a> instead of netCDF
dimension names to identify the collapse axes.</p>
<p>Statistics may be created to represent variation over one dimension or
a combination of dimensions.</p>
<div class="literal-block-wrapper docutils container" id="id322">
<div class="code-block-caption"><span class="caption-text"><em>Two equivalent techniques for creating a field construct
of temporal maxima at each horizontal location.</em></span><a class="headerlink" href="#id322" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;maximum&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;T: maximum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(1), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean time(1): maximum</span>
<span class="go">Dimension coords: time(1) = [1964-11-30 12:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[310.6 309.1 309.9 311.2 310.4 310.1 310.7 309.6]</span>
<span class="go">  [310.  310.7 311.1 311.3 310.9 311.2 310.6 310. ]</span>
<span class="go">  [308.9 309.8 311.2 311.2 311.2 309.3 311.1 310.7]</span>
<span class="go">  [310.1 310.3 308.8 311.1 310.  311.3 311.2 309.7]</span>
<span class="go">  [310.9 307.9 310.3 310.4 310.8 310.9 311.3 309.3]]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id323">
<div class="code-block-caption"><span class="caption-text"><em>Find the horizontal maximum, with two equivalent
techniques.</em></span><a class="headerlink" href="#id323" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;maximum&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;X: Y: maximum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(120), latitude(1), longitude(1)) K</span>
<span class="go">Cell methods    : area: mean latitude(1): longitude(1): maximum</span>
<span class="go">Dimension coords: time(120) = [1959-12-16 12:00:00, ..., 1969-11-16 00:00:00]</span>
<span class="go">                : latitude(1) = [0.0] degrees_north</span>
<span class="go">                : longitude(1) = [180.0] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
</pre></div>
</div>
</div>
<p>Variation over horizontal area may also be specified by the special
identity <code class="docutils literal notranslate"><span class="pre">'area'</span></code>. This may be used for any horizontal coordinate
reference system.</p>
<div class="literal-block-wrapper docutils container" id="id324">
<div class="code-block-caption"><span class="caption-text"><em>Find the horizontal maximum using the special identity
‘area’.</em></span><a class="headerlink" href="#id324" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;area: maximum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(120), latitude(1), longitude(1)) K</span>
<span class="go">Cell methods    : area: mean area: maximum</span>
<span class="go">Dimension coords: time(120) = [1959-12-16 12:00:00, ..., 1969-11-16 00:00:00]</span>
<span class="go">                : latitude(1) = [0.0] degrees_north</span>
<span class="go">                : longitude(1) = [180.0] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
</pre></div>
</div>
</div>
<section id="collapse-methods">
<span id="id86"></span><h3><a class="toc-backref" href="#id469">Collapse methods</a><a class="headerlink" href="#collapse-methods" title="Permalink to this headline">¶</a></h3>
<p>The following collapse methods are available, over any subset of the
domain axes. The “Cell method” column in the table gives the method
name, defined by the CF conventions, of the new cell method construct
(if one is created).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 43%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Cell method</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'sample_size'</span></code></p></td>
<td><p>The sample size, <span class="math notranslate nohighlight">\(N\)</span>, equal to the
number of non-missing values.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">point</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'maximum'</span></code></p></td>
<td><p>The maximum of the non-missing values.</p>
<div class="math notranslate nohighlight">
\[m_x=\max\{x_0, \ldots, x_N\}\]</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">maximum</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'minimum'</span></code></p></td>
<td><p>The minimum of the non-missing values.</p>
<div class="math notranslate nohighlight">
\[m_n=\min\{x_0, \ldots, x_N\}\]</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">minimum</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'maximum_absolute_value'</span></code></p></td>
<td><p>The maximum of the non-missing absolute
values.</p>
<div class="math notranslate nohighlight">
\[\max\{|x_0|, \ldots, |x_N|\}\]</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">maximum_absolute_value</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'minimum_absolute_value'</span></code></p></td>
<td><p>The minimum of the non-missing absolute
values.</p>
<div class="math notranslate nohighlight">
\[\min\{|x_0|, \ldots, |x_N|\}\]</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">minimum_absolute_value</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'mid_range'</span></code></p></td>
<td><p>The average of the maximum and the
minimum of the non-missing values.</p>
<div class="math notranslate nohighlight">
\[\frac{m_x + m_n}{2}\]</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">mid_range</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'range'</span></code></p></td>
<td><p>The absolute difference between the
maximum and the minimum of the
non-missing values.</p>
<div class="math notranslate nohighlight">
\[m_x - m_n\]</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">range</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'median'</span></code></p></td>
<td><p>The median of the <span class="math notranslate nohighlight">\(N\)</span> non-missing
values.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">median</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'sum_of_weights'</span></code></p></td>
<td><p>The sum of the <span class="math notranslate nohighlight">\(N\)</span> weights
<span class="math notranslate nohighlight">\(w_i\)</span> that correspond to
non-missing values.</p>
<div class="math notranslate nohighlight">
\[V_{1}=\sum_{i=1}^{N} w_i\]</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">sum</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'sum_of_weights2'</span></code></p></td>
<td><p>The sum of the squares of the <span class="math notranslate nohighlight">\(N\)</span>
weights <span class="math notranslate nohighlight">\(w_i\)</span> that correspond to
non-missing values.</p>
<div class="math notranslate nohighlight">
\[V_{2}=\sum_{i=1}^{N} w_i^{2}\]</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">sum</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'sum'</span></code></p></td>
<td><p>The unweighted sum of the <span class="math notranslate nohighlight">\(N\)</span>
non-missing values <span class="math notranslate nohighlight">\(x_i\)</span> is</p>
<div class="math notranslate nohighlight">
\[t=\sum_{i=1}^{N} x_i\]</div>
<p>The weighted sum of the <span class="math notranslate nohighlight">\(N\)</span>
non-missing values <span class="math notranslate nohighlight">\(x_i\)</span> with
corresponding weights <span class="math notranslate nohighlight">\(w_i\)</span> is</p>
<div class="math notranslate nohighlight">
\[\hat{t}=\sum_{i=1}^{N} w_i x_i\]</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">sum</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'sum_of_squares'</span></code></p></td>
<td><p>The unweighted sum of the squares of the
<span class="math notranslate nohighlight">\(N\)</span> non-missing values <span class="math notranslate nohighlight">\(x_i\)</span>
is</p>
<div class="math notranslate nohighlight">
\[t_2=\sum_{i=1}^{N} x_{i}^{2}\]</div>
<p>The weighted sum of the squares of the
<span class="math notranslate nohighlight">\(N\)</span> non-missing values <span class="math notranslate nohighlight">\(x_i\)</span>
with corresponding weights <span class="math notranslate nohighlight">\(w_i\)</span>
is</p>
<div class="math notranslate nohighlight">
\[\hat{t}_2=\sum_{i=1}^{N}
w_i x_{i}^{2}\]</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">sum_of_squares</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'integral'</span></code></p></td>
<td><p>The <a class="reference internal" href="#collapse-weights"><span class="std std-ref">weighted</span></a>
sum of the <span class="math notranslate nohighlight">\(N\)</span> non-missing values
<span class="math notranslate nohighlight">\(x_i\)</span> with corresponding cell
measures <span class="math notranslate nohighlight">\(m_i\)</span>.</p>
<div class="math notranslate nohighlight">
\[i=\sum_{i=1}^{N} m_i x_i\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The integral differs from a
weighted sum in that the units
of the measures are
incorporated into the result.</p>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">sum</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'mean'</span></code></p></td>
<td><p>The unweighted mean of the <span class="math notranslate nohighlight">\(N\)</span>
non-missing values <span class="math notranslate nohighlight">\(x_i\)</span> is</p>
<div class="math notranslate nohighlight">
\[\mu=\frac{1}{N}\sum_{i=1}^{N}
x_i\]</div>
<p>The <a class="reference internal" href="#collapse-weights"><span class="std std-ref">weighted</span></a>
mean of the <span class="math notranslate nohighlight">\(N\)</span> non-missing values
<span class="math notranslate nohighlight">\(x_i\)</span> with corresponding weights
<span class="math notranslate nohighlight">\(w_i\)</span>. is</p>
<div class="math notranslate nohighlight">
\[\hat{\mu}=\frac{1}{V_{1}}
\sum_{i=1}^{N}
w_i x_i\]</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">mean</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'mean_absolute_value'</span></code></p></td>
<td><p>The unweighted mean of the <span class="math notranslate nohighlight">\(N\)</span>
non-missing absolute values <span class="math notranslate nohighlight">\(x_i\)</span>
is</p>
<div class="math notranslate nohighlight">
\[\mu_{abs}=\frac{1}{N}
\sum_{i=1}^{N}|x_i|\]</div>
<p>The <a class="reference internal" href="#collapse-weights"><span class="std std-ref">weighted</span></a>
mean of the <span class="math notranslate nohighlight">\(N\)</span> non-missing
absolute values <span class="math notranslate nohighlight">\(x_i\)</span> with
corresponding weights <span class="math notranslate nohighlight">\(w_i\)</span> is</p>
<div class="math notranslate nohighlight">
\[\hat{\mu}_{abs}=
\frac{1}{V_{1}}
\sum_{i=1}^{N} w_i |x_i|\]</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">mean_absolute_value</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'mean_of_upper_decile'</span></code></p></td>
<td><p>The weighted or unweighted mean of the
upper group of data values defined by
the upper tenth of their distribution</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mean_of_upper_decile</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'variance'</span></code></p></td>
<td><p>The unweighted variance of the <span class="math notranslate nohighlight">\(N\)</span>
non-missing values <span class="math notranslate nohighlight">\(x_i\)</span> and with
<span class="math notranslate nohighlight">\(N-ddof\)</span> degrees of freedom
(<span class="math notranslate nohighlight">\(ddof\ge0\)</span>) is</p>
<div class="math notranslate nohighlight">
\[s_{N-ddof}^{2}=
\frac{1}{N-ddof}
\sum_{i=1}^{N} (x_i - \mu)^2\]</div>
<p>The unweighted biased estimate of the
variance (<span class="math notranslate nohighlight">\(s_{N}^{2}\)</span>) is given by
<span class="math notranslate nohighlight">\(ddof=0\)</span> and the unweighted
unbiased estimate of the variance using
Bessel’s correction
(<span class="math notranslate nohighlight">\(s^{2}=s_{N-1}^{2}\)</span>) is given by
<span class="math notranslate nohighlight">\(ddof=1\)</span>.</p>
<p>The <a class="reference internal" href="#collapse-weights"><span class="std std-ref">weighted</span></a>
biased estimate of the variance of the
<span class="math notranslate nohighlight">\(N\)</span> non-missing values <span class="math notranslate nohighlight">\(x_i\)</span>
with corresponding weights <span class="math notranslate nohighlight">\(w_i\)</span>
is</p>
<div class="math notranslate nohighlight">
\[\hat{s}_{N}^{2}=
\frac{1}{V_{1}}
\sum_{i=1}^{N}
w_i(x_i -
\hat{\mu})^{2}\]</div>
<p>The <a class="reference internal" href="#collapse-weights"><span class="std std-ref">weighted</span></a>
unbiased estimate of the variance of the
<span class="math notranslate nohighlight">\(N\)</span> non-missing values <span class="math notranslate nohighlight">\(x_i\)</span>
with corresponding weights <span class="math notranslate nohighlight">\(w_i\)</span>
is</p>
<div class="math notranslate nohighlight">
\[\hat{s}^{2}=\frac{1}{V_{1} -
(V_{1}/V_{2})}
\sum_{i=1}^{N}
w_i(x_i -
\hat{\mu})^{2}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The weights used in the
variance calculations are
assumed to be non-random
reliability weights, as
opposed to frequency weights.</p>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">variance</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'standard_deviation'</span></code></p></td>
<td><p>The standard deviation is the square
root of the unweighted or
<a class="reference internal" href="#collapse-weights"><span class="std std-ref">weighted</span></a>
variance.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">standard_deviation</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'root_mean_square'</span></code></p></td>
<td><p>The unweighted root mean square of the
<span class="math notranslate nohighlight">\(N\)</span> non-missing values
<span class="math notranslate nohighlight">\(x_i\)</span> is</p>
<div class="math notranslate nohighlight">
\[r=\sqrt{\frac{1}{N}
\sum_{i=1}^{N}
x_{i}^2}\]</div>
<p>The <a class="reference internal" href="#collapse-weights"><span class="std std-ref">weighted</span></a>
root mean square of the <span class="math notranslate nohighlight">\(N\)</span>
non-missing values <span class="math notranslate nohighlight">\(x_i\)</span> with
corresponding weights <span class="math notranslate nohighlight">\(w_i\)</span> is</p>
<div class="math notranslate nohighlight">
\[\hat{r}=\sqrt{
\frac{1}{V_{1}}
\sum_{i=1}^{N} w_i
x_{i}^2}\]</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">root_mean_square</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="data-type-and-missing-data">
<span id="id87"></span><h3><a class="toc-backref" href="#id470">Data type and missing data</a><a class="headerlink" href="#data-type-and-missing-data" title="Permalink to this headline">¶</a></h3>
<p>In all collapses, missing data array elements are accounted for in the
calculation.</p>
<p>Any collapse method that involves a calculation (such as calculating a
mean), as opposed to just selecting a value (such as finding a
maximum), will return a field containing double precision floating
point numbers. If this is not desired then the data type can be reset
after the collapse with the <a class="reference internal" href="attribute/cf.Field.dtype.html#cf.Field.dtype" title="cf.Field.dtype"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dtype</span></code></a> attribute of the field
construct.</p>
</section>
<section id="collapse-weights">
<span id="id88"></span><h3><a class="toc-backref" href="#id471">Collapse weights</a><a class="headerlink" href="#collapse-weights" title="Permalink to this headline">¶</a></h3>
<p>For weights to be incorporated in the collapse, the axes to be
weighted must be identified with the <em>weights</em> keyword. A collapse by
a particular method is either never weighted, or may be weighted, or
is always weighted, as described in the following table:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 44%" />
<col style="width: 44%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Weighted</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'maximum'</span></code></p></td>
<td><p>The maximum of the values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'minimum'</span></code></p></td>
<td><p>The minimum of the values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'maximum_absolute_value'</span></code></p></td>
<td><p>The maximum of the absolute.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'minimum_absolute_value'</span></code></p></td>
<td><p>The minimum of the absolute.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'mid_range'</span></code></p></td>
<td><p>The average of the maximum
and the minimum of the
values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'range'</span></code></p></td>
<td><p>The absolute difference
between the maximum and the
minimum of the values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'median'</span></code></p></td>
<td><p>The median of the values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'sum'</span></code></p></td>
<td><p>The sum of the values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'sum_of_squares'</span></code></p></td>
<td><p>The sum of the squares of
values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'sample_size'</span></code></p></td>
<td><p>The sample size, i.e. the
number of non-missing
values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'sum_of_weights'</span></code></p></td>
<td><p>The sum of weights, as
would be used for other
calculations.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'sum_of_weights2'</span></code></p></td>
<td><p>The sum of squares of
weights, as would be used
for other calculations.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'mean'</span></code></p></td>
<td><p>The weighted or unweighted
mean of the values.</p></td>
<td><p>May be</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'mean_absolute_value'</span></code></p></td>
<td><p>The mean of the absolute
values.</p></td>
<td><p>May be</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'mean_of_upper_decile'</span></code></p></td>
<td><p>The mean of the upper group
of data values defined by
the upper tenth of their
distribution.</p></td>
<td><p>May be</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'variance'</span></code></p></td>
<td><p>The weighted or unweighted
variance of the values, with
a given number of degrees of
freedom.</p></td>
<td><p>May be</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'standard_deviation'</span></code></p></td>
<td><p>The weighted or unweighted
standard deviation of the
values with a given number
of degrees of freedom.</p></td>
<td><p>May be</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'root_mean_square'</span></code></p></td>
<td><p>The square root of the
weighted or unweighted mean
of the squares of the
values.</p></td>
<td><p>May be</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'integral'</span></code></p></td>
<td><p>The integral of values.</p></td>
<td><p>Always</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Collapse methods that are “Never” weighted ignore the <em>weights</em>
parameter, even if it is set.</p></li>
<li><p>Collapse methods that “May be” weighted will only be weighted if the
<em>weights</em> parameter is set.</p></li>
<li><p>Collapse methods that are “Always” weighted require the <em>weights</em>
parameter to be set.</p></li>
</ul>
<p>Weights are either derived from the field construct’s metadata (such
as cell sizes), or may be provided explicitly in the form of other
field constructs containing data of weights values. In either case,
the weights actually used are those derived by the <a class="reference internal" href="method/cf.Field.weights.html#cf.Field.weights" title="cf.Field.weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code></a>
method of the field construct called with the same <em>weights</em> keyword
value. Collapsed axes that are not identified by the <em>weights</em> keyword
are unweighted during the collapse operation.</p>
<div class="literal-block-wrapper docutils container" id="id325">
<div class="code-block-caption"><span class="caption-text"><em>Create a weighted time average.</em></span><a class="headerlink" href="#id325" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;T: mean&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(1), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean time(1): mean</span>
<span class="go">Dimension coords: time(1) = [1964-11-30 12:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[254.03120723 255.89723515 253.06490556 254.17815494 255.18458801 253.3684369  253.26624692 253.63818779]</span>
<span class="go">  [248.92058582 253.99597591 259.67957843 257.08967972 252.57333698 252.5746236  258.90938954 253.86939502]</span>
<span class="go">  [255.94716671 254.77330961 254.35929373 257.91478237 251.87670408 252.72723789 257.26038872 258.19698878]</span>
<span class="go">  [258.08639474 254.8087873  254.9881741  250.98064604 255.3513003  256.66337257 257.86895702 259.49299206]</span>
<span class="go">  [263.80016425 253.35825349 257.8026006  254.3173556  252.2061867  251.74150014 255.60930742 255.06260608]]]</span>
</pre></div>
</div>
</div>
<p>To inspect the weights, call the  <a class="reference internal" href="method/cf.Field.weights.html#cf.Field.weights" title="cf.Field.weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code></a> method directly.</p>
<div class="literal-block-wrapper docutils container" id="id326">
<div class="code-block-caption"><span class="caption-text"><em>Create and view weights derived from the field construct’s
time axis.</em></span><a class="headerlink" href="#id326" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">weights</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">Field: long_name=weights (ncvar%air_potential_temperature)</span>
<span class="go">----------------------------------------------------------</span>
<span class="go">Data            : long_name=weights(time(120)) d</span>
<span class="go">Dimension coords: time(120) = [1959-12-16 12:00:00, ..., 1969-11-16 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[31. 31. 29. 31. 30. 31. 30. 31. 31. 30. 31. 30. 31. 31. 28. 31. 30. 31.</span>
<span class="go"> 30. 31. 31. 30. 31. 30. 31. 31. 28. 31. 30. 31. 30. 31. 31. 30. 31. 30.</span>
<span class="go"> 31. 31. 28. 31. 30. 31. 30. 31. 31. 30. 31. 30. 31. 31. 29. 31. 30. 31.</span>
<span class="go"> 30. 31. 31. 30. 31. 30. 31. 31. 28. 31. 30. 31. 30. 31. 31. 30. 31. 30.</span>
<span class="go"> 31. 31. 28. 31. 30. 31. 30. 31. 31. 30. 31. 30. 31. 31. 28. 31. 30. 31.</span>
<span class="go"> 30. 31. 31. 30. 31. 30. 31. 31. 29. 31. 30. 31. 30. 31. 31. 30. 31. 30.</span>
<span class="go"> 31. 31. 28. 31. 30. 31. 30. 31. 31. 30. 31. 30.]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id327">
<div class="code-block-caption"><span class="caption-text"><em>Calculate the mean over the time and latitude axes, with
weights only applied to the latitude axis.</em></span><a class="headerlink" href="#id327" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;T: Y: mean&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(1), latitude(1), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean time(1): latitude(1): mean</span>
<span class="go">Dimension coords: time(1) = [1964-11-30 12:00:00]</span>
<span class="go">                : latitude(1) = [0.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[256.15819444 254.625      255.73666667 255.43041667 253.19444444 253.31277778 256.68236111 256.42055556]]]</span>
</pre></div>
</div>
</div>
<p>Specifying weighting by horizontal cell area may also use the special
<code class="docutils literal notranslate"><span class="pre">'area'</span></code> syntax.</p>
<div class="literal-block-wrapper docutils container" id="id328">
<div class="code-block-caption"><span class="caption-text"><em>Alternative syntax for specifying area weights.</em></span><a class="headerlink" href="#id328" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;area: mean&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(120), latitude(1), longitude(1)) K</span>
<span class="go">Cell methods    : area: mean area: mean</span>
<span class="go">Dimension coords: time(120) = [1959-12-16 12:00:00, ..., 1969-11-16 00:00:00]</span>
<span class="go">                : latitude(1) = [0.0] degrees_north</span>
<span class="go">                : longitude(1) = [180.0] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
</pre></div>
</div>
</div>
<p>An alternative technique for specifying weights is to set the
<em>weights</em> keyword to the output of a call to the <a class="reference internal" href="method/cf.Field.weights.html#cf.Field.weights" title="cf.Field.weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code></a>
method.</p>
<div class="literal-block-wrapper docutils container" id="id329">
<div class="code-block-caption"><span class="caption-text"><em>Alternative syntax for specifying weights.</em></span><a class="headerlink" href="#id329" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;area: mean&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">weights</span><span class="p">(</span><span class="s1">&#39;area&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(120), latitude(1), longitude(1)) K</span>
<span class="go">Cell methods    : area: mean area: mean</span>
<span class="go">Dimension coords: time(120) = [1959-12-16 12:00:00, ..., 1969-11-16 00:00:00]</span>
<span class="go">                : latitude(1) = [0.0] degrees_north</span>
<span class="go">                : longitude(1) = [180.0] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
</pre></div>
</div>
</div>
<p>See the <a class="reference internal" href="method/cf.Field.weights.html#cf.Field.weights" title="cf.Field.weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code></a> method for full details on how weights may be
specified.</p>
</section>
<section id="multiple-collapses">
<span id="id89"></span><h3><a class="toc-backref" href="#id472">Multiple collapses</a><a class="headerlink" href="#multiple-collapses" title="Permalink to this headline">¶</a></h3>
<p>Multiple collapses normally require multiple calls to
<a class="reference internal" href="method/cf.Field.collapse.html#cf.Field.collapse" title="cf.Field.collapse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collapse</span></code></a>: one on the original field construct and then one on
each interim field construct.</p>
<div class="literal-block-wrapper docutils container" id="id330">
<div class="code-block-caption"><span class="caption-text"><em>Calculate the temporal maximum of the weighted areal
means using two independent calls.</em></span><a class="headerlink" href="#id330" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;area: mean&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;T: maximum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(1), latitude(1), longitude(1)) K</span>
<span class="go">Cell methods    : area: mean latitude(1): longitude(1): mean time(1): maximum</span>
<span class="go">Dimension coords: time(1) = [1964-11-30 12:00:00]</span>
<span class="go">                : latitude(1) = [0.0] degrees_north</span>
<span class="go">                : longitude(1) = [180.0] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[271.77199724]]]</span>
</pre></div>
</div>
</div>
<p>If preferred, multiple collapses may be carried out in a single call
to <a class="reference internal" href="method/cf.Field.collapse.html#cf.Field.collapse" title="cf.Field.collapse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collapse</span></code></a> by using the <a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#cell-methods">CF-netCDF cell methods</a>-like
syntax (note that the colon (<code class="docutils literal notranslate"><span class="pre">:</span></code>) is only used after the construct
identity that specifies each axis, and a space delimits the separate
collapses).</p>
<div class="literal-block-wrapper docutils container" id="id331">
<div class="code-block-caption"><span class="caption-text"><em>Calculate the temporal maximum of the weighted areal
means in a single call, using the cf-netCDF cell
methods-like syntax.</em></span><a class="headerlink" href="#id331" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;area: mean T: maximum&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[271.77199724]]]</span>
</pre></div>
</div>
</div>
</section>
<section id="grouped-collapses">
<span id="id90"></span><h3><a class="toc-backref" href="#id473">Grouped collapses</a><a class="headerlink" href="#grouped-collapses" title="Permalink to this headline">¶</a></h3>
<p>A grouped collapse is one for which an axis is not collapsed
completely to size 1. Instead the collapse axis is partitioned into
non-overlapping groups and each group is collapsed to size 1. The
resulting axis will generally have more than one element. For example,
creating 12 annual means from a timeseries of 120 months would be a
grouped collapse. The groups do not need to be created from adjacent
cells, as would be the case when creating 12 multi-annual monthly
means from a timeseries of 120 months.</p>
<p>Selected statistics for overlapping groups can be calculated with the
<a class="reference internal" href="method/cf.Field.moving_window.html#cf.Field.moving_window" title="cf.Field.moving_window"><code class="xref py py-obj docutils literal notranslate"><span class="pre">moving_window</span></code></a> method of the field construct.</p>
<p>The <em>group</em> keyword of <a class="reference internal" href="method/cf.Field.collapse.html#cf.Field.collapse" title="cf.Field.collapse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collapse</span></code></a> defines the size of the
groups. Groups can be defined in a variety of ways, including with
<a class="reference internal" href="class/cf.Query.html#cf.Query" title="cf.Query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Query</span></code></a>, <a class="reference internal" href="class/cf.TimeDuration.html#cf.TimeDuration" title="cf.TimeDuration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.TimeDuration</span></code></a> (see the <a class="reference internal" href="#time-duration"><span class="std std-ref">Time duration</span></a> section)
and <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Data</span></code></a> instances.</p>
<p>An element of the collapse axis can not be a member of more than one
group, and may be a member of no groups. Elements that are not
selected by the <em>group</em> keyword are excluded from the result.</p>
<div class="literal-block-wrapper docutils container" id="id332">
<div class="code-block-caption"><span class="caption-text"><em>Create annual maxima from a time series, defining a year
to start on 1st January.</em></span><a class="headerlink" href="#id332" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span>
<span class="go">&lt;CF TimeDuration: P1Y (Y-12-01 00:00:00)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;T: maximum&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(10), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean time(10): maximum</span>
<span class="go">Dimension coords: time(10) = [1960-06-01 00:00:00, ..., 1969-06-01 12:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id333">
<div class="code-block-caption"><span class="caption-text"><em>Find the maximum of each group of 6 elements along an
axis.</em></span><a class="headerlink" href="#id333" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;T: maximum&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(20), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean time(20): maximum</span>
<span class="go">Dimension coords: time(20) = [1960-03-01 12:00:00, ..., 1969-08-31 12:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id334">
<div class="code-block-caption"><span class="caption-text"><em>Create December, January, February maxima from a time series.</em></span><a class="headerlink" href="#id334" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;T: maximum&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">djf</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(10), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean time(10): maximum time(10): maximum</span>
<span class="go">Dimension coords: time(10) = [1960-01-15 12:00:00, ..., 1969-01-15 00:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id335">
<div class="code-block-caption"><span class="caption-text"><em>Create maxima for each 3-month season of a timeseries
(DJF, MAM, JJA, SON).</em></span><a class="headerlink" href="#id335" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">seasons</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span>
<span class="go">[&lt;CF Query: month[(ge 12) | (le 2)]&gt;</span>
<span class="go"> &lt;CF Query: month(wi (3, 5))&gt;,</span>
<span class="go"> &lt;CF Query: month(wi (6, 8))&gt;,</span>
<span class="go"> &lt;CF Query: month(wi (9, 11))&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;T: maximum&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(40), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean time(40): maximum time(40): maximum</span>
<span class="go">Dimension coords: time(40) = [1960-01-15 12:00:00, ..., 1969-10-16 12:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id336">
<div class="code-block-caption"><span class="caption-text"><em>Calculate zonal means for the western and eastern
hemispheres.</em></span><a class="headerlink" href="#id336" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;X: mean&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(120), latitude(5), longitude(2)) K</span>
<span class="go">Cell methods    : area: mean longitude(2): mean longitude(2): mean</span>
<span class="go">Dimension coords: time(120) = [1959-12-16 12:00:00, ..., 1969-11-16 00:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(2) = [90.0, 270.0] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
</pre></div>
</div>
</div>
<p>Groups can be further described with the <em>group_span</em> (to include
groups whose actual span is not equal to a given value) and the
<em>group_contiguous</em> (to include non-contiguous groups, or any
contiguous group containing overlapping cells) keywords of
<a class="reference internal" href="method/cf.Field.collapse.html#cf.Field.collapse" title="cf.Field.collapse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collapse</span></code></a>.</p>
</section>
<section id="climatological-statistics">
<span id="id91"></span><h3><a class="toc-backref" href="#id474">Climatological statistics</a><a class="headerlink" href="#climatological-statistics" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#climatological-statistics">Climatological statistics</a> may be derived from corresponding
portions of the annual cycle in a set of years (e.g. the average
January temperatures in the climatology of 1961-1990, where the values
are derived by averaging the 30 Januarys from the separate years); or
from corresponding portions of the diurnal cycle in a set of days
(e.g. the average temperatures for each hour in the day for May
1997). A diurnal climatology may also be combined with a multiannual
climatology (e.g. the minimum temperature for each hour of the average
day in May from a 1961-1990 climatology).</p>
<p>Calculation requires two or three collapses, depending on the quantity
being created, all of which are grouped collapses. Each collapse
method needs to indicate its climatological nature with one of the
following qualifiers,</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 41%" />
<col style="width: 59%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method qualifier</p></th>
<th class="head"><p>Associated keyword</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">within</span> <span class="pre">years</span></code></p></td>
<td><p><em>within_years</em></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">within</span> <span class="pre">days</span></code></p></td>
<td><p><em>within_days</em></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">over</span> <span class="pre">years</span></code></p></td>
<td><p><em>over_years</em> (optional)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">over</span> <span class="pre">days</span></code></p></td>
<td><p><em>over_days</em> (optional)</p></td>
</tr>
</tbody>
</table>
<p>and the associated keyword to <a class="reference internal" href="method/cf.Field.collapse.html#cf.Field.collapse" title="cf.Field.collapse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collapse</span></code></a> specifies how the
method is to be applied.</p>
<div class="literal-block-wrapper docutils container" id="id337">
<div class="code-block-caption"><span class="caption-text"><em>Calculate the multiannual average of the seasonal means.</em></span><a class="headerlink" href="#id337" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;T: mean within years T: mean over years&#39;</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">within_years</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">seasons</span><span class="p">(),</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(4), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean time(4): mean within years time(4): mean over years</span>
<span class="go">Dimension coords: time(4) = [1960-01-15 12:00:00, ..., 1960-10-16 12:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">coordinate</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">datetime_array</span><span class="p">)</span>
<span class="go">[[cftime.DatetimeGregorian(1959-12-01 00:00:00) cftime.DatetimeGregorian(1969-03-01 00:00:00)]</span>
<span class="go"> [cftime.DatetimeGregorian(1960-03-01 00:00:00) cftime.DatetimeGregorian(1969-06-01 00:00:00)]</span>
<span class="go"> [cftime.DatetimeGregorian(1960-06-01 00:00:00) cftime.DatetimeGregorian(1969-09-01 00:00:00)]</span>
<span class="go"> [cftime.DatetimeGregorian(1960-09-01 00:00:00) cftime.DatetimeGregorian(1969-12-01 00:00:00)]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id338">
<div class="code-block-caption"><span class="caption-text"><em>Calculate the multiannual variance of the seasonal
minima. Note that the units of the result have been
changed from ‘K’ to ‘K2’.</em></span><a class="headerlink" href="#id338" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;T: minimum within years T: variance over years&#39;</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">within_years</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">seasons</span><span class="p">(),</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(4), latitude(5), longitude(8)) K2</span>
<span class="go">Cell methods    : area: mean time(4): minimum within years time(4): variance over years</span>
<span class="go">Dimension coords: time(4) = [1960-01-15 12:00:00, ..., 1960-10-16 12:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">coordinate</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">datetime_array</span><span class="p">)</span>
<span class="go">[[cftime.DatetimeGregorian(1959-12-01 00:00:00) cftime.DatetimeGregorian(1969-03-01 00:00:00)]</span>
<span class="go"> [cftime.DatetimeGregorian(1960-03-01 00:00:00) cftime.DatetimeGregorian(1969-06-01 00:00:00)]</span>
<span class="go"> [cftime.DatetimeGregorian(1960-06-01 00:00:00) cftime.DatetimeGregorian(1969-09-01 00:00:00)]</span>
<span class="go"> [cftime.DatetimeGregorian(1960-09-01 00:00:00) cftime.DatetimeGregorian(1969-12-01 00:00:00)]]</span>
</pre></div>
</div>
</div>
<p>When collapsing over years, it is assumed by default that the each
portion of the annual cycle is collapsed over all years that are
present. This is the case in the above two examples. It is possible,
however, to restrict the years to be included, or group them into
chunks, with the <em>over_years</em> keyword to <a class="reference internal" href="method/cf.Field.collapse.html#cf.Field.collapse" title="cf.Field.collapse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collapse</span></code></a>.</p>
<div class="literal-block-wrapper docutils container" id="id339">
<div class="code-block-caption"><span class="caption-text"><em>Calculate the multiannual average of the seasonal means
in 5 year chunks.</em></span><a class="headerlink" href="#id339" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;T: mean within years T: mean over years&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">within_years</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">seasons</span><span class="p">(),</span> <span class="n">over_years</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(8), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean time(8): mean within years time(8): mean over years</span>
<span class="go">Dimension coords: time(8) = [1960-01-15 12:00:00, ..., 1965-10-16 12:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">coordinate</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">datetime_array</span><span class="p">)</span>
<span class="go">[[cftime.DatetimeGregorian(1959-12-01 00:00:00) cftime.DatetimeGregorian(1964-03-01 00:00:00)]</span>
<span class="go"> [cftime.DatetimeGregorian(1960-03-01 00:00:00) cftime.DatetimeGregorian(1964-06-01 00:00:00)]</span>
<span class="go"> [cftime.DatetimeGregorian(1960-06-01 00:00:00) cftime.DatetimeGregorian(1964-09-01 00:00:00)]</span>
<span class="go"> [cftime.DatetimeGregorian(1960-09-01 00:00:00) cftime.DatetimeGregorian(1964-12-01 00:00:00)]</span>
<span class="go"> [cftime.DatetimeGregorian(1964-12-01 00:00:00) cftime.DatetimeGregorian(1969-03-01 00:00:00)]</span>
<span class="go"> [cftime.DatetimeGregorian(1965-03-01 00:00:00) cftime.DatetimeGregorian(1969-06-01 00:00:00)]</span>
<span class="go"> [cftime.DatetimeGregorian(1965-06-01 00:00:00) cftime.DatetimeGregorian(1969-09-01 00:00:00)]</span>
<span class="go"> [cftime.DatetimeGregorian(1965-09-01 00:00:00) cftime.DatetimeGregorian(1969-12-01 00:00:00)]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id340">
<div class="code-block-caption"><span class="caption-text"><em>Calculate the multiannual average of the seasonal means,
restricting the years from 1963 to 1968.</em></span><a class="headerlink" href="#id340" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;T: mean within years T: mean over years&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">within_years</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">seasons</span><span class="p">(),</span> <span class="n">over_years</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">year</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">wi</span><span class="p">(</span><span class="mi">1963</span><span class="p">,</span> <span class="mi">1968</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(4), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean time(4): mean within years time(4): mean over years</span>
<span class="go">Dimension coords: time(4) = [1963-01-15 00:00:00, ..., 1963-10-16 12:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">coordinate</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">datetime_array</span><span class="p">)</span>
<span class="go">[[cftime.DatetimeGregorian(1962-12-01 00:00:00) cftime.DatetimeGregorian(1968-03-01 00:00:00)]</span>
<span class="go"> [cftime.DatetimeGregorian(1963-03-01 00:00:00) cftime.DatetimeGregorian(1968-06-01 00:00:00)]</span>
<span class="go"> [cftime.DatetimeGregorian(1963-06-01 00:00:00) cftime.DatetimeGregorian(1968-09-01 00:00:00)]</span>
<span class="go"> [cftime.DatetimeGregorian(1963-09-01 00:00:00) cftime.DatetimeGregorian(1968-12-01 00:00:00)]]</span>
</pre></div>
</div>
</div>
<p>Similarly for collapses over days, it is assumed by default that the
each portion of the diurnal cycle is collapsed over all days that are
present, But it is possible to restrict the days to be included, or
group them into chunks, with the <em>over_days</em> keyword to
<a class="reference internal" href="method/cf.Field.collapse.html#cf.Field.collapse" title="cf.Field.collapse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collapse</span></code></a>.</p>
<p>The calculation can be done with multiple collapse calls, which can be
useful if the interim stages are needed independently, but be aware
that the interim field constructs will have non-CF-compliant cell
method constructs.</p>
<div class="literal-block-wrapper docutils container" id="id341">
<div class="code-block-caption"><span class="caption-text"><em>Calculate the multiannual maximum of the seasonal
standard deviations with two separate collapse calls.</em></span><a class="headerlink" href="#id341" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;T: standard_deviation within years&#39;</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">within_years</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">seasons</span><span class="p">(),</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(40), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean time(40): standard_deviation within years</span>
<span class="go">Dimension coords: time(40) = [1960-01-15 12:00:00, ..., 1969-10-16 12:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;T: maximum over years&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(4), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean time(4): standard_deviation within years time(4): maximum over years</span>
<span class="go">Dimension coords: time(4) = [1960-01-15 12:00:00, ..., 1960-10-16 12:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="other-statistical-operations">
<h2><a class="toc-backref" href="#id475"><strong>Other statistical operations</strong></a><a class="headerlink" href="#other-statistical-operations" title="Permalink to this headline">¶</a></h2>
<section id="cumulative-sums">
<span id="id92"></span><h3><a class="toc-backref" href="#id476">Cumulative sums</a><a class="headerlink" href="#cumulative-sums" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="method/cf.Field.cumsum.html#cf.Field.cumsum" title="cf.Field.cumsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cumsum</span></code></a> method of the field construct calculates the
cumulative sum of elements along a given axis. The cell bounds of the
axis are updated to describe the ranges over which the sums apply, and
a new <code class="docutils literal notranslate"><span class="pre">sum</span></code> cell method construct is added to the resulting field
construct.</p>
<div class="literal-block-wrapper docutils container" id="id342">
<div class="code-block-caption"><span class="caption-text"><em>Calculate cumulative sums along the “T” axis, showing
the cell bounds before and after the operation.</em></span><a class="headerlink" href="#id342" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;timeseries.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(120), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: time(120) = [1959-12-16 12:00:00, ..., 1969-11-16 00:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: air_potential_temperature (ncvar%air_potential_temperature)</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">Data            : air_potential_temperature(time(120), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean time(120): sum</span>
<span class="go">Dimension coords: time(120) = [1959-12-16 12:00:00, ..., 1969-11-16 00:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : air_pressure(1) = [850.0] hPa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">coordinate</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dtarray</span><span class="p">)</span>
<span class="go">[[cftime.DatetimeGregorian(1969-11-01 00:00:00)</span>
<span class="go">  cftime.DatetimeGregorian(1969-12-01 00:00:00))]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">coordinate</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dtarray</span><span class="p">)</span>
<span class="go">[[cftime.DatetimeGregorian(1959-11-01 00:00:00)</span>
<span class="go">  cftime.DatetimeGregorian(1969-12-01 00:00:00))]]</span>
</pre></div>
</div>
</div>
<p>The treatment of missing values can be specified, as well as the
positioning of coordinate values in the summed axis of the returned
field construct.</p>
</section>
<section id="histograms">
<span id="id93"></span><h3><a class="toc-backref" href="#id477">Histograms</a><a class="headerlink" href="#histograms" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="function/cf.histogram.html#cf.histogram" title="cf.histogram"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.histogram</span></code></a> function is used to record the distribution of a
set of variables in the form of an N-dimensional histogram.</p>
<p>Each dimension of the histogram is defined by a field construct
returned by the <a class="reference internal" href="method/cf.Field.digitize.html#cf.Field.digitize" title="cf.Field.digitize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">digitize</span></code></a> method of a field construct. This
“digitized” field construct defines a sequence of bins and provides
indices to the bins that each value of one of the variables belongs.</p>
<div class="literal-block-wrapper docutils container" id="id343">
<div class="code-block-caption"><span class="caption-text"><em>Create a one-dimensional histogram of a field construct
based on 10 equally-sized bins that exactly span the data
range.</em></span><a class="headerlink" href="#id343" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.007 0.034 0.003 0.014 0.018 0.037 0.024 0.029]</span>
<span class="go"> [0.023 0.036 0.045 0.062 0.046 0.073 0.006 0.066]</span>
<span class="go"> [0.11  0.131 0.124 0.146 0.087 0.103 0.057 0.011]</span>
<span class="go"> [0.029 0.059 0.039 0.07  0.058 0.072 0.009 0.017]</span>
<span class="go"> [0.006 0.036 0.019 0.035 0.018 0.037 0.034 0.013]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">return_bins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="go">Field: long_name=Bin index to which each &#39;specific_humidity&#39; value belongs (ncvar%q)</span>
<span class="go">------------------------------------------------------------------------------------</span>
<span class="go">Data            : long_name=Bin index to which each &#39;specific_humidity&#39; value belongs(latitude(5), longitude(8))</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_eastg</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">indices</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0 2 0 0 1 2 1 1]</span>
<span class="go"> [1 2 2 4 3 4 0 4]</span>
<span class="go"> [7 8 8 9 5 6 3 0]</span>
<span class="go"> [1 3 2 4 3 4 0 0]</span>
<span class="go"> [0 2 1 2 1 2 2 0]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bins</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.003  0.0173]</span>
<span class="go"> [0.0173 0.0316]</span>
<span class="go"> [0.0316 0.0459]</span>
<span class="go"> [0.0459 0.0602]</span>
<span class="go"> [0.0602 0.0745]</span>
<span class="go"> [0.0745 0.0888]</span>
<span class="go"> [0.0888 0.1031]</span>
<span class="go"> [0.1031 0.1174]</span>
<span class="go"> [0.1174 0.1317]</span>
<span class="go"> [0.1317 0.146 ]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">Field: number_of_observations</span>
<span class="go">-----------------------------</span>
<span class="go">Data            : number_of_observations(specific_humidity(10)) 1</span>
<span class="go">Cell methods    : latitude: longitude: point</span>
<span class="go">Dimension coords: specific_humidity(10) = [10.15, ..., 138.85000000000002] 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[9 7 9 4 5 1 1 1 2 1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">coordinate</span><span class="p">(</span><span class="s1">&#39;specific_humidity&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.003  0.0173]</span>
<span class="go"> [0.0173 0.0316]</span>
<span class="go"> [0.0316 0.0459]</span>
<span class="go"> [0.0459 0.0602]</span>
<span class="go"> [0.0602 0.0745]</span>
<span class="go"> [0.0745 0.0888]</span>
<span class="go"> [0.0888 0.1031]</span>
<span class="go"> [0.1031 0.1174]</span>
<span class="go"> [0.1174 0.1317]</span>
<span class="go"> [0.1317 0.146 ]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id344">
<div class="code-block-caption"><span class="caption-text"><em>Create a two-dimensional histogram based on specific
humidity and temperature bins. The temperature bins in
this example are derived from a dummy temperature field
construct with the same shape as the specific humidity
field construct already in use.</em></span><a class="headerlink" href="#id344" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;air_temperature&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">290</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">override_units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">Field: air_temperature (ncvar%q)</span>
<span class="go">--------------------------------</span>
<span class="go">Data            : air_temperature(latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices_t</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">indices_t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">Field: number_of_observations</span>
<span class="go">-----------------------------</span>
<span class="go">Data            : number_of_observations(air_temperature(5), specific_humidity(10)) 1</span>
<span class="go">Cell methods    : latitude: longitude: point</span>
<span class="go">Dimension coords: air_temperature(5) = [281.1054839143287, ..., 313.9741786365939] K</span>
<span class="go">                : specific_humidity(10) = [0.01015, ..., 0.13885] 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[2  1  5  3  2 -- -- -- -- --]</span>
<span class="go"> [1  1  2 --  1 --  1  1 -- --]</span>
<span class="go"> [4  4  2  1  1  1 -- --  1  1]</span>
<span class="go"> [1  1 -- --  1 -- -- --  1 --]</span>
<span class="go"> [1 -- -- -- -- -- -- -- -- --]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">&lt;CF Data(): 40 1&gt;</span>
</pre></div>
</div>
</div>
</section>
<section id="binning-operations">
<span id="id94"></span><h3><a class="toc-backref" href="#id478">Binning operations</a><a class="headerlink" href="#binning-operations" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="method/cf.Field.bin.html#cf.Field.bin" title="cf.Field.bin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bin</span></code></a> method of the field construct groups its data into
bins, where each group is defined by the elements that correspond to
an <a class="reference internal" href="#histograms"><span class="std std-ref">N-dimensional histogram bin of another set of variables</span></a>, and collapses the elements in each group to a single
representative value. The same <a class="reference internal" href="#collapse-methods"><span class="std std-ref">collapse methods</span></a> and <a class="reference internal" href="#collapse-weights"><span class="std std-ref">weighting options</span></a> as
the <a class="reference internal" href="method/cf.Field.collapse.html#cf.Field.collapse" title="cf.Field.collapse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collapse</span></code></a> method are available.</p>
<p>The result of the binning operation is a field construct whose domain
axis and dimension coordinate constructs describe the sizes of the
N-dimensional bins of the other set of variables.</p>
<div class="literal-block-wrapper docutils container" id="id345">
<div class="code-block-caption"><span class="caption-text"><em>Find the range of values that lie in each of bin 10
equally-sized bins of the data itself.</em></span><a class="headerlink" href="#id345" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 0.001 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.007 0.034 0.003 0.014 0.018 0.037 0.024 0.029]</span>
<span class="go"> [0.023 0.036 0.045 0.062 0.046 0.073 0.006 0.066]</span>
<span class="go"> [0.11  0.131 0.124 0.146 0.087 0.103 0.057 0.011]</span>
<span class="go"> [0.029 0.059 0.039 0.07  0.058 0.072 0.009 0.017]</span>
<span class="go"> [0.006 0.036 0.019 0.035 0.018 0.037 0.034 0.013]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">bin</span><span class="p">(</span><span class="s1">&#39;range&#39;</span><span class="p">,</span> <span class="n">digitized</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: specific_humidity</span>
<span class="go">------------------------</span>
<span class="go">Data            : specific_humidity(specific_humidity(5)) 1</span>
<span class="go">Cell methods    : latitude: longitude: range</span>
<span class="go">Dimension coords: specific_humidity(5) = [0.0173, ..., 0.1317] 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[0.026 0.025 0.025 0.007 0.022]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">coordinate</span><span class="p">(</span><span class="s1">&#39;specific_humidity&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.003  0.0316]</span>
<span class="go"> [0.0316 0.0602]</span>
<span class="go"> [0.0602 0.0888]</span>
<span class="go"> [0.0888 0.1174]</span>
<span class="go"> [0.1174 0.146 ]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id346">
<div class="code-block-caption"><span class="caption-text"><em>Find the area-weighted mean of specific humidity values
that correspond to two-dimensional bins defined by
temperature and pressure values.</em></span><a class="headerlink" href="#id346" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file2.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">Field: air_temperature (ncvar%t)</span>
<span class="go">--------------------------------</span>
<span class="go">Data            : air_temperature(latitude(5), longitude(8)) degreesC</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">Field: air_pressure (ncvar%p)</span>
<span class="go">-----------------------------</span>
<span class="go">Data            : air_pressure(latitude(5), longitude(8)) hPa</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_indices</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_indices</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">bin</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">digitized</span><span class="o">=</span><span class="p">[</span><span class="n">t_indices</span><span class="p">,</span> <span class="n">p_indices</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: specific_humidity</span>
<span class="go">------------------------</span>
<span class="go">Data            : specific_humidity(air_pressure(6), air_temperature(4)) 1</span>
<span class="go">Cell methods    : latitude: longitude: mean</span>
<span class="go">Dimension coords: air_pressure(6) = [966.6225003326126, ..., 1033.6456080043665] hPa</span>
<span class="go">                : air_temperature(4) = [-12.735821567738295, ..., 9.9702610462581] degreesC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[     --       --       --  0.011  ]</span>
<span class="go"> [0.131    0.0145   0.0345   0.05052]</span>
<span class="go"> [0.05742  0.01727  0.06392  0.0105 ]</span>
<span class="go"> [     --  0.04516  0.05272  0.10194]</span>
<span class="go"> [0.124    0.024    0.059    0.006  ]</span>
<span class="go"> [     --  0.08971       --       --]]</span>
</pre></div>
</div>
</div>
</section>
<section id="percentiles">
<span id="id95"></span><h3><a class="toc-backref" href="#id479">Percentiles</a><a class="headerlink" href="#percentiles" title="Permalink to this headline">¶</a></h3>
<p>Percentiles of the data can be computed along any subset of the axes
with the <a class="reference internal" href="method/cf.Field.percentile.html#cf.Field.percentile" title="cf.Field.percentile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">percentile</span></code></a> method of the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id347">
<div class="code-block-caption"><span class="caption-text"><em>Find the 20th, 40th, 50th, 60th and 80th percentiles.</em></span><a class="headerlink" href="#id347" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity</span>
<span class="go">------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: time(1) = [2019-01-01 00:00:00]</span>
<span class="go">                : latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.007 0.034 0.003 0.014 0.018 0.037 0.024 0.029]</span>
<span class="go"> [0.023 0.036 0.045 0.062 0.046 0.073 0.006 0.066]</span>
<span class="go"> [0.11  0.131 0.124 0.146 0.087 0.103 0.057 0.011]</span>
<span class="go"> [0.029 0.059 0.039 0.07  0.058 0.072 0.009 0.017]</span>
<span class="go"> [0.006 0.036 0.019 0.035 0.018 0.037 0.034 0.013]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">percentile</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">Field: specific_humidity</span>
<span class="go">------------------------</span>
<span class="go">Data            : specific_humidity(long_name=Percentile ranks for latitude, longitude dimensions(5), latitude(1), longitude(1)) 1</span>
<span class="go">Dimension coords: time(1) = [2019-01-01 00:00:00]</span>
<span class="go">                : latitude(1) = [0.0] degrees_north</span>
<span class="go">                : longitude(1) = [180.0] degrees_east</span>
<span class="go">                : long_name=Percentile ranks for latitude, longitude dimensions(5) = [20, ..., 80]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[0.0164]]</span>
<span class="go"> [[0.032 ]]</span>
<span class="go"> [[0.036 ]]</span>
<span class="go"> [[0.0414]]</span>
<span class="go"> [[0.0704]]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id348">
<div class="code-block-caption"><span class="caption-text"><em>Find the standard deviation of the values above the 80th
percentile.</em></span><a class="headerlink" href="#id348" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p80</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p80</span><span class="p">)</span>
<span class="go">Field: specific_humidity</span>
<span class="go">------------------------</span>
<span class="go">Data            : specific_humidity(latitude(1), longitude(1)) 1</span>
<span class="go">Dimension coords: time(1) = [2019-01-01 00:00:00]</span>
<span class="go">                : latitude(1) = [0.0] degrees_north</span>
<span class="go">                : longitude(1) = [180.0] degrees_east</span>
<span class="go">                : long_name=Percentile ranks for latitude, longitude dimensions(1) = [80]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">q</span><span class="o">&lt;=</span><span class="n">p80</span><span class="p">,</span> <span class="n">cf</span><span class="o">.</span><span class="n">masked</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[  --    --    --    --    --    -- -- --]</span>
<span class="go"> [  --    --    --    --    -- 0.073 -- --]</span>
<span class="go"> [0.11 0.131 0.124 0.146 0.087 0.103 -- --]</span>
<span class="go"> [  --    --    --    --    -- 0.072 -- --]</span>
<span class="go"> [  --    --    --    --    --    -- -- --]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;standard_deviation&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;CF Data(1, 1): [[0.024609938742357642]] 1&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id349">
<div class="code-block-caption"><span class="caption-text"><em>Find the mean of the values above the 45th percentile
along the X axis.</em></span><a class="headerlink" href="#id349" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p45</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p45</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.0189 ]</span>
<span class="go"> [0.04515]</span>
<span class="go"> [0.10405]</span>
<span class="go"> [0.04185]</span>
<span class="go"> [0.02125]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">q</span><span class="o">&lt;=</span><span class="n">p45</span><span class="p">,</span> <span class="n">cf</span><span class="o">.</span><span class="n">masked</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[  -- 0.034    --    --    -- 0.037 0.024 0.029]</span>
<span class="go"> [  --    --    -- 0.062 0.046 0.073    -- 0.066]</span>
<span class="go"> [0.11 0.131 0.124 0.146    --    --    --    --]</span>
<span class="go"> [  -- 0.059    -- 0.07  0.058 0.072    --    --]</span>
<span class="go"> [  -- 0.036    -- 0.035   --  0.037 0.034    --]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;X: mean&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.031  ]</span>
<span class="go"> [0.06175]</span>
<span class="go"> [0.12775]</span>
<span class="go"> [0.06475]</span>
<span class="go"> [0.0355 ]]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id350">
<div class="code-block-caption"><span class="caption-text"><em>Find the histogram bin boundaries associated with given
percentiles, and digitize the data based on these bins.</em></span><a class="headerlink" href="#id350" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">percentile</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bins</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[0.003  0.0088 0.036  0.1037 0.146 ]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">closed_ends</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0 1 0 1 1 2 1 1]</span>
<span class="go"> [1 2 2 2 2 2 0 2]</span>
<span class="go"> [3 3 3 3 2 2 2 1]</span>
<span class="go"> [1 2 2 2 2 2 1 1]</span>
<span class="go"> [0 2 1 1 1 2 1 1]]</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="regridding">
<span id="id96"></span><h2><a class="toc-backref" href="#id480"><strong>Regridding</strong></a><a class="headerlink" href="#regridding" title="Permalink to this headline">¶</a></h2>
<p>Regridding, also called remapping or interpolation, is the process of
changing the domain of a field construct whilst preserving the
qualities of the original data.</p>
<p>The field construct has two regridding methods: <a class="reference internal" href="method/cf.Field.regrids.html#cf.Field.regrids" title="cf.Field.regrids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">regrids</span></code></a> for
regridding data between domains with spherical coordinate systems; and
<a class="reference internal" href="method/cf.Field.regridc.html#cf.Field.regridc" title="cf.Field.regridc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">regridc</span></code></a> for regridding data between domains with Cartesian
coordinate systems. The interpolation is carried by out using the
<a class="reference external" href="https://earthsystemmodeling.org/esmpy/">ESMF</a> package, a
Python interface to the Earth System Modeling Framework regridding
utility.</p>
<p>As with <a class="reference internal" href="#statistical-collapses"><span class="std std-ref">statistical collapses</span></a>,
regridding may be applied over a subset of the domain axes, and the
domain axis constructs and coordinate constructs for the non-regridded
dimensions remain the same.</p>
<p><a class="reference internal" href="#domain-ancillaries"><span class="std std-ref">Domain ancillary constructs</span></a> whose data
spans the regridding dimensions are also regridded, but <a class="reference internal" href="#field-ancillaries"><span class="std std-ref">field
ancillary constructs</span></a> whose data spans the
regridding dimensions are removed from the regridded field construct.</p>
<section id="regridding-methods">
<span id="id97"></span><h3><a class="toc-backref" href="#id481">Regridding methods</a><a class="headerlink" href="#regridding-methods" title="Permalink to this headline">¶</a></h3>
<p>The following regridding methods are available (in this table,
“source” and “destination” refer to the domain of the field construct
being regridded, and the domain that it is being regridded to,
respectively):</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Linear</p></td>
<td><p>Linear interpolation in the number of
dimensions being regridded.</p>
<p>For two dimensional regridding this is
bilinear interpolation, and for three
dimensional regridding this is trilinear
interpolation.</p>
</td>
</tr>
<tr class="row-odd"><td><p>First-order conservative</p></td>
<td><p>First order conservative interpolation.</p>
<p>Preserve the area integral of the data
across the interpolation from source to
destination. It uses the proportion of
the area of the overlapping source and
destination cells to determine
appropriate weights.</p>
<p>In particular, the weight of a source
cell is the ratio of the area of
intersection of the source and
destination cells to the area of the
whole destination cell.</p>
<p>It does not account for the field
gradient across the source cell, unlike
the <em>second-order</em> conservative method.</p>
</td>
</tr>
<tr class="row-even"><td><p>Second-order conservative</p></td>
<td><p>Second-order conservative
interpolation.</p>
<p>As with first order (see above),
preserves the area integral of the field
between source and destination using a
weighted sum, with weights based on the
proportionate area of intersection.</p>
<p>Unlike <em>first-order</em>, the second-order
method incorporates further terms to take
into consideration the gradient of the
field across the source cell, thereby
typically producing a smoother result of
higher accuracy.</p>
</td>
</tr>
<tr class="row-odd"><td><p>Higher-order patch recovery</p></td>
<td><p>Higher-order patch recovery
interpolation.</p>
<p>A second degree polynomial regridding
method, which uses a least squares
algorithm to calculate the polynomial.</p>
<p>This method gives better derivatives in
the resulting destination data than the
linear method.</p>
</td>
</tr>
<tr class="row-even"><td><p>Nearest neighbour</p></td>
<td><p>Nearest neighbour interpolation for which
each destination point is mapped to the
closest source point, or vice versa.</p>
<p>Useful for extrapolation of categorical
data.</p>
<p>When mapping destination to source
points, a given destination point may
receive input from multiple source
points, but no source point will map to
more than one destination point.</p>
<p>When mapping source to destination
points, a given destination receives
input at most one source point.</p>
</td>
</tr>
</tbody>
</table>
</section>
<section id="spherical-regridding">
<span id="id98"></span><h3><a class="toc-backref" href="#id482">Spherical regridding</a><a class="headerlink" href="#spherical-regridding" title="Permalink to this headline">¶</a></h3>
<p>Regridding from and to spherical coordinate systems using the
<a class="reference internal" href="method/cf.Field.regrids.html#cf.Field.regrids" title="cf.Field.regrids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">regrids</span></code></a> method is only available for the ‘X’ and ‘Y’ axes
simultaneously. All other axes are unchanged. The calculation of the
regridding weights is based on areas and distances on the surface of
the sphere, rather in <a class="reference internal" href="#cartesian-regridding"><span class="std std-ref">Euclidean space</span></a>.</p>
<p>The following combinations of spherical source and destination domain
coordinate systems are available to the <a class="reference internal" href="method/cf.Field.regrids.html#cf.Field.regrids" title="cf.Field.regrids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">regrids</span></code></a> method:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Spherical source domain</p></th>
<th class="head"><p>Spherical destination domain</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_latitude_longitude">Latitude-longitude</a></p></td>
<td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_latitude_longitude">Latitude-longitude</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_latitude_longitude">Latitude-longitude</a></p></td>
<td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_rotated_pole">Rotated latitude-longitude</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_latitude_longitude">Latitude-longitude</a></p></td>
<td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#appendix-grid-mappings">Plane projection</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_latitude_longitude">Latitude-longitude</a></p></td>
<td><p><a class="reference external" href="https://doi.org/10.1007%2FBF00211684">Tripolar</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_rotated_pole">Rotated latitude-longitude</a></p></td>
<td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_latitude_longitude">Latitude-longitude</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_rotated_pole">Rotated latitude-longitude</a></p></td>
<td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_rotated_pole">Rotated latitude-longitude</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_rotated_pole">Rotated latitude-longitude</a></p></td>
<td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#appendix-grid-mappings">Plane projection</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_rotated_pole">Rotated latitude-longitude</a></p></td>
<td><p><a class="reference external" href="https://doi.org/10.1007%2FBF00211684">Tripolar</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#appendix-grid-mappings">Plane projection</a></p></td>
<td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_latitude_longitude">Latitude-longitude</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#appendix-grid-mappings">Plane projection</a></p></td>
<td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_rotated_pole">Rotated latitude-longitude</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#appendix-grid-mappings">Plane projection</a></p></td>
<td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#appendix-grid-mappings">Plane projection</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#appendix-grid-mappings">Plane projection</a></p></td>
<td><p><a class="reference external" href="https://doi.org/10.1007%2FBF00211684">Tripolar</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://doi.org/10.1007%2FBF00211684">Tripolar</a></p></td>
<td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_latitude_longitude">Latitude-longitude</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://doi.org/10.1007%2FBF00211684">Tripolar</a></p></td>
<td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#_rotated_pole">Rotated latitude-longitude</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://doi.org/10.1007%2FBF00211684">Tripolar</a></p></td>
<td><p><a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#appendix-grid-mappings">Plane projection</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://doi.org/10.1007%2FBF00211684">Tripolar</a></p></td>
<td><p><a class="reference external" href="https://doi.org/10.1007%2FBF00211684">Tripolar</a></p></td>
</tr>
</tbody>
</table>
<p>The most convenient usage is when the destination domain exists
in another field construct. In this case, all you need to specify is the
field construct having the desired destination domain and the
regridding method to use:</p>
<div class="literal-block-wrapper docutils container" id="id351">
<div class="code-block-caption"><span class="caption-text"><em>Regrid the field construct a conservatively onto a grid
contained in field construct b.</em></span><a class="headerlink" href="#id351" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;air_temperature.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;precipitation_flux.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">Field: air_temperature (ncvar%tas)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : air_temperature(time(2), latitude(73), longitude(96)) K</span>
<span class="go">Cell methods    : time(2): mean</span>
<span class="go">Dimension coords: time(2) = [1860-01-16 00:00:00, 1860-02-16 00:00:00] 360_day</span>
<span class="go">                : latitude(73) = [-90.0, ..., 90.0] degrees_north</span>
<span class="go">                : longitude(96) = [0.0, ..., 356.25] degrees_east</span>
<span class="go">                : height(1) = [2.0] m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: precipitation_flux (ncvar%tas)</span>
<span class="go">-------------------------------------</span>
<span class="go">Data            : precipitation_flux(time(1), latitude(64), longitude(128)) kg m-2 day-1</span>
<span class="go">Cell methods    : time(1): mean (interval: 1.0 month)</span>
<span class="go">Dimension coords: time(1) = [0450-11-16 00:00:00] noleap</span>
<span class="go">                : latitude(64) = [-87.86380004882812, ..., 87.86380004882812] degrees_north</span>
<span class="go">                : longitude(128) = [0.0, ..., 357.1875] degrees_east</span>
<span class="go">                : height(1) = [2.0] m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">regrids</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;conservative&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">Field: air_temperature (ncvar%tas)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : air_temperature(time(2), latitude(64), longitude(128)) K</span>
<span class="go">Cell methods    : time(2): mean</span>
<span class="go">Dimension coords: time(2) = [1860-01-16 00:00:00, 1860-02-16 00:00:00] 360_day</span>
<span class="go">                : latitude(64) = [-87.86380004882812, ..., 87.86380004882812] degrees_north</span>
<span class="go">                : longitude(128) = [0.0, ..., 357.1875] degrees_east</span>
<span class="go">                : height(1) = [2.0] m</span>
</pre></div>
</div>
</div>
<p>It is generally not necessary to specify which are the ‘X’ and ‘Y’
axes in the domains of both the source and destination field
constructs, since they will be automatically identified by their
metadata. However, in cases when this is not possible (such as for
tripolar domains) the <em>src_axes</em> or <em>dst_axes</em> keywords of the
<a class="reference internal" href="method/cf.Field.regrids.html#cf.Field.regrids" title="cf.Field.regrids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">regrids</span></code></a> method can be used.</p>
<p>It may be that the required destination domain does not exist in a
field construct. In this case, the latitude and longitudes of the
destination domain may be defined solely by dimension or auxiliary
coordinate constructs.</p>
<div class="literal-block-wrapper docutils container" id="id352">
<div class="code-block-caption"><span class="caption-text"><em>Regrid ‘a’ onto two-dimensional (curvilinear) dimension
coordinates latitude and longitude.</em></span><a class="headerlink" href="#id352" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mf">92.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">),</span> <span class="s1">&#39;degrees_north&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">),</span> <span class="s1">&#39;degrees_east&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">regrids</span><span class="p">([</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="go">Field: air_temperature (ncvar%tas)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : air_temperature(time(2), latitude(73), longitude(72)) K</span>
<span class="go">Cell methods    : time(2): mean</span>
<span class="go">Dimension coords: time(2) = [1860-01-16 00:00:00, 1860-02-16 00:00:00] 360_day</span>
<span class="go">                : latitude(73) = [-90.0, ..., 90.0] degrees_north</span>
<span class="go">                : longitude(72) = [0.0, ..., 355.0] degrees_east</span>
<span class="go">                : height(1) = [2.0] m</span>
</pre></div>
</div>
</div>
<p>A destination domain defined by two-dimensional (curvilinear) latitude
and longitude auxiliary coordinate constructs can also be specified in
a similar manner.</p>
<p>An axis is <a class="reference internal" href="#cyclic-domain-axes"><span class="std std-ref">cyclic</span></a> if cells at both of its
ends are actually geographically adjacent. In spherical regridding,
only the ‘X’ axis has the potential for being cyclic. For example, a
longitude cell spanning 359 to 360 degrees east is proximate to the
cell spanning 0 to 1 degrees east.</p>
<p>When a cyclic dimension can not be automatically detected, such as
when its dimension coordinate construct does not have bounds,
cyclicity may be set with the <em>src_cyclic</em> or <em>dst_cyclic</em> keywords of
the <a class="reference internal" href="method/cf.Field.regrids.html#cf.Field.regrids" title="cf.Field.regrids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">regrids</span></code></a> method.</p>
<p>To find out whether a dimension is cyclic use the <a class="reference internal" href="method/cf.Field.iscyclic.html#cf.Field.iscyclic" title="cf.Field.iscyclic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iscyclic</span></code></a>
method of the field construct, or to manually set its cyclicity use
the <code class="xref py py-obj docutils literal notranslate"><span class="pre">cyclic</span></code> method. If the destination domain has been defined by a
dictionary of dimension coordinate constructs, then cyclicity can be
registered by setting a period of cyclicity with the
<a class="reference internal" href="method/cf.DimensionCoordinate.period.html#cf.DimensionCoordinate.period" title="cf.DimensionCoordinate.period"><code class="xref py py-obj docutils literal notranslate"><span class="pre">period</span></code></a> method of the dimension coordinate
construct.</p>
</section>
<section id="cartesian-regridding">
<span id="id99"></span><h3><a class="toc-backref" href="#id483">Cartesian regridding</a><a class="headerlink" href="#cartesian-regridding" title="Permalink to this headline">¶</a></h3>
<p>Cartesian regridding with the <a class="reference internal" href="method/cf.Field.regridc.html#cf.Field.regridc" title="cf.Field.regridc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">regridc</span></code></a> method is very
similar to <a class="reference internal" href="#spherical-regridding"><span class="std std-ref">spherical regridding</span></a>, except
regridding dimensions are not restricted to the horizontal plane, the
source and destination domains are assumed to be <a class="reference external" href="https://en.wikipedia.org/wiki/Euclidean_space">Euclidian spaces</a> for the purpose of
calculating regridding weights, and all dimensions are assumed to be
non-cyclic by default.</p>
<p>Cartesian regridding can be done in up to three dimensions. It is
often used for regridding along the time dimension. A plane projection
coordinate system can be regridded with Cartesian regridding, which
will produce similar results to using using spherical regridding.</p>
<div class="literal-block-wrapper docutils container" id="id353">
<div class="code-block-caption"><span class="caption-text"><em>Regrid the time axis ‘T’ of field ‘a’ with the linear
method onto the grid specified in the dimension coordinate
time.</em></span><a class="headerlink" href="#id353" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">standard_name</span><span class="o">=</span><span class="s1">&#39;time&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>                      <span class="n">units</span><span class="o">=</span><span class="s1">&#39;days since 1860-01-01&#39;</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;360_day&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span>
<span class="go">&lt;CF DimensionCoordinate: time(60) days since 1860-01-01 360_day&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">regridc</span><span class="p">([</span><span class="n">time</span><span class="p">],</span> <span class="n">axes</span><span class="o">=</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="go">Field: air_temperature (ncvar%tas)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : air_temperature(time(60), latitude(73), longitude(96)) K</span>
<span class="go">Cell methods    : time(60): mean</span>
<span class="go">Dimension coords: time(60) = [1860-01-01 12:00:00, ..., 1860-02-30 12:00:00] 360_day</span>
<span class="go">                : latitude(73) = [-90.0, ..., 90.0] degrees_north</span>
<span class="go">                : longitude(96) = [0.0, ..., 356.25] degrees_east</span>
<span class="go">                : height(1) = [2.0] m</span>
</pre></div>
</div>
</div>
<p>Note the requirement for the conservative method of contiguous,
non-overlapping bounds on the destination domain:</p>
<div class="literal-block-wrapper docutils container" id="id354">
<div class="code-block-caption"><span class="caption-text"><em>Regrid the time axis ‘T’ of field ‘a’ conservatively
(to first order) onto the grid specified in the dimension
coordinate time.</em></span><a class="headerlink" href="#id354" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">regridc</span><span class="p">([</span><span class="n">time</span><span class="p">],</span> <span class="n">axes</span><span class="o">=</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;conservative&#39;</span><span class="p">)</span>  <span class="c1"># Raises Exception</span>
<span class="go">ValueError: Destination coordinates must have contiguous, non-overlapping bounds for conservative regridding.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">create_bounds</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">regridc</span><span class="p">([</span><span class="n">time</span><span class="p">],</span> <span class="n">axes</span><span class="o">=</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;conservative&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">Field: air_temperature (ncvar%tas)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : air_temperature(time(60), latitude(73), longitude(96)) K</span>
<span class="go">Cell methods    : time(60): mean</span>
<span class="go">Dimension coords: time(60) = [1860-01-01 12:00:00, ..., 1860-02-30 12:00:00] 360_day</span>
<span class="go">                : latitude(73) = [-90.0, ..., 90.0] degrees_north</span>
<span class="go">                : longitude(96) = [0.0, ..., 356.25] degrees_east</span>
<span class="go">                : height(1) = [2.0] m</span>
</pre></div>
</div>
</div>
<p>Cartesian regridding to the dimension of another field construct is
also possible, similarly to spherical regridding.</p>
</section>
<section id="regridding-masked-data">
<span id="id100"></span><h3><a class="toc-backref" href="#id484">Regridding masked data</a><a class="headerlink" href="#regridding-masked-data" title="Permalink to this headline">¶</a></h3>
<p>The data mask of the source field construct is taken into account,
such that the regridded data will be masked in regions where the
source data is masked. By default the mask of the destination field
construct is not used, but can be taken into account by setting
<em>use_dst_mask</em> keyword to the <a class="reference internal" href="method/cf.Field.regrids.html#cf.Field.regrids" title="cf.Field.regrids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">regrids</span></code></a> or <a class="reference internal" href="method/cf.Field.regridc.html#cf.Field.regridc" title="cf.Field.regridc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">regridc</span></code></a>
methods. For example, this is useful when part of the destination
domain is not being used (such as the land portion of an ocean grid).</p>
<p>For conservative regridding, masking is done on cells. Masking a
destination cell means that the cell won’t participate in the
regridding. For all other regridding methods, masking is done on
points. For these methods, masking a destination point means that the
point will not participate in the regridding.</p>
</section>
<section id="vertical-regridding">
<span id="id101"></span><h3><a class="toc-backref" href="#id485">Vertical regridding</a><a class="headerlink" href="#vertical-regridding" title="Permalink to this headline">¶</a></h3>
<p>The only option for regridding along a vertical axis is to use
Cartesian regridding. However, care must be taken to ensure that the
vertical axis is transformed so that it’s coordinate values vary
linearly. For example, to regrid data on one set of vertical pressure
coordinates to another set, the pressure coordinates may first be
transformed into the logarithm of pressure, and then changed back to
pressure coordinates after the regridding operation.</p>
<div class="literal-block-wrapper docutils container" id="id355">
<div class="code-block-caption"><span class="caption-text"><em>Regrid a field construct from one set of pressure levels
to another.</em></span><a class="headerlink" href="#id355" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;vertical.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">Field: eastward_wind (ncvar%ua)</span>
<span class="go">-------------------------------</span>
<span class="go">Data            : eastward_wind(time(3), air_pressure(5), grid_latitude(11), grid_longitude(10)) m s-1</span>
<span class="go">Cell methods    : time(3): mean</span>
<span class="go">Dimension coords: time(3) = [1979-05-01 12:00:00, 1979-05-02 12:00:00, 1979-05-03 12:00:00] gregorian</span>
<span class="go">                : air_pressure(5) = [850.0, ..., 50.0] hPa</span>
<span class="go">                : grid_latitude(11) = [23.32, ..., 18.92] degrees</span>
<span class="go">                : grid_longitude(10) = [-20.54, ..., -16.58] degrees</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(11), grid_longitude(10)) = [[67.12, ..., 66.07]] degrees_north</span>
<span class="go">                : longitude(grid_latitude(11), grid_longitude(10)) = [[-45.98, ..., -31.73]] degrees_east</span>
<span class="go">Coord references: grid_mapping_name:rotated_latitude_longitude</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_p</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">z_p</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[850. 700. 500. 250.  50.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_ln_p</span> <span class="o">=</span> <span class="n">z_p</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_ln_p</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="s1">&#39;Z&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">z_ln_p</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[6.74523635 6.55108034 6.2146081  5.52146092 3.91202301]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">replace_construct</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="n">z_ln_p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_z_p</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">DimensionCoordinate</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">800</span><span class="p">,</span> <span class="mi">705</span><span class="p">,</span> <span class="mi">632</span><span class="p">,</span> <span class="mi">510</span><span class="p">,</span> <span class="mf">320.</span><span class="p">],</span> <span class="s1">&#39;hPa&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_z_ln_p</span> <span class="o">=</span> <span class="n">new_z_p</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_z_ln_p</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="s1">&#39;Z&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">regridc</span><span class="p">([</span><span class="n">new_z_ln_p</span><span class="p">],</span> <span class="n">axes</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_v</span><span class="o">.</span><span class="n">replace_construct</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="n">new_z_p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">new_v</span><span class="p">)</span>
<span class="go">Field: eastward_wind (ncvar%ua)</span>
<span class="go">-------------------------------</span>
<span class="go">Data            : eastward_wind(time(3), Z(5), grid_latitude(11), grid_longitude(10)) m s-1</span>
<span class="go">Cell methods    : time(3): mean</span>
<span class="go">Dimension coords: time(3) = [1979-05-01 12:00:00, 1979-05-02 12:00:00, 1979-05-03 12:00:00] gregorian</span>
<span class="go">                : Z(5) = [800.0, ..., 320.0] hPa</span>
<span class="go">                : grid_latitude(11) = [23.32, ..., 18.92] degrees</span>
<span class="go">                : grid_longitude(10) = [-20.54, ..., -16.58] degrees</span>
<span class="go">Auxiliary coords: latitude(grid_latitude(11), grid_longitude(10)) = [[67.12, ..., 66.07]] degrees_north</span>
<span class="go">                : longitude(grid_latitude(11), grid_longitude(10)) = [[-45.98, ..., -31.73]] degrees_east</span>
<span class="go">Coord references: grid_mapping_name:rotated_latitude_longitude</span>
</pre></div>
</div>
</div>
<p>Note that the <a class="reference internal" href="method/cf.Field.replace_construct.html#cf.Field.replace_construct" title="cf.Field.replace_construct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">replace_construct</span></code></a> method of the field construct
is used to easily replace the vertical dimension coordinate construct,
without having to manually match up the corresponding domain axis
construct and construct key.</p>
<hr class="docutils" />
</section>
</section>
<section id="mathematical-operations">
<span id="id102"></span><h2><a class="toc-backref" href="#id486"><strong>Mathematical operations</strong></a><a class="headerlink" href="#mathematical-operations" title="Permalink to this headline">¶</a></h2>
<section id="binary-arithmetical-operations">
<span id="id103"></span><h3><a class="toc-backref" href="#id487">Binary arithmetical operations</a><a class="headerlink" href="#binary-arithmetical-operations" title="Permalink to this headline">¶</a></h3>
<p>A field construct may be arithmetically combined with another field
construct, or any other object that is broadcastable to its data. See
the <a class="reference internal" href="class/cf.Field.html#field-binary-arithmetic"><span class="std std-ref">comprehensive list of available binary operations</span></a>.</p>
<p>When combining with another field construct, its data is actually
combined, but only after being transformed so that it is broadcastable
to the first field construct’s data. This is done by using the
metadata constructs of the two field constructs to create a mapping of
physically compatible dimensions between the fields, and then
<a class="reference internal" href="#manipulating-dimensions"><span class="std std-ref">manipulating the dimensions</span></a> of the
other field construct’s data to ensure that they are broadcastable.</p>
<p>In any case, a field construct may appear as the left or right
operand, and augmented assignments are possible.</p>
<p>Automatic units conversions are also carried out between operands
during operations, and if one operand has no units then the units of
the other are assumed.</p>
<div class="literal-block-wrapper docutils container" id="id356">
<div class="code-block-caption"><span class="caption-text"><em>Apply some binary arithmetic operations to combine the
data for a pair of field constructs.</em></span><a class="headerlink" href="#id356" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>
<span class="go">{&#39;min&#39;: &lt;CF Data(): 260.0 K&gt;,</span>
<span class="go"> &#39;mean&#39;: &lt;CF Data(): 269.9244444444445 K&gt;,</span>
<span class="go"> &#39;max&#39;: &lt;CF Data(): 280.0 K&gt;,</span>
<span class="go"> &#39;range&#39;: &lt;CF Data(): 20.0 K&gt;,</span>
<span class="go"> &#39;mid_range&#39;: &lt;CF Data(): 270.0 K&gt;,</span>
<span class="go"> &#39;standard_deviation&#39;: &lt;CF Data(): 5.942452002538104 K&gt;,</span>
<span class="go"> &#39;sample_size&#39;: 90}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">t</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="go">&lt;CF Data(): 520.0 K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="go">&lt;CF Data(): 258.0 K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="go">&lt;CF Data(): 262.0 K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="go">&lt;CF Data(): 0.0 K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">29</span><span class="p">),</span> <span class="s1">&#39;0.1 K&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="go">&lt;CF Data(): 262.6 K&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id357">
<div class="code-block-caption"><span class="caption-text"><em>Apply a binary addition operation to apply an offset to
the units and permute the axes of air temperature data
on a field construct. Note the use of augmented
assignment to apply an offset to the units.</em></span><a class="headerlink" href="#id357" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">Units</span> <span class="o">-=</span> <span class="mf">273.15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;CF Field: air_temperature(grid_longitude(1), grid_latitude(10), atmosphere_hybrid_height_coordinate(1)) K @ 273.15&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;</span>
</pre></div>
</div>
</div>
<p>If the physical nature of the result differs from both operands, then
the “standard_name” and “long_name” properties are removed. This is
the case if the units of the result differ from both operands, or if
they have different standard names.</p>
<div class="literal-block-wrapper docutils container" id="id358">
<div class="code-block-caption"><span class="caption-text"><em>Applying a binary operation where the resultant field construct
has a different physical nature to the two operands. Note the
removal of the ‘standard_name’ property to account for this.</em></span><a class="headerlink" href="#id358" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">identities</span><span class="p">()</span>
<span class="go">[&#39;air_temperature&#39;,</span>
<span class="go"> &#39;Conventions=CF-1.7&#39;,</span>
<span class="go"> &#39;project=research&#39;,</span>
<span class="go"> &#39;units=K&#39;,</span>
<span class="go"> &#39;standard_name=air_temperature&#39;,</span>
<span class="go"> &#39;ncvar%ta&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;m s-1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">identities</span><span class="p">()</span>
<span class="go">[&#39;Conventions=CF-1.7&#39;,</span>
<span class="go"> &#39;project=research&#39;,</span>
<span class="go"> &#39;units=m.s-1.K&#39;,</span>
<span class="go"> &#39;ncvar%ta&#39;]</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="#domain"><span class="std std-ref">domain</span></a> metadata constructs of the result of a
successful arithmetical operation between two field constructs are
unambiguously well defined: The domain metadata constructs of the
result of a successful operation are copied from the left hand side
(LHS) operand, except when a coordinate construct in the LHS operand
has size 1 and the corresponding coordinate construct in right hand
side (RHS) field construct operand has size greater than 1. In this
case the coordinate construct from the RHS operand is used in the
result, to match up with the data broadcasting that will have occurred
during the operation.</p>
<p id="ambiguous-result">In circumstances when domain metadata constructs in the result can not
be inferred unambiguously then an exception will be raised. For
example, this will be the case if both operands are field constructs
with corresponding coordinate constructs of size greater than 1 <em>and
with different coordinate values</em>. In such circumstances, the field
constructs’ data instances may be operated on directly, bypassing any
checks on the metadata. See
<a class="reference internal" href="#operating-on-the-field-constructs-data"><span class="std std-ref">Operating on the field constructs’ data</span></a> for more details. <em>(This
will be made easier in a future release with a new function for
combining such field constructs.)</em></p>
<p class="rubric" id="id104">Bounds</p>
<p>For binary operations involving constructs that have bounds, the
result of binary operation will, by default, only have bounds if both
operands have bounds; and the bounds of the result will be the result
of the same binary operation on bounds objects. This behaviour may
modified by the <a class="reference internal" href="function/cf.bounds_combination_mode.html#cf.bounds_combination_mode" title="cf.bounds_combination_mode"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.bounds_combination_mode</span></code></a> function.</p>
<div class="literal-block-wrapper docutils container" id="id359">
<div class="code-block-caption"><span class="caption-text"><em>Demonstrate how bounds are treated in binary
operations.</em></span><a class="headerlink" href="#id359" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">dimension_coordinate</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">Dimension coordinate: longitude</span>
<span class="go">    standard_name = &#39;longitude&#39;</span>
<span class="go">    units = &#39;degrees_east&#39;</span>
<span class="go">    Data(longitude(8)) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">    Bounds:units = &#39;degrees_east&#39;</span>
<span class="go">    Bounds:Data(longitude(8), 2) = [[0.0, ..., 360.0]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">Dimension coordinate: longitude</span>
<span class="go">    standard_name = &#39;longitude&#39;</span>
<span class="go">    units = &#39;degrees_east&#39;</span>
<span class="go">    Data(8) = [45.0, ..., 675.0] degrees_east</span>
<span class="go">    Bounds:units = &#39;degrees_east&#39;</span>
<span class="go">    Bounds:Data(8, 2) = [[0.0, ..., 720.0]] degrees_east</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">Dimension coordinate: longitude</span>
<span class="go">    standard_name = &#39;longitude&#39;</span>
<span class="go">    units = &#39;degrees_east&#39;</span>
<span class="go">    Data(8) = [72.5, ..., 387.5] degrees_east</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">old</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bounds_combination_mode</span><span class="p">(</span><span class="s1">&#39;OR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">Dimension coordinate: longitude</span>
<span class="go">    standard_name = &#39;longitude&#39;</span>
<span class="go">    units = &#39;degrees_east&#39;</span>
<span class="go">    Data(8) = [72.5, ..., 387.5] degrees_east</span>
<span class="go">    Bounds:units = &#39;degrees_east&#39;</span>
<span class="go">    Bounds:Data(8, 2) = [[50.0, ..., 410.0]] degrees_east</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span><span class="o">.</span><span class="n">del_bounds</span><span class="p">()</span>
<span class="go">&lt;CF Bounds: longitude(8, 2) degrees_east&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">Dimension coordinate: longitude</span>
<span class="go">    standard_name = &#39;longitude&#39;</span>
<span class="go">    units = &#39;degrees_east&#39;</span>
<span class="go">    Data(8) = [45.0, ..., 675.0] degrees_east</span>
<span class="go">    Bounds:units = &#39;degrees_east&#39;</span>
<span class="go">    Bounds:Data(8, 2) = [[22.5, ..., 697.5]] degrees_east</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cf</span><span class="o">.</span><span class="n">bounds_combination_mode</span><span class="p">(</span><span class="n">old</span><span class="p">)</span>
<span class="go">&#39;OR&#39;</span>
</pre></div>
</div>
</div>
<p>The setting of the bounds combination mode may also be set in a
context manager:</p>
<div class="literal-block-wrapper docutils container" id="id360">
<div class="code-block-caption"><span class="caption-text"><em>Set the bounds combination mode in a context manager.</em></span><a class="headerlink" href="#id360" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">cf</span><span class="o">.</span><span class="n">bounds_combination_mode</span><span class="p">(</span><span class="s1">&#39;OR&#39;</span><span class="p">):</span>
<span class="gp">... </span>   <span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="gp">...</span>
<span class="go">Dimension coordinate: longitude</span>
<span class="go">    standard_name = &#39;longitude&#39;</span>
<span class="go">    units = &#39;degrees_east&#39;</span>
<span class="go">    Data(8) = [45.0, ..., 675.0] degrees_east</span>
<span class="go">    Bounds:units = &#39;degrees_east&#39;</span>
<span class="go">    Bounds:Data(8, 2) = [[22.5, ..., 697.5]] degrees_east</span>
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Care must be taken when combining a construct with a
<a class="reference external" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="(in NumPy v1.24)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy</span></code></a> array or a <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance, due to the ways in
which both of these objects allow themselves to be
combined with other types:</p>
<ul class="simple">
<li><p>If the construct is on the left hand side (LHS) of the
operation then, as expected, a construct is returned
whose data is the combination of the original
construct’s data and the <a class="reference external" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="(in NumPy v1.24)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy</span></code></a> array or <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a>
instance on the right hand side (RHS).</p></li>
<li><p>If, however, the construct is on the RHS then a <a class="reference external" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="(in NumPy v1.24)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy</span></code></a>
array or <a class="reference internal" href="class/cf.Data.html#cf.Data" title="cf.Data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code></a> instance (which ever type is on the
LHS) is returned, containing the same data as in the
first case.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id361">
<div class="code-block-caption"><span class="caption-text"><em>A field construct will not be returned if
the left hand operand is a numpy array or a
‘Data’ instance.</em></span><a class="headerlink" href="#id361" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">example_field</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
<span class="go">cf.field.Field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">t</span><span class="p">)</span>
<span class="go">numpy.ndarray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>
<span class="go">cf.field.Field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="go">numpy.ndarray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="go">cf.field.Field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="go">cf.data.data.Data</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unary-operations">
<span id="id105"></span><h3><a class="toc-backref" href="#id488">Unary operations</a><a class="headerlink" href="#unary-operations" title="Permalink to this headline">¶</a></h3>
<p>Python unary operators also work on the field construct’s data,
returning a new field construct with modified data values. See the
<a class="reference internal" href="class/cf.Field.html#field-unary-arithmetic"><span class="std std-ref">comprehensive list of available unary operations</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id362">
<div class="code-block-caption"><span class="caption-text"><em>Apply some unary operations to a field construct’s data.</em></span><a class="headerlink" href="#id362" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.007 0.034 0.003 0.014 0.018 0.037 0.024 0.029]</span>
<span class="go"> [0.023 0.036 0.045 0.062 0.046 0.073 0.006 0.066]</span>
<span class="go"> [0.11  0.131 0.124 0.146 0.087 0.103 0.057 0.011]</span>
<span class="go"> [0.029 0.059 0.039 0.07  0.058 0.072 0.009 0.017]</span>
<span class="go"> [0.006 0.036 0.019 0.035 0.018 0.037 0.034 0.013]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[-0.007 -0.034 -0.003 -0.014 -0.018 -0.037 -0.024 -0.029]</span>
<span class="go"> [-0.023 -0.036 -0.045 -0.062 -0.046 -0.073 -0.006 -0.066]</span>
<span class="go"> [-0.11  -0.131 -0.124 -0.146 -0.087 -0.103 -0.057 -0.011]</span>
<span class="go"> [-0.029 -0.059 -0.039 -0.07  -0.058 -0.072 -0.009 -0.017]</span>
<span class="go"> [-0.006 -0.036 -0.019 -0.035 -0.018 -0.037 -0.034 -0.013]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.007 0.034 0.003 0.014 0.018 0.037 0.024 0.029]</span>
<span class="go"> [0.023 0.036 0.045 0.062 0.046 0.073 0.006 0.066]</span>
<span class="go"> [0.11  0.131 0.124 0.146 0.087 0.103 0.057 0.011]</span>
<span class="go"> [0.029 0.059 0.039 0.07  0.058 0.072 0.009 0.017]</span>
<span class="go"> [0.006 0.036 0.019 0.035 0.018 0.037 0.034 0.013]]</span>
</pre></div>
</div>
</div>
</section>
<section id="relational-operations">
<span id="id106"></span><h3><a class="toc-backref" href="#id489">Relational operations</a><a class="headerlink" href="#relational-operations" title="Permalink to this headline">¶</a></h3>
<p>A field construct may compared with another field construct, or any
other object that is broadcastable to its data. See the
<a class="reference internal" href="class/cf.Field.html#field-comparison"><span class="std std-ref">comprehensive list of available relational operations</span></a>. The result is a field construct with Boolean
data values.</p>
<p>When comparing with another field construct, its data is actually
combined, but only after being transformed so that it is broadcastable
to the first field construct’s data. This is done by using the
metadata constructs of the two field constructs to create a mapping of
physically compatible dimensions between the fields, and then
<a class="reference internal" href="#manipulating-dimensions"><span class="std std-ref">manipulating the dimensions</span></a> of the
other field construct’s data to ensure that they are broadcastable.</p>
<p>In any case, a field construct may appear as the left or right
operand.</p>
<p>Automatic units conversions are also carried out between operands
during operations, and if one operand has no units then the units of
the other are assumed.</p>
<div class="literal-block-wrapper docutils container" id="id363">
<div class="code-block-caption"><span class="caption-text"><em>Produce field constructs of Boolean data encapsulating
the nature of some relations between a field construct and
another operand.</em></span><a class="headerlink" href="#id363" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.007 0.034 0.003 0.014 0.018 0.037 0.024 0.029]</span>
<span class="go"> [0.023 0.036 0.045 0.062 0.046 0.073 0.006 0.066]</span>
<span class="go"> [0.11  0.131 0.124 0.146 0.087 0.103 0.057 0.011]</span>
<span class="go"> [0.029 0.059 0.039 0.07  0.058 0.072 0.009 0.017]</span>
<span class="go"> [0.006 0.036 0.019 0.035 0.018 0.037 0.034 0.013]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">q</span> <span class="o">==</span> <span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[ True  True  True  True  True  True  True  True]</span>
<span class="go"> [ True  True  True  True  True  True  True  True]</span>
<span class="go"> [ True  True  True  True  True  True  True  True]</span>
<span class="go"> [ True  True  True  True  True  True  True  True]</span>
<span class="go"> [ True  True  True  True  True  True  True  True]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">q</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[ True  True  True  True  True  True  True  True]</span>
<span class="go"> [ True  True  True False  True False  True False]</span>
<span class="go"> [False False False False False False False  True]</span>
<span class="go"> [ True False  True False False False  True  True]</span>
<span class="go"> [ True  True  True  True  True  True  True  True]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">q</span> <span class="o">&gt;=</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[ True  True  True  True  True  True  True  True]</span>
<span class="go"> [ True  True  True  True  True  True False  True]</span>
<span class="go"> [ True  True  True  True  True  True  True False]</span>
<span class="go"> [ True  True  True  True  True  True False False]</span>
<span class="go"> [False  True  True  True  True  True  True False]]</span>
</pre></div>
</div>
</div>
<p>The “standard_name” and “long_name” properties are removed from the
result, which also has no units.</p>
<div class="literal-block-wrapper docutils container" id="id364">
<div class="code-block-caption"><span class="caption-text"><em>A field construct of Boolean data created from a relational
operation on a field construct and another operand will be
stripped of its standard_name property (and its long_name
property if it has been set, unlike for ‘q’ here).</em></span><a class="headerlink" href="#id364" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">identities</span><span class="p">()</span>
<span class="go">[&#39;specific_humidity&#39;,</span>
<span class="go"> &#39;Conventions=CF-1.7&#39;,</span>
<span class="go"> &#39;project=research&#39;,</span>
<span class="go"> &#39;units=1&#39;,</span>
<span class="go"> &#39;standard_name=specific_humidity&#39;,</span>
<span class="go"> &#39;ncvar%q&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">q</span> <span class="o">&gt;</span> <span class="n">q</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">identities</span><span class="p">()</span>
<span class="go">[&#39;Conventions=CF-1.7&#39;,</span>
<span class="go"> &#39;project=research&#39;,</span>
<span class="go"> &#39;units=&#39;,</span>
<span class="go"> &#39;ncvar%q&#39;]</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="#domain"><span class="std std-ref">domain</span></a> metadata constructs of the result of a
successful relational operation between two field constructs are
unambiguously well defined: The domain metadata constructs of the
result of a successful operation are copied from the left hand side
(LHS) operand, except when a coordinate construct in the LHS operand
has size 1 and the corresponding coordinate construct in right hand
side (RHS) field construct operand has size greater than 1. In this
case the coordinate construct from the RHS operand is used in the
result, to match up with the data broadcasting that will have occurred
during the operation.</p>
<p>In circumstances when domain metadata constructs in the result can not
be inferred unambiguously then an exception will be raised. For
example, this will be the case if both operands are field constructs
with corresponding coordinate constructs of size greater than 1 <em>and
with different coordinate values</em>. In such circumstances, the field
constructs’ data instances may be operated on directly, bypassing any
checks on the metadata. See <a class="reference internal" href="#operating-on-the-field-constructs-data"><span class="std std-ref">Operating on the field constructs’ data</span></a>
for more details. <em>(This will be made easier in a future release with
a new function for combining such field constructs.)</em></p>
</section>
<section id="arithmetical-and-relational-operations-with-insufficient-metadata">
<span id="id107"></span><h3><a class="toc-backref" href="#id490">Arithmetical and relational operations with insufficient metadata</a><a class="headerlink" href="#arithmetical-and-relational-operations-with-insufficient-metadata" title="Permalink to this headline">¶</a></h3>
<p>When both operands of a <a class="reference internal" href="#binary-arithmetical-operations"><span class="std std-ref">binary arithmetical</span></a> or <a class="reference internal" href="#relational-operations"><span class="std std-ref">relational</span></a> operation are field constructs then the
creation of the mapping of physically compatible dimensions relies on
there being sufficient metadata. By default, the mapping relies on
their being “strict” identities for the metadata constructs with
multi-valued data. The strict identity is restricted <code class="xref py py-obj docutils literal notranslate"><span class="pre">standard_name</span></code>
property (or <code class="xref py py-obj docutils literal notranslate"><span class="pre">id</span></code> attribute), and may be returned by the <code class="xref py py-obj docutils literal notranslate"><span class="pre">identity</span></code>
method of a construct:</p>
<div class="literal-block-wrapper docutils container" id="id365">
<div class="code-block-caption"><span class="caption-text"><em>Find the “strict” identity of a construct.</em></span><a class="headerlink" href="#id365" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">coordinate</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;latitude&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">y</span><span class="o">.</span><span class="n">standard_name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
</div>
<p>If there is insufficient metadata to create a mapping of physically
compatible dimensions, then there are various techniques that allow
the operation to proceed:</p>
<ul class="simple">
<li><p><strong>Option 1:</strong> The operation may applied to the field constructs’
data instances instead. See
<a class="reference internal" href="#operating-on-the-field-constructs-data"><span class="std std-ref">Operating on the field constructs’ data</span></a> for more details.</p></li>
<li><p><strong>Option 2:</strong> If the mapping is not possible due to the absence of
<code class="xref py py-obj docutils literal notranslate"><span class="pre">standard_name</span></code> properties (or <code class="xref py py-obj docutils literal notranslate"><span class="pre">id</span></code> attributes) on metadata
constructs that are known to correspond, then setting “relaxed
identities” with the <a class="reference internal" href="function/cf.relaxed_identities.html#cf.relaxed_identities" title="cf.relaxed_identities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.relaxed_identities</span></code></a> function may
help. Setting relaxed identities to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> allows the <code class="xref py py-obj docutils literal notranslate"><span class="pre">long_name</span></code>
property and netCDF variable name (see the <a class="reference internal" href="#netcdf-interface"><span class="std std-ref">netCDF interface</span></a>), to also be considered when identifying
constructs.</p></li>
<li><p><strong>Option 3:</strong> Add more metadata to the field and metadata constructs.</p></li>
</ul>
</section>
<section id="operating-on-the-field-constructs-data">
<span id="id108"></span><h3><a class="toc-backref" href="#id491">Operating on the field constructs’ data</a><a class="headerlink" href="#operating-on-the-field-constructs-data" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#binary-arithmetical-operations"><span class="std std-ref">Binary arithmetical</span></a> and
<a class="reference internal" href="#relational-operations"><span class="std std-ref">relational</span></a> operations between may also
be carried out on their data instances, thereby bypassing any
reference to, or checks on, the metadata constructs. This can be
useful if there <a class="reference internal" href="#arithmetical-and-relational-operations-with-insufficient-metadata"><span class="std std-ref">insufficient metadata</span></a>
for determining if the two field constructs are compatible; or if the
domain metadata constructs of the result can not be
<a class="reference internal" href="#ambiguous-result"><span class="std std-ref">unambiguously defined</span></a>.</p>
<p>In such cases the data instances may be operated on instead and the
result then inserted into one of the field constructs, either with the
<a class="reference internal" href="method/cf.Field.set_data.html#cf.Field.set_data" title="cf.Field.set_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_data</span></code></a> method of the field construct, or with
<a class="reference internal" href="#assignment-by-index"><span class="std std-ref">indexed assignment</span></a>. The former technique
is faster and more memory efficient, but the latter technique allows
broadcasting. Alternatively, for augmented assignments, the field
construct data may be changed in-place.</p>
<p>It is up to the user to ensure that the data instances are consistent
in terms of size 1 dimensions (to satisfy the <a class="reference external" href="https://docs.scipy.org/doc/numpy/user/basics.broadcasting.html">numpy broadcasting
rules</a>), dimension order and dimension direction, and that the
resulting data is compatible with the metadata of the field construct
which will contain it. Automatic units conversions are, however, still
accounted for when combining the data instances.</p>
<div class="literal-block-wrapper docutils container" id="id366">
<div class="code-block-caption"><span class="caption-text"><em>Operate on the data and use ‘set_data’ to put the
resulting data into the new field construct.</em></span><a class="headerlink" href="#id366" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="go">&lt;CF Data(): 260.0 K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_data</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">data</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span>
<span class="go">&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="go">&lt;CF Data(): 0.0 K&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id367">
<div class="code-block-caption"><span class="caption-text"><em>Update the data with indexed assignment</em></span><a class="headerlink" href="#id367" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="o">&gt;&gt;&gt;</span> <span class="n">u</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_data</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="n">u</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
 <span class="o">&lt;</span><span class="n">CF</span> <span class="n">Data</span><span class="p">():</span> <span class="mf">0.0</span> <span class="n">K</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id368">
<div class="code-block-caption"><span class="caption-text"><em>An example of augmented assignment involving the data of
two field constructs.</em></span><a class="headerlink" href="#id368" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">data</span> <span class="o">-=</span> <span class="n">t</span><span class="o">.</span><span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="go">&lt;CF Data(): 0.0 K&gt;</span>
</pre></div>
</div>
</div>
</section>
<section id="trigonometrical-and-hyperbolic-functions">
<h3><a class="toc-backref" href="#id492">Trigonometrical and hyperbolic functions</a><a class="headerlink" href="#trigonometrical-and-hyperbolic-functions" title="Permalink to this headline">¶</a></h3>
<p>The field construct and metadata constructs have methods to apply
trigonometric and hyperbolic functions, and their inverses,
element-wise to the data. These preserve the metadata but
change the construct’s units.</p>
<p>The field construct and metadata constructs support the following
trigonometrical methods:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.arccos.html#cf.Field.arccos" title="cf.Field.arccos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arccos</span></code></a></p></td>
<td><p>Take the inverse trigonometric cosine of the data
element-wise.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.arcsin.html#cf.Field.arcsin" title="cf.Field.arcsin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arcsin</span></code></a></p></td>
<td><p>Take the inverse trigonometric sine of the data
element-wise.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.arctan.html#cf.Field.arctan" title="cf.Field.arctan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arctan</span></code></a></p></td>
<td><p>Take the inverse trigonometric tangent of the data
element-wise.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.cos.html#cf.Field.cos" title="cf.Field.cos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cos</span></code></a></p></td>
<td><p>Take the trigonometric cosine of the data element-wise.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.sin.html#cf.Field.sin" title="cf.Field.sin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sin</span></code></a></p></td>
<td><p>Take the trigonometric sine of the data element-wise.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.tan.html#cf.Field.tan" title="cf.Field.tan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tan</span></code></a></p></td>
<td><p>Take the trigonometric tangent of the data element-wise.</p></td>
</tr>
</tbody>
</table>
<p>The field construct and metadata constructs also support the following
hyperbolic methods:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.arccosh.html#cf.Field.arccosh" title="cf.Field.arccosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arccosh</span></code></a></p></td>
<td><p>Take the inverse hyperbolic cosine of the data
element-wise.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.arcsinh.html#cf.Field.arcsinh" title="cf.Field.arcsinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arcsinh</span></code></a></p></td>
<td><p>Take the inverse hyperbolic sine of the data
element-wise.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.arctanh.html#cf.Field.arctanh" title="cf.Field.arctanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arctanh</span></code></a></p></td>
<td><p>Take the inverse hyperbolic tangent of the data
element-wise.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.cosh.html#cf.Field.cosh" title="cf.Field.cosh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cosh</span></code></a></p></td>
<td><p>Take the hyperbolic cosine of the data element-wise.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.sinh.html#cf.Field.sinh" title="cf.Field.sinh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sinh</span></code></a></p></td>
<td><p>Take the hyperbolic sine of the data element-wise.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.tanh.html#cf.Field.tanh" title="cf.Field.tanh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tanh</span></code></a></p></td>
<td><p>Take the hyperbolic tangent of the data element-wise.</p></td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container" id="id369">
<div class="code-block-caption"><span class="caption-text"><em>Find the sine of each latitude coordinate value.</em></span><a class="headerlink" href="#id369" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">dimension_coordinate</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;CF Data(5): [-75.0, ..., 75.0] degrees_north&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sin_lat</span> <span class="o">=</span> <span class="n">lat</span><span class="o">.</span><span class="n">sin</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sin_lat</span><span class="o">.</span><span class="n">data</span>
<span class="go">&lt;CF Data(5): [-0.9659258262890683, ..., 0.9659258262890683] 1&gt;</span>
</pre></div>
</div>
</div>
<p>The “standard_name” and “long_name” properties are removed from the
result.</p>
<p>Note that a number of the inverse methods have
<a class="reference external" href="https://mathworld.wolfram.com/InverseTrigonometricFunctions.html">mathematically restricted domains</a> (see also
<a class="reference external" href="https://mathworld.wolfram.com/InverseHyperbolicFunctions.html">here</a>)
and therefore may return
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/constants.html">“invalid” values</a>
(<code class="xref py py-obj docutils literal notranslate"><span class="pre">nan</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">inf</span></code>). When applying these methods to constructs with masked
data, you may prefer to output masked values instead of invalid ones. In
this case, you can use <code class="xref py py-obj docutils literal notranslate"><span class="pre">masked_invalid</span></code> to do the conversion afterwards:</p>
<div class="literal-block-wrapper docutils container" id="id370">
<div class="code-block-caption"><span class="caption-text"><em>Take the `arctanh` of some masked data and then transform
resultant invalid values into masked data values.</em></span><a class="headerlink" href="#id370" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">mask</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">arctanh</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[-- nan inf 0.5493061443340548 --]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[-- -- -- 0.5493061443340548 --]</span>
</pre></div>
</div>
</div>
</section>
<section id="exponential-and-logarithmic-functions">
<h3><a class="toc-backref" href="#id493">Exponential and logarithmic functions</a><a class="headerlink" href="#exponential-and-logarithmic-functions" title="Permalink to this headline">¶</a></h3>
<p>The field construct and metadata constructs have <a class="reference internal" href="method/cf.Field.exp.html#cf.Field.exp" title="cf.Field.exp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exp</span></code></a> and
<a class="reference internal" href="method/cf.Field.log.html#cf.Field.log" title="cf.Field.log"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log</span></code></a> methods for applying exponential and logarithmic
functions respectively element-wise to the data, preserving the
metadata but changing the construct’s units where required.</p>
<div class="literal-block-wrapper docutils container" id="id371">
<div class="code-block-caption"><span class="caption-text"><em>Find the logarithms and exponentials of field constructs.</em></span><a class="headerlink" href="#id371" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span>
<span class="go">&lt;CF Field: specific_humidity(latitude(5), longitude(8)) 1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">&lt;CF Field: specific_humidity(latitude(5), longitude(8)) ln(re 1)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">&lt;CF Field: specific_humidity(latitude(5), longitude(8)) 1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) K&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">&lt;CF Field: air_temperature(atmosphere_hybrid_height_coordinate(1), grid_latitude(10), grid_longitude(9)) lg(re 1 K)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>  <span class="c1"># Raises Exception</span>
<span class="go">ValueError: Can&#39;t take exponential of dimensional quantities: &lt;Units: K&gt;</span>
</pre></div>
</div>
</div>
<p>The “standard_name” and “long_name” properties are removed from the
result.</p>
</section>
<section id="rounding-and-truncation">
<h3><a class="toc-backref" href="#id494">Rounding and truncation</a><a class="headerlink" href="#rounding-and-truncation" title="Permalink to this headline">¶</a></h3>
<p>The field construct and metadata constructs the following methods to
round and truncate their data:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 79%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.ceil.html#cf.Field.ceil" title="cf.Field.ceil"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ceil</span></code></a></p></td>
<td><p>The ceiling of the data, element-wise.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.clip.html#cf.Field.clip" title="cf.Field.clip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clip</span></code></a></p></td>
<td><p>Limit the values in the data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.floor.html#cf.Field.floor" title="cf.Field.floor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">floor</span></code></a></p></td>
<td><p>Floor the data array, element-wise.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.rint.html#cf.Field.rint" title="cf.Field.rint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rint</span></code></a></p></td>
<td><p>Round the data to the nearest integer, element-wise.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="method/cf.Field.round.html#cf.Field.round" title="cf.Field.round"><code class="xref py py-obj docutils literal notranslate"><span class="pre">round</span></code></a></p></td>
<td><p>Round the data to the given number of decimals.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="method/cf.Field.trunc.html#cf.Field.trunc" title="cf.Field.trunc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trunc</span></code></a></p></td>
<td><p>Truncate the data, element-wise.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="moving-windows">
<h3><a class="toc-backref" href="#id495">Moving windows</a><a class="headerlink" href="#moving-windows" title="Permalink to this headline">¶</a></h3>
<p>Moving window calculations along an axis may be created with the
<a class="reference internal" href="method/cf.Field.moving_window.html#cf.Field.moving_window" title="cf.Field.moving_window"><code class="xref py py-obj docutils literal notranslate"><span class="pre">moving_window</span></code></a> method of the field construct.</p>
<p>Moving mean, sum, and integral calculations are possible.</p>
<p>By default moving means are unweighted, but weights based on the axis
cell sizes (or custom weights) may applied to the calculation.</p>
<div class="literal-block-wrapper docutils container" id="id372">
<div class="code-block-caption"><span class="caption-text"><em>Calculate a 3-point weighted mean of the ‘X’ axis. Since
the the ‘X’ axis is cyclic, the mean wraps by default.</em></span><a class="headerlink" href="#id372" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;file.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.007 0.034 0.003 0.014 0.018 0.037 0.024 0.029]</span>
<span class="go"> [0.023 0.036 0.045 0.062 0.046 0.073 0.006 0.066]</span>
<span class="go"> [0.11  0.131 0.124 0.146 0.087 0.103 0.057 0.011]</span>
<span class="go"> [0.029 0.059 0.039 0.07  0.058 0.072 0.009 0.017]</span>
<span class="go"> [0.006 0.036 0.019 0.035 0.018 0.037 0.034 0.013]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">coordinate</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[  0.  45.]</span>
<span class="go"> [ 45.  90.]</span>
<span class="go"> [ 90. 135.]</span>
<span class="go"> [135. 180.]</span>
<span class="go"> [180. 225.]</span>
<span class="go"> [225. 270.]</span>
<span class="go"> [270. 315.]</span>
<span class="go"> [315. 360.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">iscyclic</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">moving_window</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean longitude(8): mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[0.02333 0.01467 0.017   0.01167 0.023   0.02633 0.03    0.02   ]</span>
<span class="go"> [0.04167 0.03467 0.04767 0.051   0.06033 0.04167 0.04833 0.03167]</span>
<span class="go"> [0.084   0.12167 0.13367 0.119   0.112   0.08233 0.057   0.05933]</span>
<span class="go"> [0.035   0.04233 0.056   0.05567 0.06667 0.04633 0.03267 0.01833]</span>
<span class="go"> [0.01833 0.02033 0.03    0.024   0.03    0.02967 0.028   0.01767]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">coordinate</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[-45.  90.]</span>
<span class="go"> [  0. 135.]</span>
<span class="go"> [ 45. 180.]</span>
<span class="go"> [ 90. 225.]</span>
<span class="go"> [135. 270.]</span>
<span class="go"> [180. 315.]</span>
<span class="go"> [225. 360.]</span>
<span class="go"> [270. 360.]]</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="method/cf.Field.moving_window.html#cf.Field.moving_window" title="cf.Field.moving_window"><code class="xref py py-obj docutils literal notranslate"><span class="pre">moving_window</span></code></a> method can not, in general, be
emulated by the <a class="reference internal" href="method/cf.Field.convolution_filter.html#cf.Field.convolution_filter" title="cf.Field.convolution_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convolution_filter</span></code></a> method, as the
latter i) can not change the window weights as the filter
passes through the axis; and ii) does not update the cell
method constructs.</p>
</div>
</section>
<section id="convolution-filters">
<h3><a class="toc-backref" href="#id496">Convolution filters</a><a class="headerlink" href="#convolution-filters" title="Permalink to this headline">¶</a></h3>
<p>A <a class="reference external" href="https://en.wikipedia.org/wiki/Convolution">convolution</a> of the
field construct data with a filter along a single domain axis can be
calculated, which also updates the bounds of a relevant dimension
coordinate construct to account for the width of the
filter. Convolution filters are carried with the
<a class="reference internal" href="method/cf.Field.convolution_filter.html#cf.Field.convolution_filter" title="cf.Field.convolution_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convolution_filter</span></code></a> method of the field construct.</p>
<div class="literal-block-wrapper docutils container" id="id373">
<div class="code-block-caption"><span class="caption-text"><em>Calculate a 5-point mean of the ‘X’ axis with a
non-uniform window function. Since the the ‘X’ axis is
cyclic, the convolution wraps by default.</em></span><a class="headerlink" href="#id373" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">iscyclic</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">convolution_filter</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">dimension_coordinate</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[  0.  45.]</span>
<span class="go"> [ 45.  90.]</span>
<span class="go"> [ 90. 135.]</span>
<span class="go"> [135. 180.]</span>
<span class="go"> [180. 225.]</span>
<span class="go"> [225. 270.]</span>
<span class="go"> [270. 315.]</span>
<span class="go"> [315. 360.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">dimension_coordinate</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[-90. 135.]</span>
<span class="go"> [-45. 180.]</span>
<span class="go"> [  0. 225.]</span>
<span class="go"> [ 45. 270.]</span>
<span class="go"> [ 90. 315.]</span>
<span class="go"> [135. 360.]</span>
<span class="go"> [180. 405.]</span>
<span class="go"> [225. 450.]]</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="method/cf.Field.convolution_filter.html#cf.Field.convolution_filter" title="cf.Field.convolution_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convolution_filter</span></code></a> method of the field construct also has
options to</p>
<ul class="simple">
<li><p>Specify how the input array is extended when the filter overlaps a
border, and</p></li>
<li><p>Control the placement position of the filter window.</p></li>
</ul>
<p>Note that the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.windows.html#module-scipy.signal.windows" title="(in SciPy v1.10.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.signal.windows</span></code></a> package has suite of window
functions for creating window weights for filtering:</p>
<div class="literal-block-wrapper docutils container" id="id374">
<div class="code-block-caption"><span class="caption-text"><em>Calculate a 3-point exponential filter of the ‘Y’
axis. Since the ‘Y’ axis is not cyclic, the convolution
by default inserts missing data at points for which the
filter window extends beyond the array.</em></span><a class="headerlink" href="#id374" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">windows</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exponential_window</span> <span class="o">=</span> <span class="n">windows</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">exponential_window</span><span class="p">)</span>
<span class="go">[0.36787944 1.         0.36787944]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">convolution_filter</span><span class="p">(</span><span class="n">exponential_window</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[--      --      --      --      --      --      --      --     ]</span>
<span class="go"> [0.06604 0.0967  0.09172 0.12086 0.08463 0.1245  0.0358  0.08072]</span>
<span class="go"> [0.12913 0.16595 0.1549  0.19456 0.12526 0.15634 0.06252 0.04153]</span>
<span class="go"> [0.07167 0.12044 0.09161 0.13659 0.09663 0.1235  0.04248 0.02583]</span>
<span class="go"> [--      --      --      --      --      --      --      --     ]]</span>
</pre></div>
</div>
</div>
<p>The magnitude of the integral of the filter (i.e. the sum of the
window weights defined by the <em>window</em> parameter) affects the
convolved values. For example, window weights of <code class="docutils literal notranslate"><span class="pre">[0.2,</span> <span class="pre">0.2</span> <span class="pre">0.2,</span> <span class="pre">0.2,</span>
<span class="pre">0.2]</span></code> will produce a non-weighted 5-point running mean; and window
weights of <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1]</span></code> will produce a 5-point running
sum. Note that the window weights returned by functions of the
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.windows.html#module-scipy.signal.windows" title="(in SciPy v1.10.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.signal.windows</span></code></a> package do not necessarily sum to 1.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="method/cf.Field.moving_window.html#cf.Field.moving_window" title="cf.Field.moving_window"><code class="xref py py-obj docutils literal notranslate"><span class="pre">moving_window</span></code></a> method can not, in general, be
emulated by the <a class="reference internal" href="method/cf.Field.convolution_filter.html#cf.Field.convolution_filter" title="cf.Field.convolution_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convolution_filter</span></code></a> method, as the
latter i) can not change the window weights as the filter
passes through the axis; and ii) does not update the cell
method constructs.</p>
</div>
</section>
<section id="general-first-order-derivative">
<h3><a class="toc-backref" href="#id497">General first order derivative</a><a class="headerlink" href="#general-first-order-derivative" title="Permalink to this headline">¶</a></h3>
<p>The derivative along a dimension of the field construct’s data can be
calculated as a centred finite difference with the <a class="reference internal" href="method/cf.Field.derivative.html#cf.Field.derivative" title="cf.Field.derivative"><code class="xref py py-obj docutils literal notranslate"><span class="pre">derivative</span></code></a>
method. If the axis is <a class="reference internal" href="#cyclic-domain-axes"><span class="std std-ref">cyclic</span></a> then the
derivative wraps around by default, otherwise it may be forced to wrap
around; a one-sided difference is calculated at the edges; or missing
data is inserted.</p>
<div class="literal-block-wrapper docutils container" id="id375">
<div class="code-block-caption"><span class="caption-text"><em>Calculate for a field construct’s data the derivative along both
the ‘X’ and ‘Y’ axes, where the former (by default) uses missing
values in the calculation, but the latter has been told to use a
one-sided finite difference at the boundary.</em></span><a class="headerlink" href="#id375" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">one_sided_at_boundary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="gradient-vector">
<h3><a class="toc-backref" href="#id498">Gradient vector</a><a class="headerlink" href="#gradient-vector" title="Permalink to this headline">¶</a></h3>
<p>The horizontal gradient vector of a scalar field may calculated with
the <a class="reference internal" href="method/cf.Field.grad_xy.html#cf.Field.grad_xy" title="cf.Field.grad_xy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grad_xy</span></code></a> method when the field has dimension coordinates
of X and Y, in either Cartesian (e.g. plane projection) or spherical
polar coordinate systems.</p>
<p>The horizontal gradient vector in Cartesian coordinates is given by:</p>
<div class="math notranslate nohighlight">
\[\nabla f(x, y) = \left(
\frac{\partial f}{\partial x},
\frac{\partial f}{\partial y}
\right)\]</div>
<p>The horizontal gradient vector in spherical polar coordinates is given
by:</p>
<div class="math notranslate nohighlight">
\[\nabla f(\theta, \phi) = \left(
\frac{1}{r}
\frac{\partial f}{\partial \theta},
\frac{1}{r \sin\theta}
\frac{\partial f}{\partial \phi}
\right)\]</div>
<p>where <em>r</em> is radial distance to the origin, <span class="math notranslate nohighlight">\(\theta\)</span> is the
polar angle with respect to polar axis, and <span class="math notranslate nohighlight">\(\phi\)</span> is the
azimuthal angle.</p>
<p>See <a class="reference internal" href="method/cf.Field.grad_xy.html#cf.Field.grad_xy" title="cf.Field.grad_xy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Field.grad_xy</span></code></a> for details and examples.</p>
</section>
<section id="laplacian">
<h3><a class="toc-backref" href="#id499">Laplacian</a><a class="headerlink" href="#laplacian" title="Permalink to this headline">¶</a></h3>
<p>The horizontal Laplacian of a scalar field may be calculated with the
<a class="reference internal" href="method/cf.Field.laplacian_xy.html#cf.Field.laplacian_xy" title="cf.Field.laplacian_xy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">laplacian_xy</span></code></a> method when the field has dimension coordinates
of X and Y, in either Cartesian (e.g. plane projection) or spherical
polar coordinate systems.</p>
<p>The horizontal Laplacian in Cartesian coordinates is given by:</p>
<div class="math notranslate nohighlight">
\[\nabla^2 f(x, y) = \frac{\partial^2 f}{\partial x^2}
+
\frac{\partial^2 f}{\partial y^2}\]</div>
<p>The horizontal Laplacian in spherical polar coordinates is given by:</p>
<div class="math notranslate nohighlight">
\[\nabla^2 f(\theta, \phi) =
\frac{1}{r^2 \sin\theta}
\frac{\partial}{\partial \theta}
\left(
\sin\theta
\frac{\partial f}{\partial \theta}
\right)
+
\frac{1}{r^2 \sin^2\theta}
\frac{\partial^2 f}{\partial \phi^2}\]</div>
<p>where <em>r</em> is radial distance to the origin, <span class="math notranslate nohighlight">\(\theta\)</span> is the
polar angle with respect to polar axis, and <span class="math notranslate nohighlight">\(\phi\)</span> is the
azimuthal angle.</p>
<p>See <a class="reference internal" href="method/cf.Field.laplacian_xy.html#cf.Field.laplacian_xy" title="cf.Field.laplacian_xy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Field.laplacian_xy</span></code></a> for details and examples.</p>
</section>
<section id="divergence">
<h3><a class="toc-backref" href="#id500">Divergence</a><a class="headerlink" href="#divergence" title="Permalink to this headline">¶</a></h3>
<p>The horizontal divergence may be calculated with the <a class="reference internal" href="function/cf.div_xy.html#cf.div_xy" title="cf.div_xy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.div_xy</span></code></a>
function from orthogonal vector component fields which have dimension
coordinates of X and Y, in either Cartesian (e.g. plane projection) or
spherical polar coordinate systems.</p>
<p>The horizontal divergence of the <span class="math notranslate nohighlight">\((f_x, f_y)\)</span> vector in
Cartesian coordinates is given by:</p>
<div class="math notranslate nohighlight">
\[\nabla \cdot (f_{x}(x,y), f_{y}(x,y)) =
\frac{\partial f_x}{\partial x}
+
\frac{\partial f_y}{\partial y}\]</div>
<p>The horizontal divergence of the <span class="math notranslate nohighlight">\((f_\theta, f_\phi)\)</span> vector in
spherical polar coordinates is given by:</p>
<div class="math notranslate nohighlight">
\[\nabla \cdot (f_\theta(\theta,\phi), f_\phi(\theta,\phi)) =
\frac{1}{r \sin\theta}
\left(
\frac{\partial (f_\theta \sin\theta)}{\partial \theta}
+
\frac{\partial f_\phi}{\partial \phi}
\right)\]</div>
<p>where <em>r</em> is radial distance to the origin, <span class="math notranslate nohighlight">\(\theta\)</span> is the
polar angle with respect to polar axis, and <span class="math notranslate nohighlight">\(\phi\)</span> is the
azimuthal angle.</p>
<p>See <a class="reference internal" href="function/cf.div_xy.html#cf.div_xy" title="cf.div_xy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.div_xy</span></code></a> for details and examples.</p>
</section>
<section id="curl">
<h3><a class="toc-backref" href="#id501">Curl</a><a class="headerlink" href="#curl" title="Permalink to this headline">¶</a></h3>
<p>The horizontal curl may be calculated with the <a class="reference internal" href="function/cf.curl_xy.html#cf.curl_xy" title="cf.curl_xy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.curl_xy</span></code></a> function
from orthogonal vector component fields which have dimension
coordinates of X and Y, in either Cartesian (e.g. plane projection) or
spherical polar coordinate systems.</p>
<p>The horizontal curl of the <span class="math notranslate nohighlight">\((f_x, f_y)\)</span> vector in Cartesian
coordinates is given by:</p>
<div class="math notranslate nohighlight">
\[\nabla \times (f_{x}(x,y), f_{y}(x,y)) =
\frac{\partial f_y}{\partial x}
-
\frac{\partial f_x}{\partial y}\]</div>
<p>The horizontal curl of the <span class="math notranslate nohighlight">\((f_\theta, f_\phi)\)</span> vector in
spherical polar coordinates is given by:</p>
<div class="math notranslate nohighlight">
\[\nabla \times (f_\theta(\theta,\phi), f_\phi(\theta,\phi)) =
\frac{1}{r \sin\theta}
\left(
\frac{\partial (f_\phi \sin\theta)}{\partial \theta}
-
\frac{\partial f_\theta}{\partial \phi}
\right)\]</div>
<p>where <em>r</em> is radial distance to the origin, <span class="math notranslate nohighlight">\(\theta\)</span> is the
polar angle with respect to polar axis, and <span class="math notranslate nohighlight">\(\phi\)</span> is the
azimuthal angle.</p>
<p>See <a class="reference internal" href="function/cf.curl_xy.html#cf.curl_xy" title="cf.curl_xy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.curl_xy</span></code></a> for details and examples.</p>
</section>
<section id="relative-vorticity">
<h3><a class="toc-backref" href="#id502">Relative vorticity</a><a class="headerlink" href="#relative-vorticity" title="Permalink to this headline">¶</a></h3>
<p>The relative vorticity of the wind may be calculated on a global or
limited area domain, and in Cartesian or spherical polar coordinate
systems.</p>
<p>The relative vorticity of wind defined on a Cartesian domain (such as
a <a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#appendix-grid-mappings">Plane projection</a>) is defined as</p>
<div class="math notranslate nohighlight">
\[\zeta _{cartesian} = \frac{\delta v}{\delta x} -
\frac{\delta u}{\delta y}\]</div>
<p>where <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are points on along the ‘X’ and ‘Y’
Cartesian dimensions respectively; and <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> denote
the ‘X’ and ‘Y’ components of the horizontal winds.</p>
<p>If the wind field is defined on a spherical latitude-longitude
domain then a correction factor is included:</p>
<div class="math notranslate nohighlight">
\[\zeta _{spherical} = \frac{\delta v}{\delta x} -
\frac{\delta u}{\delta y} + \frac{u}{r}tan(\phi)\]</div>
<p>where <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> denote the longitudinal and latitudinal
components of the horizontal wind field; <span class="math notranslate nohighlight">\(r\)</span> is the radius of
the Earth; and <span class="math notranslate nohighlight">\(\phi\)</span> is the latitude at each point.</p>
<p>The <a class="reference internal" href="function/cf.relative_vorticity.html#cf.relative_vorticity" title="cf.relative_vorticity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.relative_vorticity</span></code></a> function creates a relative vorticity
field construct from field constructs containing the wind components
using finite differences to approximate the derivatives. Dimensions
other than ‘X’ and ‘Y’ remain unchanged by the operation.</p>
<div class="literal-block-wrapper docutils container" id="id376">
<div class="code-block-caption"><span class="caption-text"><em>Generate a relative vorticity field construct from wind
component field constructs, then round the field’s data to
8 decimal places.</em></span><a class="headerlink" href="#id376" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;wind_components.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zeta</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">relative_vorticity</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">zeta</span><span class="p">)</span>
<span class="go">Field: atmosphere_relative_vorticity (ncvar%va)</span>
<span class="go">-----------------------------------------------</span>
<span class="go">Data            : atmosphere_relative_vorticity(time(1), atmosphere_hybrid_height_coordinate(1), latitude(9), longitude(8)) s-1</span>
<span class="go">Dimension coords: time(1) = [1978-09-01 06:00:00] 360_day</span>
<span class="go">                : atmosphere_hybrid_height_coordinate(1) = [9.9982] m</span>
<span class="go">                : latitude(9) = [-90, ..., 70] degrees_north</span>
<span class="go">                : longitude(8) = [0, ..., 315] degrees_east</span>
<span class="go">Coord references: standard_name:atmosphere_hybrid_height_coordinate</span>
<span class="go">Domain ancils   : atmosphere_hybrid_height_coordinate(atmosphere_hybrid_height_coordinate(1)) = [9.9982] m</span>
<span class="go">                : long_name=vertical coordinate formula term: b(k)(atmosphere_hybrid_height_coordinate(1)) = [0.9989]</span>
<span class="go">                : surface_altitude(latitude(9), longitude(8)) = [[2816.25, ..., 2325.98]] m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">zeta</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="go">[[[[--        --        --        --        --        --        --        --       ]</span>
<span class="go">   [-2.04e-06  1.58e-06  5.19e-06  4.74e-06 -4.76e-06 -2.27e-06  9.55e-06 -3.64e-06]</span>
<span class="go">   [-8.4e-07  -4.37e-06 -3.55e-06 -2.31e-06 -3.6e-07  -8.58e-06 -2.45e-06  6.5e-07 ]</span>
<span class="go">   [ 4.08e-06  4.55e-06  2.75e-06  4.15e-06  5.16e-06  4.17e-06  4.67e-06 -7e-07   ]</span>
<span class="go">   [-1.4e-07  -3.5e-07  -1.27e-06 -1.29e-06  2.01e-06  4.4e-07  -2.5e-06   2.05e-06]</span>
<span class="go">   [-7.3e-07  -1.59e-06 -1.77e-06 -3.13e-06 -7.9e-07  -5.1e-07  -2.79e-06  1.12e-06]</span>
<span class="go">   [-3.7e-07   7.1e-07   1.52e-06  6.5e-07  -2.75e-06 -4.3e-07   1.62e-06 -6.6e-07 ]</span>
<span class="go">   [ 9.5e-07  -8e-07     6.6e-07   7.2e-07  -2.13e-06 -4.5e-07  -7.5e-07  -1.11e-06]</span>
<span class="go">   [--        --        --        --        --        --        --        --       ]]]]</span>
</pre></div>
</div>
</div>
<p>For axes that are not <a class="reference internal" href="#cyclic-domain-axes"><span class="std std-ref">cyclic</span></a>, missing data
is inserted at the edges by default; otherwise it may be forced to
wrap around, or a one-sided difference is calculated at the edges. If
the longitudinal axis is <a class="reference internal" href="#cyclic-domain-axes"><span class="std std-ref">cyclic</span></a> then the
derivative wraps around by default.</p>
<hr class="docutils" />
</section>
</section>
<section id="controlling-output-messages">
<span id="id110"></span><h2><a class="toc-backref" href="#id503"><strong>Controlling output messages</strong></a><a class="headerlink" href="#controlling-output-messages" title="Permalink to this headline">¶</a></h2>
<p>cf will produce messages upon the execution of operations, to
provide feedback about:</p>
<ul class="simple">
<li><p>the progress of, and under-the-hood steps involved in, the
operations it is performing;</p></li>
<li><p>the events that emerge during these operations;</p></li>
<li><p>the nature of the dataset being operated on, including CF compliance
issues that may be encountered during the operation.</p></li>
</ul>
<p>This feedback may be purely informational, or may convey warning(s)
about dataset issues or the potential for future error(s).</p>
<p>It is possible to configure the extent to which messages are output at
runtime, i.e. the verbosity of cf, so that less serious and/or more
detailed messages can be filtered out.</p>
<p>There are two means to do this, which are covered in more detail in
the sub-sections below. Namely, you may configure the extent of
messaging:</p>
<ul class="simple">
<li><p><strong>globally</strong> i.e. for all cf operations, by setting the
<a class="reference internal" href="function/cf.log_level.html#cf.log_level" title="cf.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.log_level</span></code></a> which controls the project-wide logging;</p></li>
<li><p><strong>for a specific function only</strong> (for many functions) by setting
that function’s <em>verbose</em> keyword argument (which overrides the
global setting for the duration of the function call).</p></li>
</ul>
<p>Both possibilities use a consistent level-based cut-off system, as
detailed below.</p>
<section id="logging">
<span id="id111"></span><h3><a class="toc-backref" href="#id504">Logging</a><a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h3>
<p>All messages from cf, excluding exceptions which are always raised
in error cases, are incorporated into a logging system which assigns
to each a level based on the relative seriousness and/or
verbosity. From highest to lowest on this scale, these levels are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'WARNING'</span></code>: conveys a warning;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'INFO'</span></code>: provides information concisely, in a few lines or so;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'DETAIL'</span></code>: provides information in a more detailed manner than
<code class="docutils literal notranslate"><span class="pre">'INFO'</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'DEBUG'</span></code>: produces highly-verbose information intended mainly for
the purposes of debugging and cf library development.</p></li>
</ul>
<p>The function <a class="reference internal" href="function/cf.log_level.html#cf.log_level" title="cf.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.log_level</span></code></a> sets the minimum of these levels for
which messages are displayed. Any message marked as being of any lower
level will be filtered out. Note it sets the verbosity <em>globally</em>, for
<em>all</em> cf library operations (unless these are overridden for
individual functions, as covered below).</p>
<p>As well as the named log levels above, <a class="reference internal" href="function/cf.log_level.html#cf.log_level" title="cf.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.log_level</span></code></a> accepts a
further identifier, <code class="docutils literal notranslate"><span class="pre">'DISABLE'</span></code>. Each of these potential settings
has a numerical value that is treated interchangeably and may instead
be set (as this may be easier to recall and write, if less
explicit). The resulting behaviour in each case is as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 16%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Log level</p></th>
<th class="head"><p>Integer code</p></th>
<th class="head"><p>Result when set as the log severity level</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'DISABLE'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
<td><p><em>Disable all</em> logging messages. Note this
does not include exception messages
raised by errors.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'WARNING'</span></code> (default)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p><em>Only show</em> logging messages that are
<em>warnings</em> (those labelled as
<code class="docutils literal notranslate"><span class="pre">'WARNING'</span></code>).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'INFO'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><p><em>Only show</em> logging messages that are
<em>warnings or concise informational
messages</em> (marked as <code class="docutils literal notranslate"><span class="pre">'WARNING'</span></code> or
<code class="docutils literal notranslate"><span class="pre">'INFO'</span></code> respectively).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'DETAIL'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">3</span></code></p></td>
<td><p><em>Enable all</em> logging messages <em>except
for debugging messages</em>. In other words,
show logging messages labelled
<code class="docutils literal notranslate"><span class="pre">'WARNING'</span></code>, <code class="docutils literal notranslate"><span class="pre">'INFO'</span></code> and
<code class="docutils literal notranslate"><span class="pre">'DETAIL'</span></code>, but not <code class="docutils literal notranslate"><span class="pre">'DEBUG'</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'DEBUG'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-1</span></code></p></td>
<td><p><em>Enable all</em> logging messages,
<em>including debugging messages</em>
(labelled as <code class="docutils literal notranslate"><span class="pre">'DEBUG'</span></code>).</p></td>
</tr>
</tbody>
</table>
<p>Note <code class="docutils literal notranslate"><span class="pre">'DEBUG'</span></code> is intended as a special case for debugging, which
should not be required in general usage of cf, hence its equivalence
to <code class="docutils literal notranslate"><span class="pre">-1</span></code> rather than <code class="docutils literal notranslate"><span class="pre">4</span></code> which would follow the increasing integer
code pattern.  <code class="docutils literal notranslate"><span class="pre">-1</span></code> reflects that it is the final value in the
sequence, as with Python indexing.</p>
<p>The default value for <a class="reference internal" href="function/cf.log_level.html#cf.log_level" title="cf.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.log_level</span></code></a> is <code class="docutils literal notranslate"><span class="pre">'WARNING'</span></code> (<code class="docutils literal notranslate"><span class="pre">1</span></code>).
However, whilst completing this tutorial, it may be instructive to set
the log level` to a higher verbosity level such as <code class="docutils literal notranslate"><span class="pre">'INFO'</span></code> to gain
insight into the internal workings of cf calls.</p>
</section>
<section id="function-verbosity">
<span id="id112"></span><h3><a class="toc-backref" href="#id505">Function verbosity</a><a class="headerlink" href="#function-verbosity" title="Permalink to this headline">¶</a></h3>
<p>Functions and methods that involve a particularly high number of steps
or especially complex processing, for example the <a class="reference internal" href="function/cf.read.html#cf.read" title="cf.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.read</span></code></a> and
<a class="reference internal" href="function/cf.write.html#cf.write" title="cf.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.write</span></code></a> functions, accept a keyword argument <em>verbose</em>. This be
set to change the minimum log level at which messages are displayed
for the function/method call only, without being influenced by, or
influencing, the global <a class="reference internal" href="function/cf.log_level.html#cf.log_level" title="cf.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.log_level</span></code></a> value.</p>
<p>A <em>verbose</em> value effectively overrides the value of <a class="reference internal" href="function/cf.log_level.html#cf.log_level" title="cf.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.log_level</span></code></a>
for the function/method along with any functions/methods it calls in
turn, until the origin function/method completes.</p>
<p>The <em>verbose</em> argument accepts the same levels as <a class="reference internal" href="function/cf.log_level.html#cf.log_level" title="cf.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.log_level</span></code></a>
(including <code class="docutils literal notranslate"><span class="pre">0</span></code> for <code class="docutils literal notranslate"><span class="pre">'DISABLE'</span></code>), as described in <a class="reference internal" href="#logging"><span class="std std-ref">the logging
section</span></a>, namely either an integer or a corresponding string
for example <code class="docutils literal notranslate"><span class="pre">verbose=2</span></code> or equivalently <code class="docutils literal notranslate"><span class="pre">verbose='INFO'</span></code>
(or <code class="docutils literal notranslate"><span class="pre">verbose='info'</span></code> since case is ignored).</p>
<p>By default, <em>verbose</em> is set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, in which case the value of the
<a class="reference internal" href="function/cf.log_level.html#cf.log_level" title="cf.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.log_level</span></code></a> setting is used to determine which messages,
if any, are filtered out.</p>
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="dap"><span class="brackets"><a class="fn-backref" href="#id6">1</a></span></dt>
<dd><p>Requires the netCDF4 python package to have been built with
OPeNDAP support enabled. See
<a class="reference external" href="http://unidata.github.io/netcdf4-python">http://unidata.github.io/netcdf4-python</a> for details.</p>
</dd>
<dt class="label" id="um"><span class="brackets"><a class="fn-backref" href="#id84">2</a></span></dt>
<dd><p>For example, if the LBYR, LBMON, LBDAY and LBHR entries are
all zero for the first header in a 32-bit PP file, the file
format can not reliably be detected automatically.</p>
</dd>
<dt class="label" id="sigma"><span class="brackets"><a class="fn-backref" href="#id48">3</a></span></dt>
<dd><p><a class="reference external" href="https://cfconventions.org/cf-conventions/cf-conventions.html#_ocean_sigma_coordinate">https://cfconventions.org/cf-conventions/cf-conventions.html#_ocean_sigma_coordinate</a></p>
</dd>
</dl>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2023, NCAS | Page built on 2023-01-31.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>