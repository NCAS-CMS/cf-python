
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>cf.Field.bin &#8212; Documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/customise-alabaster.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/clipboard.min.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="../_static/toggleprompt.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="cf.Field.digitize" href="cf.Field.digitize.html" />
    <link rel="prev" title="cf.Field.cumsum" href="cf.Field.cumsum.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">



<h1 class="logo"><a href="../index.html">cf 3.9.0</a></h1>



<p class="blurb">A CF-compliant earth science data analysis library</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=NCAS-CMS&repo=cf-python&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html"><strong>Introduction</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../cf_data_model.html"><strong>CF data model</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html"><strong>Installation</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html"><strong>Contributing</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html"><strong>Tutorial</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis.html"><strong>Analysis</strong></a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api_reference.html"><strong>API reference</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../aggregation_rules.html"><strong>Aggregation rules</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance.html"><strong>Performance</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html"><strong>Releases</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../Changelog.html"><strong>Change log</strong></a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../api_reference.html"><strong>API reference</strong></a><ul>
  <li><a href="../class.html"><strong>cf classes</strong></a><ul>
  <li><a href="../class/cf.Field.html">cf.Field</a><ul>
      <li>Previous: <a href="cf.Field.cumsum.html" title="previous chapter">cf.Field.cumsum</a></li>
      <li>Next: <a href="cf.Field.digitize.html" title="next chapter">cf.Field.digitize</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>

<br>
cf development has been supported by
the <a href="https://erc.europa.eu/">ERC</a>
through <a href="https://cordis.europa.eu/project/id/247220">Seachange</a>
and
<a href="https://cordis.europa.eu/project/id/786427">Couplet</a>; by
the <a href="https://ec.europa.eu/programmes/horizon2020/">EC Horizon
2020 programme</a> through
<a href="https://cordis.europa.eu/project/id/824084">IS-ENES3</a>;
by <a href="https://nerc.ukri.org/">NERC</a> through
<a href="https://gtr.ukri.org/project/0D95A6DB-0B95-48F7-8A8B-7B9A47DEA117">UKFAFMIP</a>;
and by <a href="https://ncas.ac.uk/">NCAS</a>.
<br>
<br>
<img src="../_templates/logo_EC.png" height="40">
<img src="../_templates/logo_ERC.png" height="40">
<img src="../_templates/logo_NERC.png" height="40">
<br>
<img src="../_templates/logo_NCAS.png" height="40">
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="cf-field-bin">
<h1>cf.Field.bin<a class="headerlink" href="#cf-field-bin" title="Permalink to this headline">¶</a></h1>
<dl class="method">
<dt id="cf.Field.bin">
<code class="sig-prename descclassname">Field.</code><code class="sig-name descname">bin</code><span class="sig-paren">(</span><em class="sig-param">method</em>, <em class="sig-param">digitized</em>, <em class="sig-param">weights=None</em>, <em class="sig-param">measure=False</em>, <em class="sig-param">scale=None</em>, <em class="sig-param">mtol=1</em>, <em class="sig-param">ddof=1</em>, <em class="sig-param">radius='earth'</em>, <em class="sig-param">great_circle=False</em>, <em class="sig-param">return_indices=False</em>, <em class="sig-param">verbose=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NCAS-CMS/cf-python/blob/v3.9.0/cf/field.py#L7243-L7935"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cf.Field.bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Collapse the data values that lie in N-dimensional bins.</p>
<p>The data values of the field construct are binned according to how
they correspond to the N-dimensional histogram bins of another set
of variables (see <a class="reference internal" href="../function/cf.histogram.html#cf.histogram" title="cf.histogram"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.histogram</span></code></a> for details), and each bin of
values is collapsed with one of the collapse methods allowed by
the <em>method</em> parameter.</p>
<p>The number of dimensions of the output binned data is equal to the
number of field constructs provided by the <em>digitized</em>
argument. Each such field construct defines a sequence of bins and
provides indices to the bins that each value of another field
construct belongs. There is no upper limit to the number of
dimensions of the output binned data.</p>
<p>The output bins are defined by the exterior product of the
one-dimensional bins of each digitized field construct. For
example, if only one digitized field construct is provided then
the output bins simply comprise its one-dimensional bins; if there
are two digitized field constructs then the output bins comprise
the two-dimensional matrix formed by all possible combinations of
the two sets of one-dimensional bins; etc.</p>
<p>An output value for a bin is formed by collapsing (using the
method given by the <em>method</em> parameter) the elements of the data
for which the corresponding locations in the digitized field
constructs, taken together, index that bin. Note that it may be
the case that not all output bins are indexed by the digitized
field constructs, and for these bins missing data is returned.</p>
<p>The returned field construct will have a domain axis construct for
each dimension of the output bins, with a corresponding dimension
coordinate construct that defines the bin boundaries.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 3.0.2.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="cf.Field.collapse.html#cf.Field.collapse" title="cf.Field.collapse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collapse</span></code></a>, <a class="reference internal" href="cf.Field.digitize.html#cf.Field.digitize" title="cf.Field.digitize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">digitize</span></code></a>, <a class="reference internal" href="cf.Field.weights.html#cf.Field.weights" title="cf.Field.weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code></a>, <a class="reference internal" href="../function/cf.histogram.html#cf.histogram" title="cf.histogram"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.histogram</span></code></a></p>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt>method: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a></dt><dd><p>The collapse method used to combine values that map to
each cell of the output field construct. The following
methods are available (see
<a class="reference external" href="https://ncas-cms.github.io/cf-python/analysis.html#collapse-methods">https://ncas-cms.github.io/cf-python/analysis.html#collapse-methods</a>
for precise definitions):</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 44%" />
<col style="width: 44%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><em>method</em></p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Weighted</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'maximum'</span></code></p></td>
<td><p>The maximum of the values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'minimum'</span></code></p></td>
<td><p>The minimum of the values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'maximum_absolute_value'</span></code></p></td>
<td><p>The maximum of the absolute
values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'minimum_absolute_value'</span></code></p></td>
<td><p>The minimum of the absolute
values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'mid_range'</span></code></p></td>
<td><p>The average of the maximum
and the minimum of the
values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'range'</span></code></p></td>
<td><p>The absolute difference
between the maximum and the
minimum of the values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'median'</span></code></p></td>
<td><p>The median of the values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'sum'</span></code></p></td>
<td><p>The sum of the values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'sum_of_squares'</span></code></p></td>
<td><p>The sum of the squares of
values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'sample_size'</span></code></p></td>
<td><p>The sample size, i.e. the
number of non-missing
values.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'sum_of_weights'</span></code></p></td>
<td><p>The sum of weights, as
would be used for other
calculations.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'sum_of_weights2'</span></code></p></td>
<td><p>The sum of squares of
weights, as would be used
for other calculations.</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'mean'</span></code></p></td>
<td><p>The weighted or unweighted
mean of the values.</p></td>
<td><p>May be</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'mean_absolute_value'</span></code></p></td>
<td><p>The mean of the absolute
values.</p></td>
<td><p>May be</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'mean_of_upper_decile'</span></code></p></td>
<td><p>The mean of the upper group
of data values defined by
the upper tenth of their
distribution.</p></td>
<td><p>May be</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'variance'</span></code></p></td>
<td><p>The weighted or unweighted
variance of the values, with
a given number of degrees of
freedom.</p></td>
<td><p>May be</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'standard_deviation'</span></code></p></td>
<td><p>The square root of the
weighted or unweighted
variance.</p></td>
<td><p>May be</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'root_mean_square'</span></code></p></td>
<td><p>The square root of the
weighted or unweighted mean
of the squares of the
values.</p></td>
<td><p>May be</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'integral'</span></code></p></td>
<td><p>The integral of values.</p></td>
<td><p>Always</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Collapse methods that are “Never” weighted ignore the
<em>weights</em> parameter, even if it is set.</p></li>
<li><p>Collapse methods that “May be” weighted will only be
weighted if the <em>weights</em> parameter is set.</p></li>
<li><p>Collapse methods that are “Always” weighted require the
<em>weights</em> parameter to be set.</p></li>
</ul>
</dd>
<dt>digitized: (sequence of) <a class="reference internal" href="../class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></dt><dd><p>One or more field constructs that contain digitized data
with corresponding metadata, as would be output by
<a class="reference internal" href="cf.Field.digitize.html#cf.Field.digitize" title="cf.Field.digitize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Field.digitize</span></code></a>. Each field construct contains indices
to the one-dimensional bins to which each value of an
original field construct belongs; and there must be
<code class="docutils literal notranslate"><span class="pre">bin_count</span></code> and <code class="docutils literal notranslate"><span class="pre">bin_bounds</span></code> properties as defined by
the <a class="reference internal" href="cf.Field.digitize.html#cf.Field.digitize" title="cf.Field.digitize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">digitize</span></code></a> method (and any of the extra properties
defined by that method are also recommended).</p>
<p>The bins defined by the <code class="docutils literal notranslate"><span class="pre">bin_count</span></code> and <code class="docutils literal notranslate"><span class="pre">bin_bounds</span></code>
properties are used to create a dimension coordinate
construct for the output field construct.</p>
<p>Each digitized field construct must be transformable so
that it is broadcastable to the input field construct’s
data. This is done by using the metadata constructs of the
to create a mapping of physically compatible dimensions
between the fields, and then manipulating the dimensions
of the digitized field construct’s data to ensure that
broadcasting can occur.</p>
</dd>
<dt>weights: optional</dt><dd><p>Specify the weights for the collapse calculations. The
weights are those that would be returned by this call of
the field construct’s <a class="reference internal" href="cf.Field.weights.html#cf.Field.weights" title="cf.Field.weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code></a> method:
<code class="docutils literal notranslate"><span class="pre">f.weights(weights,</span> <span class="pre">measure=measure,</span> <span class="pre">scale=scale,</span>
<span class="pre">radius=radius,</span> <span class="pre">great_circle=great_circle,</span>
<span class="pre">components=True)</span></code>. See the <em>measure, *scale</em>, <em>radius</em>
and <em>great_circle</em> parameters and <a class="reference internal" href="cf.Field.weights.html#cf.Field.weights" title="cf.Field.weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Field.weights</span></code></a> for
details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default <em>weights</em> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, resulting in
<strong>unweighted calculations</strong>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting <em>weights</em> to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> is generally a good
way to ensure that all collapses are
appropriately weighted according to the field
construct’s metadata. In this case, if it is not
possible to create weights for any axis then an
exception will be raised.</p>
<p>However, care needs to be taken if <em>weights</em> is
<a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> when cell volume weights are desired. The
volume weights will be taken from a “volume”
cell measure construct if one exists, otherwise
the cell volumes will be calculated as being
proportional to the sizes of one-dimensional
vertical coordinate cells. In the latter case
<strong>if the vertical dimension coordinates do not
define the actual height or depth thickness of
every cell in the domain then the weights will
be incorrect</strong>.</p>
</div>
<p>If <em>weights</em> is the boolean <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> then weights are
calculated for all of the domain axis constructs.</p>
<dl class="simple">
<dt><em>Parameter example:</em></dt><dd><p>To specify weights based on the field construct’s
metadata for all axes use <code class="docutils literal notranslate"><span class="pre">weights=True</span></code>.</p>
</dd>
<dt><em>Parameter example:</em></dt><dd><p>To specify weights based on cell areas, leaving all
other axes unweighted, use <code class="docutils literal notranslate"><span class="pre">weights='area'</span></code>.</p>
</dd>
<dt><em>Parameter example:</em></dt><dd><p>To specify weights based on cell areas and linearly in
time, leaving all other axes unweighted, you could set
<code class="docutils literal notranslate"><span class="pre">weights=('area',</span> <span class="pre">'T')</span></code>.</p>
</dd>
</dl>
</dd>
<dt>measure: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>, optional</dt><dd><p>Create weights, as defined by the <em>weights</em> parameter,
which are cell measures, i.e. which describe actual cell
sizes (e.g. cell areas) with appropriate units
(e.g. metres squared). By default the weights are scaled
to lie between 0 and 1 and have arbitrary units (see the
<em>scale</em> parameter).</p>
<p>Cell measures can be created for any combination of
axes. For example, cell measures for a time axis are the
time span for each cell with canonical units of seconds;
cell measures for the combination of four axes
representing time and three dimensional space could have
canonical units of metres cubed seconds.</p>
<p>When collapsing with the <code class="docutils literal notranslate"><span class="pre">'integral'</span></code> method, <em>measure</em>
must be True, and the units of the weights are
incorporated into the units of the returned field
construct.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Specifying cell volume weights via
<code class="docutils literal notranslate"><span class="pre">weights=['X',</span> <span class="pre">'Y',</span> <span class="pre">'Z']</span></code> or
<code class="docutils literal notranslate"><span class="pre">weights=['area',</span> <span class="pre">'Z']</span></code> (or other equivalents)
will produce <strong>an incorrect result if the
vertical dimension coordinates do not define the
actual height or depth thickness of every cell
in the domain</strong>. In this case,
<code class="docutils literal notranslate"><span class="pre">weights='volume'</span></code> should be used instead,
which requires the field construct to have a
“volume” cell measure construct.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">weights=True</span></code> then care also needs to be
taken, as a “volume” cell measure construct will
be used if present, otherwise the cell volumes
will be calculated using the size of the
vertical coordinate cells.</p>
</div>
</dd>
<dt>scale: number, optional</dt><dd><p>If set to a positive number then scale the weights, as
defined by the <em>weights</em> parameter, so that they are less
than or equal to that number. By default the weights are
scaled to lie between 0 and 1 (i.e.  <em>scale</em> is 1).</p>
<dl class="simple">
<dt><em>Parameter example:</em></dt><dd><p>To scale all weights so that they lie between 0 and 0.5:
<code class="docutils literal notranslate"><span class="pre">scale=0.5</span></code>.</p>
</dd>
</dl>
</dd>
<dt>mtol: number, optional</dt><dd><p>Set the fraction of input data elements which is allowed
to contain missing data when contributing to an individual
output data element. Where this fraction exceeds <em>mtol</em>,
missing data is returned. The default is 1, meaning that a
missing datum in the output array occurs when its
contributing input array elements are all missing data. A
value of 0 means that a missing datum in the output array
occurs whenever any of its contributing input array
elements are missing data. Any intermediate value is
permitted.</p>
<dl class="simple">
<dt><em>Parameter example:</em></dt><dd><p>To ensure that an output array element is a missing
datum if more than 25% of its input array elements are
missing data: <code class="docutils literal notranslate"><span class="pre">mtol=0.25</span></code>.</p>
</dd>
</dl>
</dd>
<dt>ddof: number, optional</dt><dd><p>The delta degrees of freedom in the calculation of a
standard deviation or variance. The number of degrees of
freedom used in the calculation is (N-<em>ddof</em>) where N
represents the number of non-missing elements contributing
to the calculation. By default <em>ddof</em> is 1, meaning the
standard deviation and variance of the population is
estimated according to the usual formula with (N-1) in the
denominator to avoid the bias caused by the use of the
sample mean (Bessel’s correction).</p>
</dd>
<dt>radius: optional</dt><dd><p>Specify the radius used for calculating the areas of
cells defined in spherical polar coordinates. The
radius is that which would be returned by this call of
the field construct’s <a class="reference internal" href="cf.Field.radius.html#cf.Field.radius" title="cf.Field.radius"><code class="xref py py-obj docutils literal notranslate"><span class="pre">radius</span></code></a> method:
<code class="docutils literal notranslate"><span class="pre">f.radius(radius)</span></code>. See the <a class="reference internal" href="cf.Field.radius.html#cf.Field.radius" title="cf.Field.radius"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.Field.radius</span></code></a> for
details.</p>
<p>By default <em>radius</em> is <code class="docutils literal notranslate"><span class="pre">'earth'</span></code> which means that if
and only if the radius can not found from the datums
of any coordinate reference constructs, then the
default radius taken as 6371229 metres.</p>
</dd>
<dt>great_circle: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>, optional</dt><dd><p>If True then allow, if required, the derivation of i) area
weights from polygon geometry cells by assuming that each
cell part is a spherical polygon composed of great circle
segments; and ii) and the derivation of line-length
weights from line geometry cells by assuming that each
line part is composed of great circle segments.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 3.2.0.</span></p>
</div>
</dd>
<dt>verbose: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, optional</dt><dd><p>If an integer from <code class="docutils literal notranslate"><span class="pre">-1</span></code> to <code class="docutils literal notranslate"><span class="pre">3</span></code>, or an equivalent
string equal ignoring case to one of:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'DISABLE'</span></code> (<code class="docutils literal notranslate"><span class="pre">0</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'WARNING'</span></code> (<code class="docutils literal notranslate"><span class="pre">1</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'INFO'</span></code> (<code class="docutils literal notranslate"><span class="pre">2</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'DETAIL'</span></code> (<code class="docutils literal notranslate"><span class="pre">3</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'DEBUG'</span></code> (<code class="docutils literal notranslate"><span class="pre">-1</span></code>)</p></li>
</ul>
<p>set for the duration of the method call only as the
minimum cut-off for the verboseness level of displayed
output (log) messages, regardless of the
globally-configured <a class="reference internal" href="../function/cf.log_level.html#cf.log_level" title="cf.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.log_level</span></code></a>. Note that
increasing numerical value corresponds to increasing
verbosity, with the exception of <code class="docutils literal notranslate"><span class="pre">-1</span></code> as a special
case of maximal and extreme verbosity.</p>
<p>Otherwise, if <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> (the default value), output
messages will be shown according to the value of the
<a class="reference internal" href="../function/cf.log_level.html#cf.log_level" title="cf.log_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cf.log_level</span></code></a> setting.</p>
<p>Overall, the higher a non-negative integer or
equivalent string that is set (up to a maximum of
<code class="docutils literal notranslate"><span class="pre">3</span></code>/<code class="docutils literal notranslate"><span class="pre">'DETAIL'</span></code>) for increasing verbosity, the more
description that is printed to convey information
about the operation.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><a class="reference internal" href="../class/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Field</span></code></a></dt><dd><p>The field construct containing the binned values.</p>
</dd>
</dl>
</dd>
</dl>
<p><strong>Examples:</strong></p>
<p>Find the range of values that lie in each bin:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">Field: specific_humidity (ncvar%q)</span>
<span class="go">----------------------------------</span>
<span class="go">Data            : specific_humidity(latitude(5), longitude(8)) 0.001 1</span>
<span class="go">Cell methods    : area: mean</span>
<span class="go">Dimension coords: latitude(5) = [-75.0, ..., 75.0] degrees_north</span>
<span class="go">                : longitude(8) = [22.5, ..., 337.5] degrees_east</span>
<span class="go">                : time(1) = [2019-01-01 00:00:00]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[  7.  34.   3.  14.  18.  37.  24.  29.]</span>
<span class="go"> [ 23.  36.  45.  62.  46.  73.   6.  66.]</span>
<span class="go"> [110. 131. 124. 146.  87. 103.  57.  11.]</span>
<span class="go"> [ 29.  59.  39.  70.  58.  72.   9.  17.]</span>
<span class="go"> [  6.  36.  19.  35.  18.  37.  34.  13.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">bin</span><span class="p">(</span><span class="s1">&#39;range&#39;</span><span class="p">,</span> <span class="n">digitized</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">Field: specific_humidity</span>
<span class="go">------------------------</span>
<span class="go">Data            : specific_humidity(specific_humidity(10)) 0.001 1</span>
<span class="go">Cell methods    : latitude: longitude: range</span>
<span class="go">Dimension coords: specific_humidity(10) = [10.15, ..., 138.85000000000002] 0.001 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[14. 11. 11. 13. 11.  0.  0.  0.  7.  0.]</span>
</pre></div>
</div>
<p>Find various metrics describing how
<code class="docutils literal notranslate"><span class="pre">tendency_of_sea_water_potential_temperature_expressed_as_heat_content</span></code>
data varies with <code class="docutils literal notranslate"><span class="pre">sea_water_potential_temperature</span></code> and
<code class="docutils literal notranslate"><span class="pre">sea_water_salinity</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">Field: sea_water_potential_temperature (ncvar%sea_water_potential_temperature)</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">Data            : sea_water_potential_temperature(time(1), depth(1), latitude(5), longitude(8)) K</span>
<span class="go">Cell methods    : area: mean time(1): mean</span>
<span class="go">Dimension coords: time(1) = [2290-06-01 00:00:00] 360_day</span>
<span class="go">                : depth(1) = [3961.89990234375] m</span>
<span class="go">                : latitude(5) = [-1.875, ..., 3.125] degrees_north</span>
<span class="go">                : longitude(8) = [75.0, ..., 83.75] degrees_east</span>
<span class="go">Auxiliary coords: model_level_number(depth(1)) = [18]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">Field: sea_water_salinity (ncvar%sea_water_salinity)</span>
<span class="go">----------------------------------------------------</span>
<span class="go">Data            : sea_water_salinity(time(1), depth(1), latitude(5), longitude(8)) psu</span>
<span class="go">Cell methods    : area: mean time(1): mean</span>
<span class="go">Dimension coords: time(1) = [2290-06-01 00:00:00] 360_day</span>
<span class="go">                : depth(1) = [3961.89990234375] m</span>
<span class="go">                : latitude(5) = [-1.875, ..., 3.125] degrees_north</span>
<span class="go">                : longitude(8) = [75.0, ..., 83.75] degrees_east</span>
<span class="go">Auxiliary coords: model_level_number(depth(1)) = [18]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">Field: tendency_of_sea_water_potential_temperature_expressed_as_heat_content (ncvar%tend)</span>
<span class="go">-----------------------------------------------------------------------------------------</span>
<span class="go">Data            : tendency_of_sea_water_potential_temperature_expressed_as_heat_content(time(1), depth(1), latitude(5), longitude(8)) W m-2</span>
<span class="go">Cell methods    : area: mean time(1): mean</span>
<span class="go">Dimension coords: time(1) = [2290-06-01 00:00:00] 360_day</span>
<span class="go">                : depth(1) = [3961.89990234375] m</span>
<span class="go">                : latitude(5) = [-1.875, ..., 3.125] degrees_north</span>
<span class="go">                : longitude(8) = [75.0, ..., 83.75] degrees_east</span>
<span class="go">Auxiliary coords: model_level_number(depth(1)) = [18]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[[[-209.72  340.86   94.75  154.21   38.54 -262.75  158.22  154.58]</span>
<span class="go">   [ 311.67  245.91 -168.16   47.61 -219.66 -270.33  226.1    52.0 ]</span>
<span class="go">   [     -- -112.34  271.67  189.22    9.92  232.39  221.17  206.0 ]</span>
<span class="go">   [     --      --  -92.31 -285.57  161.55  195.89 -258.29    8.35]</span>
<span class="go">   [     --      --   -7.82 -299.79  342.32 -169.38  254.5   -75.4 ]]]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t_indices</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_indices</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">bin</span><span class="p">(</span><span class="s1">&#39;sample_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">t_indices</span><span class="p">,</span> <span class="n">s_indices</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="go">Field: number_of_observations</span>
<span class="go">-----------------------------</span>
<span class="go">Data            : number_of_observations(sea_water_salinity(4), sea_water_potential_temperature(6)) 1</span>
<span class="go">Cell methods    : latitude: longitude: point</span>
<span class="go">Dimension coords: sea_water_salinity(4) = [6.3054151982069016, ..., 39.09366758167744] psu</span>
<span class="go">                : sea_water_potential_temperature(6) = [278.1569468180338, ..., 303.18466695149743] K</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[ 1  2 2  2 --  2]</span>
<span class="go"> [ 2  1 3  3  3  2]</span>
<span class="go"> [-- -- 3 --  1 --]</span>
<span class="go"> [ 1 -- 1  3  2  1]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">bin</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">t_indices</span><span class="p">,</span> <span class="n">s_indices</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">Field: tendency_of_sea_water_potential_temperature_expressed_as_heat_content</span>
<span class="go">----------------------------------------------------------------------------</span>
<span class="go">Data            : tendency_of_sea_water_potential_temperature_expressed_as_heat_content(sea_water_salinity(4), sea_water_potential_temperature(6)) W m-2</span>
<span class="go">Cell methods    : latitude: longitude: mean</span>
<span class="go">Dimension coords: sea_water_salinity(4) = [6.3054151982069016, ..., 39.09366758167744] psu</span>
<span class="go">                : sea_water_potential_temperature(6) = [278.1569468180338, ..., 303.18466695149743] K</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[ 189.22 131.36    6.75 -41.61     --  100.04]</span>
<span class="go"> [-116.73 232.38   -4.82 180.47 134.25 -189.55]</span>
<span class="go"> [     --     --  180.69     --  47.61      --]</span>
<span class="go"> [158.22      -- -262.75  64.12 -51.83 -219.66]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">bin</span><span class="p">(</span>
<span class="gp">... </span>        <span class="s1">&#39;integral&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">t_indices</span><span class="p">,</span> <span class="n">s_indices</span><span class="p">],</span>
<span class="gp">... </span>        <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">Field: long_name=integral of tendency_of_sea_water_potential_temperature_expressed_as_heat_content</span>
<span class="go">--------------------------------------------------------------------------------------------------</span>
<span class="go">Data            : long_name=integral of tendency_of_sea_water_potential_temperature_expressed_as_heat_content(sea_water_salinity(4), sea_water_potential_temperature(6)) 86400 m3.kg.s-2</span>
<span class="go">Cell methods    : latitude: longitude: sum</span>
<span class="go">Dimension coords: sea_water_salinity(4) = [6.3054151982069016, ..., 39.09366758167744] psu</span>
<span class="go">                : sea_water_potential_temperature(6) = [278.1569468180338, ..., 303.18466695149743] K</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[ 3655558758400.0 5070927691776.0   260864491520.0 -1605439586304.0               --  3863717609472.0]</span>
<span class="go"> [-4509735059456.0 4489564127232.0  -280126521344.0 10454746267648.0  7777254113280.0 -7317268463616.0]</span>
<span class="go"> [              --              -- 10470463373312.0               --   919782031360.0               --]</span>
<span class="go"> [ 3055211773952.0              -- -5073676009472.0  3715958833152.0 -2000787079168.0 -4243632160768.0]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">bin</span><span class="p">(</span><span class="s1">&#39;sum_of_weights&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">t_indices</span><span class="p">,</span> <span class="n">s_indices</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Field: long_name=sum_of_weights of tendency_of_sea_water_potential_temperature_expressed_as_heat_content</span>
<span class="go">--------------------------------------------------------------------------------------------------------</span>
<span class="go">Data            : long_name=sum_of_weights of tendency_of_sea_water_potential_temperature_expressed_as_heat_content(sea_water_salinity(4), sea_water_potential_temperature(6)) 86400 m3.s</span>
<span class="go">Cell methods    : latitude: longitude: sum</span>
<span class="go">Dimension coords: sea_water_salinity(4) = [7.789749830961227, ..., 36.9842486679554] psu</span>
<span class="go">                : sea_water_potential_temperature(6) = [274.50717671712243, ..., 302.0188242594401] K</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="go">[[19319093248.0 38601412608.0 38628990976.0 38583025664.0            --  38619795456.0]</span>
<span class="go"> [38628990976.0 19319093248.0 57957281792.0 57929699328.0 57929695232.0  38601412608.0]</span>
<span class="go"> [         --              -- 57948086272.0            -- 19319093248.0             --]</span>
<span class="go"> [19309897728.0            -- 19309897728.0 57948086272.0 38601412608.0  19319093248.0]]</span>
</pre></div>
</div>
<p>Demonstrate that the integral divided by the sum of the cell
measures is equal to the mean:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">w</span><span class="p">)</span>
<span class="go">Field:</span>
<span class="go">-------</span>
<span class="go">Data            : (sea_water_salinity(4), sea_water_potential_temperature(6)) kg.s-3</span>
<span class="go">Cell methods    : latitude: longitude: sum</span>
<span class="go">Dimension coords: sea_water_salinity(4) = [7.789749830961227, ..., 36.9842486679554] psu</span>
<span class="go">                : sea_water_potential_temperature(6) = [274.50717671712243, ..., 302.0188242594401] K</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">w</span> <span class="o">==</span> <span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2021, NCAS | Page built on 2021-05-25.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>